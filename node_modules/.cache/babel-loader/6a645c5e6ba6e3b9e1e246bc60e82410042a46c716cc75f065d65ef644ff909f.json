{"ast":null,"code":"import React,{useState,useEffect}from'react';import healthRecordService from'../services/healthRecordService';import{PetIcon,HealthIcon,UIIcon}from'./MinimalIcons';// Multi-pet health records viewer for dashboard\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MultiPetHealthRecordsViewer=_ref=>{let{pets,userPlan,onEditRecord,onDeleteRecord,onRefresh,onAddRecord,refreshKey=0}=_ref;const[allRecords,setAllRecords]=useState({});const[loading,setLoading]=useState(true);const[selectedPet,setSelectedPet]=useState(null);const[deletingId,setDeletingId]=useState(null);const[expandedRecords,setExpandedRecords]=useState(new Set());const[searchQuery,setSearchQuery]=useState('');const[dateFilter,setDateFilter]=useState('all');const[sortBy,setSortBy]=useState('date_desc');const[openDropdown,setOpenDropdown]=useState(null);// Close dropdown when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{if(openDropdown&&!event.target.closest('.custom-dropdown')){setOpenDropdown(null);}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[openDropdown]);const CustomDropdown=_ref2=>{var _options$find;let{value,onChange,options,placeholder,dropdownKey}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"custom-dropdown relative\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setOpenDropdown(openDropdown===dropdownKey?null:dropdownKey),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"truncate\",children:((_options$find=options.find(opt=>opt.value===value))===null||_options$find===void 0?void 0:_options$find.label)||placeholder}),/*#__PURE__*/_jsx(\"svg\",{className:`w-4 h-4 text-gray-400 transition-transform ${openDropdown===dropdownKey?'rotate-180':''}`,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19 9l-7 7-7-7\"})})]}),openDropdown===dropdownKey&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto\",children:options.map(option=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onChange(option.value);setOpenDropdown(null);},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${value===option.value?'bg-[#E5F4F1] text-[#5EB47C]':'text-gray-700'}`,children:option.label},option.value))})]});};const toggleRecordExpansion=recordId=>{setExpandedRecords(prev=>{const newSet=new Set(prev);if(newSet.has(recordId)){newSet.delete(recordId);}else{newSet.add(recordId);}return newSet;});};useEffect(()=>{if(pets&&pets.length>0){loadAllHealthRecords();}else{setLoading(false);}},[pets,refreshKey]);const loadAllHealthRecords=async()=>{setLoading(true);try{const recordsMap={};// Load records for each pet\nawait Promise.all(pets.map(async pet=>{try{const result=await healthRecordService.getHealthRecords(pet.id);recordsMap[pet.id]={pet:pet,records:result.success?result.data:[],error:result.success?null:result.error};}catch(error){console.error(`Error loading records for ${pet.name}:`,error);recordsMap[pet.id]={pet:pet,records:[],error:error.message};}}));setAllRecords(recordsMap);// Set \"All Pets\" as default selection\nsetSelectedPet('all');}catch(error){console.error('Error loading health records:',error);}finally{setLoading(false);}};const handleDeleteRecord=async recordId=>{if(!window.confirm('Are you sure you want to delete this health record? This action cannot be undone.')){return;}setDeletingId(recordId);try{const result=await healthRecordService.deleteHealthRecord(recordId);if(result.success){// Refresh the records\nawait loadAllHealthRecords();if(onRefresh)onRefresh();alert('Health record deleted successfully!');}else{alert(`Failed to delete health record: ${result.error}`);}}catch(error){console.error('Error deleting health record:',error);alert(`Error deleting health record: ${error.message}`);}finally{setDeletingId(null);}};const handleEditRecord=record=>{if(onEditRecord){onEditRecord(record);}else{alert('Edit functionality not implemented yet. Please contact support.');}};// const getRecordIcon = (recordType) => {\n//   const iconComponents = {\n//     checkup: <HealthIcon type=\"check\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     vaccination: <HealthIcon type=\"vaccination\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     surgery: <UIIcon type=\"surgery\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     emergency: <HealthIcon type=\"emergency\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     dental: <HealthIcon type=\"dental\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     grooming: <UIIcon type=\"scissors\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     lab_work: <HealthIcon type=\"lab\" className=\"w-5 h-5\" color=\"currentColor\" />,\n//     other: <HealthIcon type=\"records\" className=\"w-5 h-5\" color=\"currentColor\" />\n//   };\n//   return iconComponents[recordType] || <HealthIcon type=\"records\" className=\"w-5 h-5\" color=\"currentColor\" />;\n// };\n// const getRecordColor = (recordType) => {\n//   const colors = {\n//     checkup: 'from-blue-50 to-blue-100 border-blue-200',\n//     vaccination: 'from-green-50 to-green-100 border-green-200',\n//     surgery: 'from-red-50 to-red-100 border-red-200',\n//     emergency: 'from-orange-50 to-orange-100 border-orange-200',\n//     dental: 'from-purple-50 to-purple-100 border-purple-200',\n//     grooming: 'from-pink-50 to-pink-100 border-pink-200',\n//     lab_work: 'from-yellow-50 to-yellow-100 border-yellow-200',\n//     other: 'from-gray-50 to-gray-100 border-gray-200'\n//   };\n//   return colors[recordType] || 'from-gray-50 to-gray-100 border-gray-200';\n// };\nconst getRecordBadgeColor=recordType=>{const colors={checkup:'bg-blue-100 text-blue-800',vaccination:'bg-green-100 text-green-800',surgery:'bg-red-100 text-red-800',emergency:'bg-orange-100 text-orange-800',dental:'bg-purple-100 text-purple-800',grooming:'bg-pink-100 text-pink-800',lab_work:'bg-yellow-100 text-yellow-800',other:'bg-gray-100 text-gray-800'};return colors[recordType]||'bg-gray-100 text-gray-800';};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});};// const formatTime = (dateString) => {\n//   return new Date(dateString).toLocaleTimeString('en-US', {\n//     hour: '2-digit',\n//     minute: '2-digit'\n//   });\n// };\nif(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-10 w-10 border-2 border-[#5EB47C] border-t-transparent mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium\",children:\"Loading health records...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Please wait while we gather your pet's medical history\"})]});}if(!pets||pets.length===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-16\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 mx-auto mb-6 bg-[#E5F4F1] rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"health\",className:\"w-10 h-10\",color:\"#5EB47C\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:\"No pets added yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Add your first pet to start tracking health records\"})]});}const totalRecords=Object.values(allRecords).reduce((sum,item)=>sum+item.records.length,0);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 overflow-x-auto pb-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedPet('all'),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${selectedPet==='all'?'bg-[#5EB47C] text-white shadow-sm':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:\"All Pets\"}),pets.map(pet=>{// const petRecords = allRecords[pet.id]?.records || [];\nreturn/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedPet(pet.id),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${selectedPet===pet.id?'bg-[#5EB47C] text-white shadow-sm':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:pet.name},pet.id);})]})}),selectedPet&&(selectedPet==='all'&&totalRecords>0||selectedPet!=='all'&&allRecords[selectedPet]&&allRecords[selectedPet].records.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 w-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search health records, procedures, medications...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-3\",children:[/*#__PURE__*/_jsx(CustomDropdown,{value:dateFilter,onChange:setDateFilter,options:[{value:'all',label:'All Time'},{value:'today',label:'Today'},{value:'week',label:'Past Week'},{value:'month',label:'Past Month'},{value:'year',label:'Past Year'}],placeholder:\"All Time\",dropdownKey:\"date\"}),/*#__PURE__*/_jsx(CustomDropdown,{value:sortBy,onChange:setSortBy,options:[{value:'date_desc',label:'Newest First'},{value:'date_asc',label:'Oldest First'},{value:'type',label:'By Type'},{value:'cost',label:'By Cost'}],placeholder:\"Newest First\",dropdownKey:\"sort\"})]})]}),selectedPet&&(selectedPet==='all'||allRecords[selectedPet])&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:(_allRecords$selectedP=>{const currentRecords=selectedPet==='all'?Object.values(allRecords).flatMap(item=>item.records.map(record=>({...record,petInfo:item.pet}))):((_allRecords$selectedP=allRecords[selectedPet])===null||_allRecords$selectedP===void 0?void 0:_allRecords$selectedP.records)||[];return currentRecords.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"records\",className:\"w-8 h-8\",color:\"#6B7280\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:selectedPet==='all'?'No health records yet':`No health records yet for ${allRecords[selectedPet].pet.name}`}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6 max-w-sm mx-auto\",children:selectedPet==='all'?'Start building your pets\\' medical history by adding their first health records.':`Start building ${allRecords[selectedPet].pet.name}'s medical history by adding their first health record.`}),selectedPet!=='all'&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{if(onAddRecord){onAddRecord(allRecords[selectedPet].pet);}},className:\"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"vaccination\",className:\"w-4 h-4 mr-2\",color:\"white\"}),\"Add First Record\"]})]}):/*#__PURE__*/_jsx(_Fragment,{children:(()=>{const filteredRecords=currentRecords.filter(record=>{// Search filter\nif(searchQuery.trim()){var _record$title,_record$description,_record$record_type,_record$veterinarian_,_record$clinic_name,_record$notes,_record$medications;const query=searchQuery.toLowerCase();const matchesSearch=((_record$title=record.title)===null||_record$title===void 0?void 0:_record$title.toLowerCase().includes(query))||((_record$description=record.description)===null||_record$description===void 0?void 0:_record$description.toLowerCase().includes(query))||((_record$record_type=record.record_type)===null||_record$record_type===void 0?void 0:_record$record_type.toLowerCase().includes(query))||((_record$veterinarian_=record.veterinarian_name)===null||_record$veterinarian_===void 0?void 0:_record$veterinarian_.toLowerCase().includes(query))||((_record$clinic_name=record.clinic_name)===null||_record$clinic_name===void 0?void 0:_record$clinic_name.toLowerCase().includes(query))||((_record$notes=record.notes)===null||_record$notes===void 0?void 0:_record$notes.toLowerCase().includes(query))||((_record$medications=record.medications)===null||_record$medications===void 0?void 0:_record$medications.some(med=>med.toLowerCase().includes(query)));if(!matchesSearch)return false;}// Date filter\nif(dateFilter!=='all'){const recordDate=new Date(record.date_performed);const now=new Date();const today=new Date(now.getFullYear(),now.getMonth(),now.getDate());switch(dateFilter){case'today':if(recordDate<today)return false;break;case'week':const weekAgo=new Date(today);weekAgo.setDate(weekAgo.getDate()-7);if(recordDate<weekAgo)return false;break;case'month':const monthAgo=new Date(today);monthAgo.setMonth(monthAgo.getMonth()-1);if(recordDate<monthAgo)return false;break;case'year':const yearAgo=new Date(today);yearAgo.setFullYear(yearAgo.getFullYear()-1);if(recordDate<yearAgo)return false;break;default:// 'all' case - no filtering needed\nbreak;}}return true;}).sort((a,b)=>{var _a$record_type;switch(sortBy){case'date_asc':return new Date(a.date_performed)-new Date(b.date_performed);case'date_desc':return new Date(b.date_performed)-new Date(a.date_performed);case'type':return((_a$record_type=a.record_type)===null||_a$record_type===void 0?void 0:_a$record_type.localeCompare(b.record_type))||0;case'cost':const aCost=parseFloat(a.cost)||0;const bCost=parseFloat(b.cost)||0;return bCost-aCost;default:return new Date(b.date_performed)-new Date(a.date_performed);}});if(filteredRecords.length===0&&(searchQuery.trim()||dateFilter!=='all')){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"search\",className:\"w-8 h-8\",color:\"#6B7280\"})}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:\"No matching health records found\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-6 max-w-sm mx-auto\",children:[\"Try adjusting your search terms or filters to see more records\",selectedPet!=='all'?` for ${allRecords[selectedPet].pet.name}`:'',\".\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSearchQuery('');setDateFilter('all');},className:\"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium\",children:\"Clear Filters\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[searchQuery.trim()&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 mb-4\",children:[\"Found \",filteredRecords.length,\" record\",filteredRecords.length!==1?'s':'',\" matching \\\"\",searchQuery,\"\\\"\"]}),filteredRecords.map(record=>{const isExpanded=expandedRecords.has(record.id);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg shadow-sm transition-all duration-200\",children:[/*#__PURE__*/_jsx(\"div\",{onClick:()=>toggleRecordExpansion(record.id),className:\"p-3 cursor-pointer hover:shadow-md transition-all duration-200 hover:-translate-y-0.5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3 flex-1 min-w-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-900 truncate\",children:record.title}),/*#__PURE__*/_jsx(\"span\",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${getRecordBadgeColor(record.record_type)}`,children:record.record_type.replace('_',' ').toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 text-xs text-gray-600\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"calendar\",className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),formatDate(record.date_performed)]}),selectedPet==='all'&&record.petInfo&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(PetIcon,{species:\"pet\",className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),record.petInfo.name]}),record.veterinarian_name&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"doctor\",className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),record.veterinarian_name]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 flex-shrink-0\",children:[record.cost&&/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-semibold text-green-700\",children:[\"$\",record.cost]})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 bg-white/60 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"svg\",{className:`w-3 h-3 text-gray-600 transition-transform duration-200 ${isExpanded?'rotate-90':''}`,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M9 5l7 7-7 7\"})})})]})]})}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-200 p-4 bg-white/50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-700 leading-relaxed\",children:record.description})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 mb-4\",children:[record.clinic_name&&/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center p-3 bg-white rounded-lg border\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Clinic\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-gray-900 truncate\",children:record.clinic_name})]})}),record.weight&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-white rounded-lg border\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"weight\",className:\"w-5 h-5 mr-2 flex-shrink-0\",color:\"#6B7280\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Weight\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-semibold text-gray-900\",children:[record.weight,\" lbs\"]})]})]}),record.temperature&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-white rounded-lg border\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"temperature\",className:\"w-5 h-5 mr-2 flex-shrink-0\",color:\"#6B7280\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Temperature\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-semibold text-gray-900\",children:[record.temperature,\"\\xB0F\"]})]})]})]}),record.documents&&record.documents.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-semibold text-gray-900 mb-2\",children:\"Documents\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:record.documents.map((doc,idx)=>/*#__PURE__*/_jsxs(\"a\",{href:doc.url,target:\"_blank\",rel:\"noreferrer\",className:\"inline-flex items-center max-w-xs px-2 py-1 rounded-full text-xs border border-gray-200 bg-white hover:bg-gray-50 text-gray-700\",title:doc.name,children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-1\",children:(doc.type||'').startsWith('image/')?/*#__PURE__*/_jsx(HealthIcon,{type:\"image\",className:\"w-4 h-4\",color:\"currentColor\"}):doc.type==='application/pdf'?/*#__PURE__*/_jsx(HealthIcon,{type:\"document\",className:\"w-4 h-4\",color:\"currentColor\"}):/*#__PURE__*/_jsx(HealthIcon,{type:\"attachment\",className:\"w-4 h-4\",color:\"currentColor\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"truncate\",children:doc.name})]},idx))})]}),record.medications&&record.medications.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-semibold text-gray-900 mb-2\",children:\"Medications Prescribed\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:record.medications.map((med,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-3 py-1 bg-white text-gray-700 rounded-full text-sm font-medium border\",children:med},index))})]}),record.notes&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"text-sm font-semibold text-gray-900 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(UIIcon,{type:\"write\",className:\"w-4 h-4 mr-2\",color:\"currentColor\"}),\"Additional Notes\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-white rounded-lg border\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-700 leading-relaxed\",children:record.notes})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0 pt-3 border-t border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Added \",new Date(record.created_at).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleEditRecord(record);},className:\"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-white hover:bg-gray-50 text-gray-700 hover:text-gray-900 rounded-lg transition-all duration-200 text-sm font-medium border hover:shadow-sm\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleDeleteRecord(record.id);},disabled:deletingId===record.id,className:\"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 hover:text-red-800 rounded-lg transition-all duration-200 text-sm font-medium disabled:opacity-50\",children:deletingId===record.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-3 w-3 border border-red-600 border-t-transparent mr-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Deleting...\"}),/*#__PURE__*/_jsx(\"span\",{className:\"sm:hidden\",children:\"...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Delete\"}),/*#__PURE__*/_jsx(\"span\",{className:\"sm:hidden\",children:\"Del\"})]})})]})]})]})]},record.id);})]});})()});})()})]});};// Single-pet health records viewer (keeping for backward compatibility)\nconst SinglePetHealthRecordsViewer=_ref3=>{let{petId,petName}=_ref3;const[records,setRecords]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{if(petId){loadHealthRecords();}else{setLoading(false);}},[petId]);const loadHealthRecords=async()=>{setLoading(true);try{const result=await healthRecordService.getHealthRecords(petId);if(result.success){setRecords(result.data);}}catch(error){console.error('Error loading health records:',error);}finally{setLoading(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:\"Loading health records...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold\",children:[\"Health Records for \",petName]}),records.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No health records yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:records.map(record=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium\",children:record.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:record.description}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:new Date(record.date_performed).toLocaleDateString()})]},record.id))})]});};// Main component that decides which viewer to use\nconst HealthRecordsViewer=_ref4=>{let{petId,petName,pets,userPlan,onEditRecord,onDeleteRecord,onRefresh,onAddRecord,refreshKey}=_ref4;// Always call hooks at the top level - no conditional hook calls\nconst[shouldUseSingleViewer]=useState(!pets&&petId);// If pets array is provided, use the multi-pet viewer\nif(pets){return/*#__PURE__*/_jsx(MultiPetHealthRecordsViewer,{pets:pets,userPlan:userPlan,onEditRecord:onEditRecord,onDeleteRecord:onDeleteRecord,onRefresh:onRefresh,onAddRecord:onAddRecord,refreshKey:refreshKey});}// If petId is provided but no pets array, use single-pet viewer\nif(shouldUseSingleViewer){return/*#__PURE__*/_jsx(SinglePetHealthRecordsViewer,{petId:petId,petName:petName});}// Fallback\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"health\",className:\"w-8 h-8\",color:\"#6B7280\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No pet data provided\"})]});};export default HealthRecordsViewer;","map":{"version":3,"names":["React","useState","useEffect","healthRecordService","PetIcon","HealthIcon","UIIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MultiPetHealthRecordsViewer","_ref","pets","userPlan","onEditRecord","onDeleteRecord","onRefresh","onAddRecord","refreshKey","allRecords","setAllRecords","loading","setLoading","selectedPet","setSelectedPet","deletingId","setDeletingId","expandedRecords","setExpandedRecords","Set","searchQuery","setSearchQuery","dateFilter","setDateFilter","sortBy","setSortBy","openDropdown","setOpenDropdown","handleClickOutside","event","target","closest","document","addEventListener","removeEventListener","CustomDropdown","_ref2","_options$find","value","onChange","options","placeholder","dropdownKey","className","children","type","onClick","find","opt","label","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","map","option","toggleRecordExpansion","recordId","prev","newSet","has","delete","add","length","loadAllHealthRecords","recordsMap","Promise","all","pet","result","getHealthRecords","id","records","success","data","error","console","name","message","handleDeleteRecord","window","confirm","deleteHealthRecord","alert","handleEditRecord","record","getRecordBadgeColor","recordType","colors","checkup","vaccination","surgery","emergency","dental","grooming","lab_work","other","formatDate","dateString","Date","toLocaleDateString","year","month","day","color","totalRecords","Object","values","reduce","sum","item","e","_allRecords$selectedP","currentRecords","flatMap","petInfo","filteredRecords","filter","trim","_record$title","_record$description","_record$record_type","_record$veterinarian_","_record$clinic_name","_record$notes","_record$medications","query","toLowerCase","matchesSearch","title","includes","description","record_type","veterinarian_name","clinic_name","notes","medications","some","med","recordDate","date_performed","now","today","getFullYear","getMonth","getDate","weekAgo","setDate","monthAgo","setMonth","yearAgo","setFullYear","sort","a","b","_a$record_type","localeCompare","aCost","parseFloat","cost","bCost","isExpanded","replace","toUpperCase","species","weight","temperature","documents","doc","idx","href","url","rel","startsWith","index","created_at","stopPropagation","disabled","SinglePetHealthRecordsViewer","_ref3","petId","petName","setRecords","loadHealthRecords","HealthRecordsViewer","_ref4","shouldUseSingleViewer"],"sources":["/workspace/src/components/HealthRecordsViewer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport healthRecordService from '../services/healthRecordService';\nimport { PetIcon, HealthIcon, UIIcon } from './MinimalIcons';\n\n// Multi-pet health records viewer for dashboard\nconst MultiPetHealthRecordsViewer = ({ pets, userPlan, onEditRecord, onDeleteRecord, onRefresh, onAddRecord, refreshKey = 0 }) => {\n  const [allRecords, setAllRecords] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [selectedPet, setSelectedPet] = useState(null);\n  const [deletingId, setDeletingId] = useState(null);\n  const [expandedRecords, setExpandedRecords] = useState(new Set());\n  const [searchQuery, setSearchQuery] = useState('');\n  const [dateFilter, setDateFilter] = useState('all');\n  const [sortBy, setSortBy] = useState('date_desc');\n  const [openDropdown, setOpenDropdown] = useState(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (openDropdown && !event.target.closest('.custom-dropdown')) {\n        setOpenDropdown(null);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [openDropdown]);\n\n  const CustomDropdown = ({ value, onChange, options, placeholder, dropdownKey }) => (\n    <div className=\"custom-dropdown relative\">\n      <button\n        type=\"button\"\n        onClick={() => setOpenDropdown(openDropdown === dropdownKey ? null : dropdownKey)}\n        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50\"\n      >\n        <span className=\"truncate\">\n          {options.find(opt => opt.value === value)?.label || placeholder}\n        </span>\n        <svg \n          className={`w-4 h-4 text-gray-400 transition-transform ${openDropdown === dropdownKey ? 'rotate-180' : ''}`} \n          fill=\"none\" \n          stroke=\"currentColor\" \n          viewBox=\"0 0 24 24\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </button>\n      {openDropdown === dropdownKey && (\n        <div className=\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto\">\n          {options.map((option) => (\n            <button\n              key={option.value}\n              type=\"button\"\n              onClick={() => {\n                onChange(option.value);\n                setOpenDropdown(null);\n              }}\n              className={`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${\n                value === option.value ? 'bg-[#E5F4F1] text-[#5EB47C]' : 'text-gray-700'\n              }`}\n            >\n              {option.label}\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n\n  const toggleRecordExpansion = (recordId) => {\n    setExpandedRecords(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(recordId)) {\n        newSet.delete(recordId);\n      } else {\n        newSet.add(recordId);\n      }\n      return newSet;\n    });\n  };\n\n  useEffect(() => {\n    if (pets && pets.length > 0) {\n      loadAllHealthRecords();\n    } else {\n      setLoading(false);\n    }\n  }, [pets, refreshKey]);\n\n  const loadAllHealthRecords = async () => {\n    setLoading(true);\n    try {\n      const recordsMap = {};\n      \n      // Load records for each pet\n      await Promise.all(pets.map(async (pet) => {\n        try {\n          const result = await healthRecordService.getHealthRecords(pet.id);\n          recordsMap[pet.id] = {\n            pet: pet,\n            records: result.success ? result.data : [],\n            error: result.success ? null : result.error\n          };\n        } catch (error) {\n          console.error(`Error loading records for ${pet.name}:`, error);\n          recordsMap[pet.id] = {\n            pet: pet,\n            records: [],\n            error: error.message\n          };\n        }\n      }));\n      \n      setAllRecords(recordsMap);\n      \n      // Set \"All Pets\" as default selection\n      setSelectedPet('all');\n      \n    } catch (error) {\n      console.error('Error loading health records:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteRecord = async (recordId) => {\n    if (!window.confirm('Are you sure you want to delete this health record? This action cannot be undone.')) {\n      return;\n    }\n\n    setDeletingId(recordId);\n    try {\n      const result = await healthRecordService.deleteHealthRecord(recordId);\n      if (result.success) {\n        // Refresh the records\n        await loadAllHealthRecords();\n        if (onRefresh) onRefresh();\n        alert('Health record deleted successfully!');\n      } else {\n        alert(`Failed to delete health record: ${result.error}`);\n      }\n    } catch (error) {\n      console.error('Error deleting health record:', error);\n      alert(`Error deleting health record: ${error.message}`);\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  const handleEditRecord = (record) => {\n    if (onEditRecord) {\n      onEditRecord(record);\n    } else {\n      alert('Edit functionality not implemented yet. Please contact support.');\n    }\n  };\n\n  // const getRecordIcon = (recordType) => {\n  //   const iconComponents = {\n  //     checkup: <HealthIcon type=\"check\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     vaccination: <HealthIcon type=\"vaccination\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     surgery: <UIIcon type=\"surgery\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     emergency: <HealthIcon type=\"emergency\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     dental: <HealthIcon type=\"dental\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     grooming: <UIIcon type=\"scissors\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     lab_work: <HealthIcon type=\"lab\" className=\"w-5 h-5\" color=\"currentColor\" />,\n  //     other: <HealthIcon type=\"records\" className=\"w-5 h-5\" color=\"currentColor\" />\n  //   };\n  //   return iconComponents[recordType] || <HealthIcon type=\"records\" className=\"w-5 h-5\" color=\"currentColor\" />;\n  // };\n\n  // const getRecordColor = (recordType) => {\n  //   const colors = {\n  //     checkup: 'from-blue-50 to-blue-100 border-blue-200',\n  //     vaccination: 'from-green-50 to-green-100 border-green-200',\n  //     surgery: 'from-red-50 to-red-100 border-red-200',\n  //     emergency: 'from-orange-50 to-orange-100 border-orange-200',\n  //     dental: 'from-purple-50 to-purple-100 border-purple-200',\n  //     grooming: 'from-pink-50 to-pink-100 border-pink-200',\n  //     lab_work: 'from-yellow-50 to-yellow-100 border-yellow-200',\n  //     other: 'from-gray-50 to-gray-100 border-gray-200'\n  //   };\n  //   return colors[recordType] || 'from-gray-50 to-gray-100 border-gray-200';\n  // };\n\n  const getRecordBadgeColor = (recordType) => {\n    const colors = {\n      checkup: 'bg-blue-100 text-blue-800',\n      vaccination: 'bg-green-100 text-green-800',\n      surgery: 'bg-red-100 text-red-800',\n      emergency: 'bg-orange-100 text-orange-800',\n      dental: 'bg-purple-100 text-purple-800',\n      grooming: 'bg-pink-100 text-pink-800',\n      lab_work: 'bg-yellow-100 text-yellow-800',\n      other: 'bg-gray-100 text-gray-800'\n    };\n    return colors[recordType] || 'bg-gray-100 text-gray-800';\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  // const formatTime = (dateString) => {\n  //   return new Date(dateString).toLocaleTimeString('en-US', {\n  //     hour: '2-digit',\n  //     minute: '2-digit'\n  //   });\n  // };\n\n  if (loading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-2 border-[#5EB47C] border-t-transparent mb-4\"></div>\n        <p className=\"text-gray-600 font-medium\">Loading health records...</p>\n        <p className=\"text-sm text-gray-500\">Please wait while we gather your pet's medical history</p>\n      </div>\n    );\n  }\n\n  if (!pets || pets.length === 0) {\n    return (\n      <div className=\"text-center py-16\">\n        <div className=\"w-20 h-20 mx-auto mb-6 bg-[#E5F4F1] rounded-full flex items-center justify-center\">\n          <HealthIcon type=\"health\" className=\"w-10 h-10\" color=\"#5EB47C\" />\n        </div>\n        <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No pets added yet</h3>\n        <p className=\"text-gray-600\">Add your first pet to start tracking health records</p>\n      </div>\n    );\n  }\n\n  const totalRecords = Object.values(allRecords).reduce((sum, item) => sum + item.records.length, 0);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Pet Selection Tabs */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-center space-x-1 overflow-x-auto pb-2\">\n          <button\n            onClick={() => setSelectedPet('all')}\n            className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${\n              selectedPet === 'all'\n                ? 'bg-[#5EB47C] text-white shadow-sm'\n                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n            }`}\n          >\n            All Pets\n          </button>\n          {pets.map((pet) => {\n            // const petRecords = allRecords[pet.id]?.records || [];\n            return (\n              <button\n                key={pet.id}\n                onClick={() => setSelectedPet(pet.id)}\n                className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${\n                  selectedPet === pet.id\n                    ? 'bg-[#5EB47C] text-white shadow-sm'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                }`}\n              >\n                {pet.name}\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Search & Filters */}\n      {selectedPet && ((selectedPet === 'all' && totalRecords > 0) || (selectedPet !== 'all' && allRecords[selectedPet] && allRecords[selectedPet].records.length > 0)) && (\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6\">\n          {/* Search Bar */}\n          <div className=\"flex-1 w-full\">\n            <div className=\"relative\">\n              <input\n                type=\"text\"\n                placeholder=\"Search health records, procedures, medications...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent\"\n              />\n            </div>\n          </div>\n\n          {/* Filter Controls */}\n          <div className=\"flex flex-wrap items-center gap-3\">\n            {/* Date Filter */}\n            <CustomDropdown\n              value={dateFilter}\n              onChange={setDateFilter}\n              options={[\n                { value: 'all', label: 'All Time' },\n                { value: 'today', label: 'Today' },\n                { value: 'week', label: 'Past Week' },\n                { value: 'month', label: 'Past Month' },\n                { value: 'year', label: 'Past Year' }\n              ]}\n              placeholder=\"All Time\"\n              dropdownKey=\"date\"\n            />\n\n            {/* Sort By */}\n            <CustomDropdown\n              value={sortBy}\n              onChange={setSortBy}\n              options={[\n                { value: 'date_desc', label: 'Newest First' },\n                { value: 'date_asc', label: 'Oldest First' },\n                { value: 'type', label: 'By Type' },\n                { value: 'cost', label: 'By Cost' }\n              ]}\n              placeholder=\"Newest First\"\n              dropdownKey=\"sort\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Selected Pet's Records */}\n      {selectedPet && (selectedPet === 'all' || allRecords[selectedPet]) && (\n        <div className=\"space-y-4\">\n          {(() => {\n            const currentRecords = selectedPet === 'all' \n              ? Object.values(allRecords).flatMap(item => item.records.map(record => ({...record, petInfo: item.pet})))\n              : allRecords[selectedPet]?.records || [];\n            \n            return currentRecords.length === 0 ? (\n            <div className=\"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300\">\n              <div className=\"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm\">\n                <HealthIcon type=\"records\" className=\"w-8 h-8\" color=\"#6B7280\" />\n              </div>\n              <h4 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                {selectedPet === 'all' ? 'No health records yet' : `No health records yet for ${allRecords[selectedPet].pet.name}`}\n              </h4>\n              <p className=\"text-gray-600 mb-6 max-w-sm mx-auto\">\n                {selectedPet === 'all' \n                  ? 'Start building your pets\\' medical history by adding their first health records.'\n                  : `Start building ${allRecords[selectedPet].pet.name}'s medical history by adding their first health record.`\n                }\n              </p>\n              {selectedPet !== 'all' && (\n                <button \n                  onClick={() => {\n                    if (onAddRecord) {\n                      onAddRecord(allRecords[selectedPet].pet);\n                    }\n                  }}\n                  className=\"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium\"\n                >\n                  <HealthIcon type=\"vaccination\" className=\"w-4 h-4 mr-2\" color=\"white\" />\n                  Add First Record\n                </button>\n              )}\n            </div>\n          ) : (\n            <>\n              {(() => {\n                const filteredRecords = currentRecords\n                  .filter((record) => {\n                    // Search filter\n                    if (searchQuery.trim()) {\n                      const query = searchQuery.toLowerCase();\n                      const matchesSearch = (\n                        record.title?.toLowerCase().includes(query) ||\n                        record.description?.toLowerCase().includes(query) ||\n                        record.record_type?.toLowerCase().includes(query) ||\n                        record.veterinarian_name?.toLowerCase().includes(query) ||\n                        record.clinic_name?.toLowerCase().includes(query) ||\n                        record.notes?.toLowerCase().includes(query) ||\n                        record.medications?.some(med => med.toLowerCase().includes(query))\n                      );\n                      if (!matchesSearch) return false;\n                    }\n\n                    // Date filter\n                    if (dateFilter !== 'all') {\n                      const recordDate = new Date(record.date_performed);\n                      const now = new Date();\n                      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n\n                      switch (dateFilter) {\n                        case 'today':\n                          if (recordDate < today) return false;\n                          break;\n                        case 'week':\n                          const weekAgo = new Date(today);\n                          weekAgo.setDate(weekAgo.getDate() - 7);\n                          if (recordDate < weekAgo) return false;\n                          break;\n                        case 'month':\n                          const monthAgo = new Date(today);\n                          monthAgo.setMonth(monthAgo.getMonth() - 1);\n                          if (recordDate < monthAgo) return false;\n                          break;\n                        case 'year':\n                          const yearAgo = new Date(today);\n                          yearAgo.setFullYear(yearAgo.getFullYear() - 1);\n                          if (recordDate < yearAgo) return false;\n                          break;\n                        default:\n                          // 'all' case - no filtering needed\n                          break;\n                      }\n                    }\n\n                    return true;\n                  })\n                  .sort((a, b) => {\n                    switch (sortBy) {\n                      case 'date_asc':\n                        return new Date(a.date_performed) - new Date(b.date_performed);\n                      case 'date_desc':\n                        return new Date(b.date_performed) - new Date(a.date_performed);\n                      case 'type':\n                        return a.record_type?.localeCompare(b.record_type) || 0;\n                      case 'cost':\n                        const aCost = parseFloat(a.cost) || 0;\n                        const bCost = parseFloat(b.cost) || 0;\n                        return bCost - aCost;\n                      default:\n                        return new Date(b.date_performed) - new Date(a.date_performed);\n                    }\n                  });\n\n                if (filteredRecords.length === 0 && (searchQuery.trim() || dateFilter !== 'all')) {\n                  return (\n                    <div className=\"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300\">\n                      <div className=\"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm\">\n                        <HealthIcon type=\"search\" className=\"w-8 h-8\" color=\"#6B7280\" />\n                      </div>\n                      <h4 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                        No matching health records found\n                      </h4>\n                      <p className=\"text-gray-600 mb-6 max-w-sm mx-auto\">\n                        Try adjusting your search terms or filters to see more records{selectedPet !== 'all' ? ` for ${allRecords[selectedPet].pet.name}` : ''}.\n                      </p>\n                      <button \n                        onClick={() => {\n                          setSearchQuery('');\n                          setDateFilter('all');\n                        }}\n                        className=\"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium\"\n                      >\n                        Clear Filters\n                      </button>\n                    </div>\n                  );\n                }\n\n                return (\n                  <div className=\"space-y-2\">\n                    {searchQuery.trim() && (\n                      <div className=\"text-sm text-gray-600 mb-4\">\n                        Found {filteredRecords.length} record{filteredRecords.length !== 1 ? 's' : ''} matching \"{searchQuery}\"\n                      </div>\n                    )}\n                    {filteredRecords.map((record) => {\n                  const isExpanded = expandedRecords.has(record.id);\n                  return (\n                    <div key={record.id} className=\"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg shadow-sm transition-all duration-200\">\n                      {/* Compact Row */}\n                      <div\n                        onClick={() => toggleRecordExpansion(record.id)}\n                        className=\"p-3 cursor-pointer hover:shadow-md transition-all duration-200 hover:-translate-y-0.5\"\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          {/* Left: Main Info */}\n                          <div className=\"flex items-center space-x-3 flex-1 min-w-0\">\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"flex items-center space-x-2 mb-1\">\n                                <h3 className=\"text-sm font-semibold text-gray-900 truncate\">{record.title}</h3>\n                                <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${getRecordBadgeColor(record.record_type)}`}>\n                                  {record.record_type.replace('_', ' ').toUpperCase()}\n                                </span>\n                              </div>\n                              <div className=\"flex items-center space-x-3 text-xs text-gray-600\">\n                                <span className=\"flex items-center\">\n                                  <HealthIcon type=\"calendar\" className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                  {formatDate(record.date_performed)}\n                                </span>\n                                {selectedPet === 'all' && record.petInfo && (\n                                  <span className=\"flex items-center\">\n                                    <PetIcon species=\"pet\" className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                    {record.petInfo.name}\n                                  </span>\n                                )}\n                                {record.veterinarian_name && (\n                                  <span className=\"flex items-center\">\n                                    <HealthIcon type=\"doctor\" className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                    {record.veterinarian_name}\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n\n                          {/* Right: Cost & Expand Arrow */}\n                          <div className=\"flex items-center space-x-3 flex-shrink-0\">\n                            {record.cost && (\n                              <div className=\"text-right\">\n                                <div className=\"text-sm font-semibold text-green-700\">${record.cost}</div>\n                              </div>\n                            )}\n                            <div className=\"w-6 h-6 bg-white/60 rounded-full flex items-center justify-center\">\n                              <svg \n                                className={`w-3 h-3 text-gray-600 transition-transform duration-200 ${isExpanded ? 'rotate-90' : ''}`} \n                                fill=\"none\" \n                                stroke=\"currentColor\" \n                                viewBox=\"0 0 24 24\"\n                              >\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 5l7 7-7 7\" />\n                              </svg>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      {/* Expanded Details */}\n                      {isExpanded && (\n                        <div className=\"border-t border-gray-200 p-4 bg-white/50\">\n                          {/* Description */}\n                          <div className=\"mb-4\">\n                            <p className=\"text-sm text-gray-700 leading-relaxed\">{record.description}</p>\n                          </div>\n                          \n                          {/* Additional Details */}\n                          <div className=\"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 mb-4\">\n                            {record.clinic_name && (\n                              <div className=\"flex items-center p-3 bg-white rounded-lg border\">\n                                <div className=\"min-w-0\">\n                                  <div className=\"text-xs text-gray-500 font-medium\">Clinic</div>\n                                  <div className=\"text-sm font-semibold text-gray-900 truncate\">{record.clinic_name}</div>\n                                </div>\n                              </div>\n                            )}\n                            \n                            {record.weight && (\n                              <div className=\"flex items-center p-3 bg-white rounded-lg border\">\n                                <HealthIcon type=\"weight\" className=\"w-5 h-5 mr-2 flex-shrink-0\" color=\"#6B7280\" />\n                                <div>\n                                  <div className=\"text-xs text-gray-500 font-medium\">Weight</div>\n                                  <div className=\"text-sm font-semibold text-gray-900\">{record.weight} lbs</div>\n                                </div>\n                              </div>\n                            )}\n                            \n                            {record.temperature && (\n                              <div className=\"flex items-center p-3 bg-white rounded-lg border\">\n                                <HealthIcon type=\"temperature\" className=\"w-5 h-5 mr-2 flex-shrink-0\" color=\"#6B7280\" />\n                                <div>\n                                  <div className=\"text-xs text-gray-500 font-medium\">Temperature</div>\n                                  <div className=\"text-sm font-semibold text-gray-900\">{record.temperature}°F</div>\n                                </div>\n                              </div>\n                            )}\n                          </div>\n\n                          {/* Documents */}\n                          {record.documents && record.documents.length > 0 && (\n                            <div className=\"mb-4\">\n                              <h5 className=\"text-sm font-semibold text-gray-900 mb-2\">\n                                Documents\n                              </h5>\n                              <div className=\"flex flex-wrap gap-2\">\n                                {record.documents.map((doc, idx) => (\n                                  <a\n                                    key={idx}\n                                    href={doc.url}\n                                    target=\"_blank\"\n                                    rel=\"noreferrer\"\n                                    className=\"inline-flex items-center max-w-xs px-2 py-1 rounded-full text-xs border border-gray-200 bg-white hover:bg-gray-50 text-gray-700\"\n                                    title={doc.name}\n                                  >\n                                    <span className=\"mr-1\">\n                                      {(doc.type || '').startsWith('image/') ? \n                                        <HealthIcon type=\"image\" className=\"w-4 h-4\" color=\"currentColor\" /> : \n                                        (doc.type === 'application/pdf' ? \n                                          <HealthIcon type=\"document\" className=\"w-4 h-4\" color=\"currentColor\" /> : \n                                          <HealthIcon type=\"attachment\" className=\"w-4 h-4\" color=\"currentColor\" />\n                                        )\n                                      }\n                                    </span>\n                                    <span className=\"truncate\">{doc.name}</span>\n                                  </a>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n\n                          {/* Medications */}\n                          {record.medications && record.medications.length > 0 && (\n                            <div className=\"mb-4\">\n                              <h5 className=\"text-sm font-semibold text-gray-900 mb-2\">\n                                Medications Prescribed\n                              </h5>\n                              <div className=\"flex flex-wrap gap-2\">\n                                {record.medications.map((med, index) => (\n                                  <span key={index} className=\"inline-flex items-center px-3 py-1 bg-white text-gray-700 rounded-full text-sm font-medium border\">\n                                    {med}\n                                  </span>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n\n                          {/* Notes */}\n                          {record.notes && (\n                            <div className=\"mb-4\">\n                              <h5 className=\"text-sm font-semibold text-gray-900 mb-2 flex items-center\">\n                                <UIIcon type=\"write\" className=\"w-4 h-4 mr-2\" color=\"currentColor\" />\n                                Additional Notes\n                              </h5>\n                              <div className=\"p-3 bg-white rounded-lg border\">\n                                <p className=\"text-sm text-gray-700 leading-relaxed\">{record.notes}</p>\n                              </div>\n                            </div>\n                          )}\n\n                          {/* Action Buttons */}\n                          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0 pt-3 border-t border-gray-200\">\n                            <div className=\"text-xs text-gray-500\">\n                              Added {new Date(record.created_at).toLocaleDateString('en-US', {\n                                year: 'numeric',\n                                month: 'short',\n                                day: 'numeric'\n                              })}\n                            </div>\n                            <div className=\"flex space-x-2\">\n                              <button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleEditRecord(record);\n                                }}\n                                className=\"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-white hover:bg-gray-50 text-gray-700 hover:text-gray-900 rounded-lg transition-all duration-200 text-sm font-medium border hover:shadow-sm\"\n                              >\n                                Edit\n                              </button>\n                              <button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleDeleteRecord(record.id);\n                                }}\n                                disabled={deletingId === record.id}\n                                className=\"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 hover:text-red-800 rounded-lg transition-all duration-200 text-sm font-medium disabled:opacity-50\"\n                              >\n                                {deletingId === record.id ? (\n                                  <>\n                                    <div className=\"animate-spin rounded-full h-3 w-3 border border-red-600 border-t-transparent mr-1\"></div>\n                                    <span className=\"hidden sm:inline\">Deleting...</span>\n                                    <span className=\"sm:hidden\">...</span>\n                                  </>\n                                ) : (\n                                  <>\n                                    <span className=\"hidden sm:inline\">Delete</span>\n                                    <span className=\"sm:hidden\">Del</span>\n                                  </>\n                                )}\n                              </button>\n                            </div>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                    );\n                  })}\n                  </div>\n                );\n              })()}\n            </>\n          );\n        })()}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Single-pet health records viewer (keeping for backward compatibility)\nconst SinglePetHealthRecordsViewer = ({ petId, petName }) => {\n  const [records, setRecords] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (petId) {\n      loadHealthRecords();\n    } else {\n      setLoading(false);\n    }\n  }, [petId]);\n\n  const loadHealthRecords = async () => {\n    setLoading(true);\n    try {\n      const result = await healthRecordService.getHealthRecords(petId);\n      if (result.success) {\n        setRecords(result.data);\n      }\n    } catch (error) {\n      console.error('Error loading health records:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return <div className=\"text-center py-4\">Loading health records...</div>;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"text-lg font-semibold\">Health Records for {petName}</h3>\n      {records.length === 0 ? (\n        <p className=\"text-gray-600\">No health records yet.</p>\n      ) : (\n        <div className=\"space-y-2\">\n          {records.map((record) => (\n            <div key={record.id} className=\"p-4 border rounded-lg\">\n              <h4 className=\"font-medium\">{record.title}</h4>\n              <p className=\"text-sm text-gray-600\">{record.description}</p>\n              <p className=\"text-xs text-gray-500\">\n                {new Date(record.date_performed).toLocaleDateString()}\n              </p>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Main component that decides which viewer to use\nconst HealthRecordsViewer = ({ petId, petName, pets, userPlan, onEditRecord, onDeleteRecord, onRefresh, onAddRecord, refreshKey }) => {\n  // Always call hooks at the top level - no conditional hook calls\n  const [shouldUseSingleViewer] = useState(!pets && petId);\n  \n  // If pets array is provided, use the multi-pet viewer\n  if (pets) {\n    return (\n      <MultiPetHealthRecordsViewer \n        pets={pets} \n        userPlan={userPlan} \n        onEditRecord={onEditRecord}\n        onDeleteRecord={onDeleteRecord}\n        onRefresh={onRefresh}\n        onAddRecord={onAddRecord}\n        refreshKey={refreshKey}\n      />\n    );\n  }\n  \n  // If petId is provided but no pets array, use single-pet viewer\n  if (shouldUseSingleViewer) {\n    return <SinglePetHealthRecordsViewer petId={petId} petName={petName} />;\n  }\n  \n  // Fallback\n  return (\n    <div className=\"text-center py-8\">\n      <div className=\"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center\">\n        <HealthIcon type=\"health\" className=\"w-8 h-8\" color=\"#6B7280\" />\n      </div>\n      <p className=\"text-gray-600\">No pet data provided</p>\n    </div>\n  );\n};\n\nexport default HealthRecordsViewer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}