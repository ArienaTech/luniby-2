{"ast":null,"code":"import { browserPerformanceTimeOrigin } from '@sentry/core';\nimport { extractNetworkProtocol } from '@sentry-internal/browser-utils';\nfunction getAbsoluteTime() {\n  let time = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return ((browserPerformanceTimeOrigin() || performance.timeOrigin) + time) / 1000;\n}\n\n/**\n * Converts a PerformanceResourceTiming entry to span data for the resource span.\n *\n * @param resourceTiming\n * @returns An array where the first element is the attribute name and the second element is the attribute value.\n */\nfunction resourceTimingToSpanAttributes(resourceTiming) {\n  const timingSpanData = [];\n  // Checking for only `undefined` and `null` is intentional because it's\n  // valid for `nextHopProtocol` to be an empty string.\n  if (resourceTiming.nextHopProtocol != undefined) {\n    const {\n      name,\n      version\n    } = extractNetworkProtocol(resourceTiming.nextHopProtocol);\n    timingSpanData.push(['network.protocol.version', version], ['network.protocol.name', name]);\n  }\n  if (!browserPerformanceTimeOrigin()) {\n    return timingSpanData;\n  }\n  return [...timingSpanData, ['http.request.redirect_start', getAbsoluteTime(resourceTiming.redirectStart)], ['http.request.fetch_start', getAbsoluteTime(resourceTiming.fetchStart)], ['http.request.domain_lookup_start', getAbsoluteTime(resourceTiming.domainLookupStart)], ['http.request.domain_lookup_end', getAbsoluteTime(resourceTiming.domainLookupEnd)], ['http.request.connect_start', getAbsoluteTime(resourceTiming.connectStart)], ['http.request.secure_connection_start', getAbsoluteTime(resourceTiming.secureConnectionStart)], ['http.request.connection_end', getAbsoluteTime(resourceTiming.connectEnd)], ['http.request.request_start', getAbsoluteTime(resourceTiming.requestStart)], ['http.request.response_start', getAbsoluteTime(resourceTiming.responseStart)], ['http.request.response_end', getAbsoluteTime(resourceTiming.responseEnd)]];\n}\nexport { resourceTimingToSpanAttributes };","map":{"version":3,"names":["getAbsoluteTime","time","arguments","length","undefined","browserPerformanceTimeOrigin","performance","timeOrigin","resourceTimingToSpanAttributes","resourceTiming","timingSpanData","nextHopProtocol","name","version","extractNetworkProtocol","push","redirectStart","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd"],"sources":["/workspace/node_modules/@sentry/browser/src/tracing/resource-timing.ts"],"sourcesContent":["import type { Span } from '@sentry/core';\nimport { browserPerformanceTimeOrigin } from '@sentry/core';\nimport { extractNetworkProtocol } from '@sentry-internal/browser-utils';\n\nfunction getAbsoluteTime(time: number = 0): number {\n  return ((browserPerformanceTimeOrigin() || performance.timeOrigin) + time) / 1000;\n}\n\n/**\n * Converts a PerformanceResourceTiming entry to span data for the resource span.\n *\n * @param resourceTiming\n * @returns An array where the first element is the attribute name and the second element is the attribute value.\n */\nexport function resourceTimingToSpanAttributes(\n  resourceTiming: PerformanceResourceTiming,\n): Array<Parameters<Span['setAttribute']>> {\n  const timingSpanData: Array<Parameters<Span['setAttribute']>> = [];\n  // Checking for only `undefined` and `null` is intentional because it's\n  // valid for `nextHopProtocol` to be an empty string.\n  if (resourceTiming.nextHopProtocol != undefined) {\n    const { name, version } = extractNetworkProtocol(resourceTiming.nextHopProtocol);\n    timingSpanData.push(['network.protocol.version', version], ['network.protocol.name', name]);\n  }\n  if (!browserPerformanceTimeOrigin()) {\n    return timingSpanData;\n  }\n  return [\n    ...timingSpanData,\n    ['http.request.redirect_start', getAbsoluteTime(resourceTiming.redirectStart)],\n    ['http.request.fetch_start', getAbsoluteTime(resourceTiming.fetchStart)],\n    ['http.request.domain_lookup_start', getAbsoluteTime(resourceTiming.domainLookupStart)],\n    ['http.request.domain_lookup_end', getAbsoluteTime(resourceTiming.domainLookupEnd)],\n    ['http.request.connect_start', getAbsoluteTime(resourceTiming.connectStart)],\n    ['http.request.secure_connection_start', getAbsoluteTime(resourceTiming.secureConnectionStart)],\n    ['http.request.connection_end', getAbsoluteTime(resourceTiming.connectEnd)],\n    ['http.request.request_start', getAbsoluteTime(resourceTiming.requestStart)],\n    ['http.request.response_start', getAbsoluteTime(resourceTiming.responseStart)],\n    ['http.request.response_end', getAbsoluteTime(resourceTiming.responseEnd)],\n  ];\n}\n"],"mappings":";;AAIA,SAASA,eAAeA,CAAA,EAA2B;EAAA,IAA1BC,IAAI,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAW,CAAC;EACvC,OAAO,CAAC,CAACG,4BAA4B,EAAC,IAAKC,WAAW,CAACC,UAAU,IAAIN,IAAI,IAAI,IAAI;AACnF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASO,8BAA8BA,CAC5CC,cAAc,EAC2B;EACzC,MAAMC,cAAc,GAA4C,EAAE;EACpE;EACA;EACE,IAAID,cAAc,CAACE,eAAA,IAAmBP,SAAS,EAAE;IAC/C,MAAM;MAAEQ,IAAI;MAAEC;IAAA,CAAQ,GAAIC,sBAAsB,CAACL,cAAc,CAACE,eAAe,CAAC;IAChFD,cAAc,CAACK,IAAI,CAAC,CAAC,0BAA0B,EAAEF,OAAO,CAAC,EAAE,CAAC,uBAAuB,EAAED,IAAI,CAAC,CAAC;EAC/F;EACE,IAAI,CAACP,4BAA4B,EAAE,EAAE;IACnC,OAAOK,cAAc;EACzB;EACE,OAAO,CACL,GAAGA,cAAc,EACjB,CAAC,6BAA6B,EAAEV,eAAe,CAACS,cAAc,CAACO,aAAa,CAAC,CAAC,EAC9E,CAAC,0BAA0B,EAAEhB,eAAe,CAACS,cAAc,CAACQ,UAAU,CAAC,CAAC,EACxE,CAAC,kCAAkC,EAAEjB,eAAe,CAACS,cAAc,CAACS,iBAAiB,CAAC,CAAC,EACvF,CAAC,gCAAgC,EAAElB,eAAe,CAACS,cAAc,CAACU,eAAe,CAAC,CAAC,EACnF,CAAC,4BAA4B,EAAEnB,eAAe,CAACS,cAAc,CAACW,YAAY,CAAC,CAAC,EAC5E,CAAC,sCAAsC,EAAEpB,eAAe,CAACS,cAAc,CAACY,qBAAqB,CAAC,CAAC,EAC/F,CAAC,6BAA6B,EAAErB,eAAe,CAACS,cAAc,CAACa,UAAU,CAAC,CAAC,EAC3E,CAAC,4BAA4B,EAAEtB,eAAe,CAACS,cAAc,CAACc,YAAY,CAAC,CAAC,EAC5E,CAAC,6BAA6B,EAAEvB,eAAe,CAACS,cAAc,CAACe,aAAa,CAAC,CAAC,EAC9E,CAAC,2BAA2B,EAAExB,eAAe,CAACS,cAAc,CAACgB,WAAW,CAAC,CAAC,CAC3E;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}