{"ast":null,"code":"import React,{useState,useEffect}from'react';import{supabase}from'../../lib/supabase';import SOAPNoteEditor from'./SOAPNoteEditor';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CaseManager=_ref=>{let{nurseId,initialFilter='all'}=_ref;const[allCases,setAllCases]=useState([]);const[loading,setLoading]=useState(true);const[selectedCase,setSelectedCase]=useState(null);const[showSOAPEditor,setShowSOAPEditor]=useState(false);const[dbError,setDbError]=useState(null);const[activeFilter,setActiveFilter]=useState(initialFilter);const[searchTerm,setSearchTerm]=useState('');const[sortBy,setSortBy]=useState('severity');// Default sort by severity (most urgent first)\n// LuniTriage severity levels (matching the AI system)\nconst SEVERITY_LEVELS={emergency:{label:'Emergency',color:'bg-red-100 text-red-800 border-red-200',icon:'🚨',priority:4,description:'Immediate veterinary attention required'},serious:{label:'Serious',color:'bg-orange-100 text-orange-800 border-orange-200',icon:'⚠️',priority:3,description:'Urgent veterinary care needed'},moderate:{label:'Moderate',color:'bg-yellow-100 text-yellow-800 border-yellow-200',icon:'📋',priority:2,description:'Veterinary assessment recommended'},mild:{label:'Mild',color:'bg-green-100 text-green-800 border-green-200',icon:'✅',priority:1,description:'Monitor and routine care'},pending:{label:'Pending Assessment',color:'bg-blue-100 text-blue-800 border-blue-200',icon:'⏳',priority:0,description:'Awaiting triage assessment'}};// Service type indicators\nconst SERVICE_TYPES={'LuniTriage SOAP Review':{icon:'📋',label:'SOAP Review',color:'bg-purple-100 text-purple-800'},'LuniTriage Consultation':{icon:'💬',label:'Consultation',color:'bg-blue-100 text-blue-800'},'Mobile Consultation':{icon:'🏠',label:'Mobile Visit',color:'bg-green-100 text-green-800'},'Emergency Care':{icon:'🚨',label:'Emergency',color:'bg-red-100 text-red-800'},'Health Check':{icon:'🩺',label:'Health Check',color:'bg-teal-100 text-teal-800'},'Follow-up':{icon:'🔄',label:'Follow-up',color:'bg-gray-100 text-gray-800'}};// Filter options based on severity\nconst filterOptions=[{id:'all',name:'All Cases',count:allCases.length},{id:'emergency',name:'Emergency',count:allCases.filter(c=>c.severity==='emergency').length,color:'text-red-600'},{id:'serious',name:'Serious',count:allCases.filter(c=>c.severity==='serious').length,color:'text-orange-600'},{id:'moderate',name:'Moderate',count:allCases.filter(c=>c.severity==='moderate').length,color:'text-yellow-600'},{id:'mild',name:'Mild',count:allCases.filter(c=>c.severity==='mild').length,color:'text-green-600'},{id:'pending',name:'Pending Assessment',count:allCases.filter(c=>c.severity==='pending').length,color:'text-blue-600'},{id:'assigned',name:'My Cases',count:allCases.filter(c=>c.assigned_nurse_id===nurseId).length,color:'text-purple-600'}];useEffect(()=>{if(initialFilter&&initialFilter!=='all'){setActiveFilter(initialFilter);}},[initialFilter]);useEffect(()=>{loadAllCases();},[nurseId]);const loadAllCases=async()=>{try{setLoading(true);setDbError(null);if(!nurseId){setLoading(false);setAllCases([]);return;}// Load all cases from multiple sources and unify them\nconst casesFromSources=await Promise.allSettled([loadRegularCases(),loadTriageBookings(),loadConsultationBookings()]);const allCasesData=[];// Process results from all sources\ncasesFromSources.forEach((result,index)=>{if(result.status==='fulfilled'&&result.value){allCasesData.push(...result.value);}});// Sort by severity (Emergency -> Serious -> Moderate -> Mild -> Pending)\nallCasesData.sort((a,b)=>{var _SEVERITY_LEVELS$a$se,_SEVERITY_LEVELS$b$se;const severityA=((_SEVERITY_LEVELS$a$se=SEVERITY_LEVELS[a.severity])===null||_SEVERITY_LEVELS$a$se===void 0?void 0:_SEVERITY_LEVELS$a$se.priority)||0;const severityB=((_SEVERITY_LEVELS$b$se=SEVERITY_LEVELS[b.severity])===null||_SEVERITY_LEVELS$b$se===void 0?void 0:_SEVERITY_LEVELS$b$se.priority)||0;return severityB-severityA;// Highest priority first\n});setAllCases(allCasesData);}catch(error){console.error('Error loading cases:',error);setDbError('general_error');setAllCases([]);}finally{setLoading(false);}};const loadRegularCases=async()=>{try{var _error$message;const{data,error}=await supabase.from('cases').select(`\n          *,\n          customer:profiles!cases_customer_id_fkey(full_name, email),\n          soap_notes(id, status, created_at)\n        `).or(`assigned_nurse_id.eq.${nurseId},status.eq.new`);if(error&&!((_error$message=error.message)!==null&&_error$message!==void 0&&_error$message.includes('relation \"cases\" does not exist'))){throw error;}return(data||[]).map(case_item=>({...case_item,source:'cases',service_type:case_item.case_type||'General Case',severity:case_item.priority||'pending'// Map existing priority to severity\n}));}catch(error){console.error('Error loading regular cases:',error);return[];}};const loadTriageBookings=async()=>{try{const{data,error}=await supabase.from('consultation_bookings').select(`\n          *,\n          marketplace_listings (name, service_types)\n        `).in('consultation_type',['LuniTriage SOAP Review','LuniTriage Consultation']).in('status',['pending','confirmed','in_progress']);if(error)throw error;return(data||[]).map(booking=>({id:`booking_${booking.id}`,case_number:`LT-${booking.id}`,title:`${booking.pet_name} - ${booking.consultation_type}`,description:booking.consultation_reason||'LuniTriage assessment required',severity:booking.triage_priority||'pending',// Use triage priority if available\nstatus:booking.status==='pending'?'pending_assessment':booking.status,pet_name:booking.pet_name,customer_name:booking.customer_name,customer_email:booking.customer_email,service_type:booking.consultation_type,created_at:booking.created_at,updated_at:booking.updated_at,source:'triage_booking',customer:{full_name:booking.customer_name,email:booking.customer_email},booking_data:{appointment_date:booking.appointment_date,appointment_time:booking.appointment_time,booking_id:booking.id}}));}catch(error){console.error('Error loading triage bookings:',error);return[];}};const loadConsultationBookings=async()=>{try{const{data,error}=await supabase.from('consultation_bookings').select(`\n          *,\n          marketplace_listings (name, service_types)\n        `).not('consultation_type','in',['LuniTriage SOAP Review','LuniTriage Consultation']).in('status',['pending','confirmed','in_progress']);if(error)throw error;return(data||[]).map(booking=>({id:`consultation_${booking.id}`,case_number:`CS-${booking.id}`,title:`${booking.pet_name} - ${booking.consultation_type||'Consultation'}`,description:booking.consultation_reason||'Consultation scheduled',severity:'moderate',// Default severity for regular consultations\nstatus:booking.status,pet_name:booking.pet_name,customer_name:booking.customer_name,customer_email:booking.customer_email,service_type:booking.consultation_type||'Consultation',created_at:booking.created_at,updated_at:booking.updated_at,source:'consultation_booking',customer:{full_name:booking.customer_name,email:booking.customer_email},booking_data:{appointment_date:booking.appointment_date,appointment_time:booking.appointment_time,booking_id:booking.id}}));}catch(error){console.error('Error loading consultation bookings:',error);return[];}};const getSeverityBadge=severity=>{const config=SEVERITY_LEVELS[severity]||SEVERITY_LEVELS.pending;return/*#__PURE__*/_jsxs(\"span\",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${config.color}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-1\",children:config.icon}),config.label]});};const getServiceTypeBadge=serviceType=>{const config=SERVICE_TYPES[serviceType]||{icon:'📄',label:serviceType,color:'bg-gray-100 text-gray-800'};return/*#__PURE__*/_jsxs(\"span\",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${config.color}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-1\",children:config.icon}),config.label]});};const getFilteredCases=()=>{let filtered=allCases;// Apply severity filter\nif(activeFilter!=='all'&&activeFilter!=='assigned'){filtered=filtered.filter(c=>c.severity===activeFilter);}else if(activeFilter==='assigned'){filtered=filtered.filter(c=>c.assigned_nurse_id===nurseId);}// Apply search filter\nif(searchTerm){const searchLower=searchTerm.toLowerCase();filtered=filtered.filter(c=>{var _c$title,_c$description,_c$case_number,_c$pet_name,_c$customer_name;return((_c$title=c.title)===null||_c$title===void 0?void 0:_c$title.toLowerCase().includes(searchLower))||((_c$description=c.description)===null||_c$description===void 0?void 0:_c$description.toLowerCase().includes(searchLower))||((_c$case_number=c.case_number)===null||_c$case_number===void 0?void 0:_c$case_number.toLowerCase().includes(searchLower))||((_c$pet_name=c.pet_name)===null||_c$pet_name===void 0?void 0:_c$pet_name.toLowerCase().includes(searchLower))||((_c$customer_name=c.customer_name)===null||_c$customer_name===void 0?void 0:_c$customer_name.toLowerCase().includes(searchLower));});}// Apply sorting\nif(sortBy==='severity'){filtered.sort((a,b)=>{var _SEVERITY_LEVELS$a$se2,_SEVERITY_LEVELS$b$se2;const severityA=((_SEVERITY_LEVELS$a$se2=SEVERITY_LEVELS[a.severity])===null||_SEVERITY_LEVELS$a$se2===void 0?void 0:_SEVERITY_LEVELS$a$se2.priority)||0;const severityB=((_SEVERITY_LEVELS$b$se2=SEVERITY_LEVELS[b.severity])===null||_SEVERITY_LEVELS$b$se2===void 0?void 0:_SEVERITY_LEVELS$b$se2.priority)||0;return severityB-severityA;});}else if(sortBy==='created_at'){filtered.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));}return filtered;};const handleCaseClick=caseItem=>{setSelectedCase(caseItem);if(caseItem.source==='triage_booking'){// For triage cases, could open LuniTriage interface or SOAP editor\nconsole.log('Opening triage case for assessment:',caseItem);}setShowSOAPEditor(true);};const handleUpdateSeverity=async(caseId,newSeverity)=>{try{// Update severity based on case source\nconst caseItem=allCases.find(c=>c.id===caseId);if(!caseItem)return;if(caseItem.source==='triage_booking'){const bookingId=caseItem.booking_data.booking_id;const{error}=await supabase.from('consultation_bookings').update({triage_priority:newSeverity,status:'assessed',updated_at:new Date().toISOString()}).eq('id',bookingId);if(error)throw error;}else if(caseItem.source==='cases'){const{error}=await supabase.from('cases').update({priority:newSeverity,updated_at:new Date().toISOString()}).eq('id',caseId);if(error)throw error;}// Update local state\nsetAllCases(prev=>prev.map(c=>c.id===caseId?{...c,severity:newSeverity}:c));}catch(error){console.error('Error updating severity:',error);}};const getTimeAgo=dateString=>{const date=new Date(dateString);const now=new Date();const diffInMinutes=Math.floor((now-date)/(1000*60));if(diffInMinutes<60){return`${diffInMinutes}m ago`;}else if(diffInMinutes<1440){return`${Math.floor(diffInMinutes/60)}h ago`;}else{return`${Math.floor(diffInMinutes/1440)}d ago`;}};const filteredCases=getFilteredCases();// If database migration is needed, show setup message\nif(dbError==='migration_needed'){return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\u2699\\uFE0F\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-yellow-800 mb-2\",children:\"Database Setup Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-700 mb-4\",children:\"The case management system needs to be set up in your database. Please run the case management migration to enable this feature.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-100 border border-yellow-300 rounded p-3 text-left\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-yellow-800 mb-2\",children:\"Migration File:\"}),/*#__PURE__*/_jsx(\"code\",{className:\"text-xs text-yellow-700 bg-yellow-200 px-2 py-1 rounded\",children:\"database/migrations/011_case_management_system.sql\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:loadAllCases,className:\"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-yellow-700 bg-yellow-100 hover:bg-yellow-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),\"Retry\"]})]})});}// If general database error, show error message\nif(dbError==='general_error'){return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-6 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\u274C\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-red-800 mb-2\",children:\"Database Error\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-700 mb-4\",children:\"There was an error connecting to the case management system. Please try again or contact support.\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:loadAllCases,className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"})}),\"Retry\"]})]})});}if(showSOAPEditor&&selectedCase){var _selectedCase$soap_no;return/*#__PURE__*/_jsx(SOAPNoteEditor,{caseId:selectedCase.id,existingNote:(_selectedCase$soap_no=selectedCase.soap_notes)===null||_selectedCase$soap_no===void 0?void 0:_selectedCase$soap_no[0],onSave:()=>{setShowSOAPEditor(false);setSelectedCase(null);loadAllCases();},onCancel:()=>{setShowSOAPEditor(false);setSelectedCase(null);}});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-sm border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-900\",children:\"Cases\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-700\",children:\"All cases with LuniTriage severity assessment\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[filteredCases.length,\" case\",filteredCases.length!==1?'s':'']}),/*#__PURE__*/_jsxs(\"button\",{className:\"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})}),\"New Case\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-6 gap-4 mt-4 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"Search cases...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Filter by Severity\"}),/*#__PURE__*/_jsx(\"select\",{value:activeFilter,onChange:e=>setActiveFilter(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:filterOptions.map(option=>/*#__PURE__*/_jsxs(\"option\",{value:option.id,children:[option.name,\" (\",option.count,\")\"]},option.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Sort By\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"severity\",children:\"Severity (Most Urgent)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"created_at\",children:\"Newest First\"}),/*#__PURE__*/_jsx(\"option\",{value:\"case_number\",children:\"Case Number\"})]})]})]})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-4\",children:\"Loading cases...\"})]}):filteredCases.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 bg-white rounded-lg shadow-sm border p-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\uD83D\\uDCCB\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"No cases found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:searchTerm||activeFilter!=='all'||activeFilter!=='assigned'?'Try adjusting your filters to see more cases.':'New cases will appear here when customers book consultations.'})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:filteredCases.map(caseItem=>{var _caseItem$customer,_caseItem$soap_notes;return/*#__PURE__*/_jsx(\"div\",{className:`bg-white rounded-lg shadow border-2 hover:shadow-lg transition-all cursor-pointer ${caseItem.severity==='emergency'?'border-red-300 bg-red-50':caseItem.severity==='serious'?'border-orange-300 bg-orange-50':caseItem.severity==='moderate'?'border-yellow-300 bg-yellow-50':caseItem.severity==='mild'?'border-green-300 bg-green-50':'border-blue-300 bg-blue-50'}`,onClick:()=>handleCaseClick(caseItem),children:/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:caseItem.title}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-mono text-gray-500\",children:[\"#\",caseItem.case_number]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-3\",children:[getSeverityBadge(caseItem.severity),getServiceTypeBadge(caseItem.service_type)]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mb-4 line-clamp-2\",children:caseItem.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-6 text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"})}),((_caseItem$customer=caseItem.customer)===null||_caseItem$customer===void 0?void 0:_caseItem$customer.full_name)||caseItem.customer_name||'Unknown Customer']}),caseItem.pet_name&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"})}),\"Pet: \",caseItem.pet_name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"})}),getTimeAgo(caseItem.created_at)]}),caseItem.due_date&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"})}),\"Due: \",new Date(caseItem.due_date).toLocaleDateString()]}),((_caseItem$soap_notes=caseItem.soap_notes)===null||_caseItem$soap_notes===void 0?void 0:_caseItem$soap_notes.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-green-600\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),\"SOAP Note Available\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-end space-y-3 ml-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:getTimeAgo(caseItem.created_at)}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleCaseClick(caseItem);},className:`inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors ${caseItem.severity==='emergency'?'bg-red-600 hover:bg-red-700':caseItem.severity==='serious'?'bg-orange-600 hover:bg-orange-700':caseItem.severity==='moderate'?'bg-yellow-600 hover:bg-yellow-700':caseItem.severity==='mild'?'bg-green-600 hover:bg-green-700':'bg-blue-600 hover:bg-blue-700'}`,children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),caseItem.severity==='pending'?'Start Triage':caseItem.source==='triage_booking'?'Review':'View Details']}),caseItem.severity==='pending'&&/*#__PURE__*/_jsxs(\"select\",{onChange:e=>{e.stopPropagation();if(e.target.value){handleUpdateSeverity(caseItem.id,e.target.value);}},className:\"text-xs px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 focus:ring-2 focus:ring-blue-500\",defaultValue:\"\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Quick Assess\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mild\",children:\"\\u2705 Mild\"}),/*#__PURE__*/_jsx(\"option\",{value:\"moderate\",children:\"\\uD83D\\uDCCB Moderate\"}),/*#__PURE__*/_jsx(\"option\",{value:\"serious\",children:\"\\u26A0\\uFE0F Serious\"}),/*#__PURE__*/_jsx(\"option\",{value:\"emergency\",children:\"\\uD83D\\uDEA8 Emergency\"})]})]})]})})},caseItem.id);})})]});};export default CaseManager;","map":{"version":3,"names":["React","useState","useEffect","supabase","SOAPNoteEditor","jsx","_jsx","jsxs","_jsxs","CaseManager","_ref","nurseId","initialFilter","allCases","setAllCases","loading","setLoading","selectedCase","setSelectedCase","showSOAPEditor","setShowSOAPEditor","dbError","setDbError","activeFilter","setActiveFilter","searchTerm","setSearchTerm","sortBy","setSortBy","SEVERITY_LEVELS","emergency","label","color","icon","priority","description","serious","moderate","mild","pending","SERVICE_TYPES","filterOptions","id","name","count","length","filter","c","severity","assigned_nurse_id","loadAllCases","casesFromSources","Promise","allSettled","loadRegularCases","loadTriageBookings","loadConsultationBookings","allCasesData","forEach","result","index","status","value","push","sort","a","b","_SEVERITY_LEVELS$a$se","_SEVERITY_LEVELS$b$se","severityA","severityB","error","console","_error$message","data","from","select","or","message","includes","map","case_item","source","service_type","case_type","in","booking","case_number","title","pet_name","consultation_type","consultation_reason","triage_priority","customer_name","customer_email","created_at","updated_at","customer","full_name","email","booking_data","appointment_date","appointment_time","booking_id","not","getSeverityBadge","config","className","children","getServiceTypeBadge","serviceType","getFilteredCases","filtered","searchLower","toLowerCase","_c$title","_c$description","_c$case_number","_c$pet_name","_c$customer_name","_SEVERITY_LEVELS$a$se2","_SEVERITY_LEVELS$b$se2","Date","handleCaseClick","caseItem","log","handleUpdateSeverity","caseId","newSeverity","find","bookingId","update","toISOString","eq","prev","getTimeAgo","dateString","date","now","diffInMinutes","Math","floor","filteredCases","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_selectedCase$soap_no","existingNote","soap_notes","onSave","onCancel","type","onChange","e","target","placeholder","option","_caseItem$customer","_caseItem$soap_notes","due_date","toLocaleDateString","stopPropagation","defaultValue"],"sources":["/workspace/src/components/vet-nurse/CaseManager.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport SOAPNoteEditor from './SOAPNoteEditor';\n\nconst CaseManager = ({ nurseId, initialFilter = 'all' }) => {\n  const [allCases, setAllCases] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedCase, setSelectedCase] = useState(null);\n  const [showSOAPEditor, setShowSOAPEditor] = useState(false);\n  const [dbError, setDbError] = useState(null);\n  const [activeFilter, setActiveFilter] = useState(initialFilter);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [sortBy, setSortBy] = useState('severity'); // Default sort by severity (most urgent first)\n\n  // LuniTriage severity levels (matching the AI system)\n  const SEVERITY_LEVELS = {\n    emergency: { \n      label: 'Emergency', \n      color: 'bg-red-100 text-red-800 border-red-200', \n      icon: '🚨', \n      priority: 4,\n      description: 'Immediate veterinary attention required'\n    },\n    serious: { \n      label: 'Serious', \n      color: 'bg-orange-100 text-orange-800 border-orange-200', \n      icon: '⚠️', \n      priority: 3,\n      description: 'Urgent veterinary care needed'\n    },\n    moderate: { \n      label: 'Moderate', \n      color: 'bg-yellow-100 text-yellow-800 border-yellow-200', \n      icon: '📋', \n      priority: 2,\n      description: 'Veterinary assessment recommended'\n    },\n    mild: { \n      label: 'Mild', \n      color: 'bg-green-100 text-green-800 border-green-200', \n      icon: '✅', \n      priority: 1,\n      description: 'Monitor and routine care'\n    },\n    pending: { \n      label: 'Pending Assessment', \n      color: 'bg-blue-100 text-blue-800 border-blue-200', \n      icon: '⏳', \n      priority: 0,\n      description: 'Awaiting triage assessment'\n    }\n  };\n\n  // Service type indicators\n  const SERVICE_TYPES = {\n    'LuniTriage SOAP Review': { icon: '📋', label: 'SOAP Review', color: 'bg-purple-100 text-purple-800' },\n    'LuniTriage Consultation': { icon: '💬', label: 'Consultation', color: 'bg-blue-100 text-blue-800' },\n    'Mobile Consultation': { icon: '🏠', label: 'Mobile Visit', color: 'bg-green-100 text-green-800' },\n    'Emergency Care': { icon: '🚨', label: 'Emergency', color: 'bg-red-100 text-red-800' },\n    'Health Check': { icon: '🩺', label: 'Health Check', color: 'bg-teal-100 text-teal-800' },\n    'Follow-up': { icon: '🔄', label: 'Follow-up', color: 'bg-gray-100 text-gray-800' }\n  };\n\n  // Filter options based on severity\n  const filterOptions = [\n    { id: 'all', name: 'All Cases', count: allCases.length },\n    { id: 'emergency', name: 'Emergency', count: allCases.filter(c => c.severity === 'emergency').length, color: 'text-red-600' },\n    { id: 'serious', name: 'Serious', count: allCases.filter(c => c.severity === 'serious').length, color: 'text-orange-600' },\n    { id: 'moderate', name: 'Moderate', count: allCases.filter(c => c.severity === 'moderate').length, color: 'text-yellow-600' },\n    { id: 'mild', name: 'Mild', count: allCases.filter(c => c.severity === 'mild').length, color: 'text-green-600' },\n    { id: 'pending', name: 'Pending Assessment', count: allCases.filter(c => c.severity === 'pending').length, color: 'text-blue-600' },\n    { id: 'assigned', name: 'My Cases', count: allCases.filter(c => c.assigned_nurse_id === nurseId).length, color: 'text-purple-600' }\n  ];\n\n  useEffect(() => {\n    if (initialFilter && initialFilter !== 'all') {\n      setActiveFilter(initialFilter);\n    }\n  }, [initialFilter]);\n\n  useEffect(() => {\n    loadAllCases();\n  }, [nurseId]);\n\n  const loadAllCases = async () => {\n    try {\n      setLoading(true);\n      setDbError(null);\n      \n      if (!nurseId) {\n        setLoading(false);\n        setAllCases([]);\n        return;\n      }\n\n      // Load all cases from multiple sources and unify them\n      const casesFromSources = await Promise.allSettled([\n        loadRegularCases(),\n        loadTriageBookings(),\n        loadConsultationBookings()\n      ]);\n\n      const allCasesData = [];\n      \n      // Process results from all sources\n      casesFromSources.forEach((result, index) => {\n        if (result.status === 'fulfilled' && result.value) {\n          allCasesData.push(...result.value);\n        }\n      });\n\n      // Sort by severity (Emergency -> Serious -> Moderate -> Mild -> Pending)\n      allCasesData.sort((a, b) => {\n        const severityA = SEVERITY_LEVELS[a.severity]?.priority || 0;\n        const severityB = SEVERITY_LEVELS[b.severity]?.priority || 0;\n        return severityB - severityA; // Highest priority first\n      });\n\n      setAllCases(allCasesData);\n    } catch (error) {\n      console.error('Error loading cases:', error);\n      setDbError('general_error');\n      setAllCases([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRegularCases = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('cases')\n        .select(`\n          *,\n          customer:profiles!cases_customer_id_fkey(full_name, email),\n          soap_notes(id, status, created_at)\n        `)\n        .or(`assigned_nurse_id.eq.${nurseId},status.eq.new`);\n\n      if (error && !error.message?.includes('relation \"cases\" does not exist')) {\n        throw error;\n      }\n\n      return (data || []).map(case_item => ({\n        ...case_item,\n        source: 'cases',\n        service_type: case_item.case_type || 'General Case',\n        severity: case_item.priority || 'pending' // Map existing priority to severity\n      }));\n    } catch (error) {\n      console.error('Error loading regular cases:', error);\n      return [];\n    }\n  };\n\n  const loadTriageBookings = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('consultation_bookings')\n        .select(`\n          *,\n          marketplace_listings (name, service_types)\n        `)\n        .in('consultation_type', ['LuniTriage SOAP Review', 'LuniTriage Consultation'])\n        .in('status', ['pending', 'confirmed', 'in_progress']);\n\n      if (error) throw error;\n\n      return (data || []).map(booking => ({\n        id: `booking_${booking.id}`,\n        case_number: `LT-${booking.id}`,\n        title: `${booking.pet_name} - ${booking.consultation_type}`,\n        description: booking.consultation_reason || 'LuniTriage assessment required',\n        severity: booking.triage_priority || 'pending', // Use triage priority if available\n        status: booking.status === 'pending' ? 'pending_assessment' : booking.status,\n        pet_name: booking.pet_name,\n        customer_name: booking.customer_name,\n        customer_email: booking.customer_email,\n        service_type: booking.consultation_type,\n        created_at: booking.created_at,\n        updated_at: booking.updated_at,\n        source: 'triage_booking',\n        customer: {\n          full_name: booking.customer_name,\n          email: booking.customer_email\n        },\n        booking_data: {\n          appointment_date: booking.appointment_date,\n          appointment_time: booking.appointment_time,\n          booking_id: booking.id\n        }\n      }));\n    } catch (error) {\n      console.error('Error loading triage bookings:', error);\n      return [];\n    }\n  };\n\n  const loadConsultationBookings = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('consultation_bookings')\n        .select(`\n          *,\n          marketplace_listings (name, service_types)\n        `)\n        .not('consultation_type', 'in', ['LuniTriage SOAP Review', 'LuniTriage Consultation'])\n        .in('status', ['pending', 'confirmed', 'in_progress']);\n\n      if (error) throw error;\n\n      return (data || []).map(booking => ({\n        id: `consultation_${booking.id}`,\n        case_number: `CS-${booking.id}`,\n        title: `${booking.pet_name} - ${booking.consultation_type || 'Consultation'}`,\n        description: booking.consultation_reason || 'Consultation scheduled',\n        severity: 'moderate', // Default severity for regular consultations\n        status: booking.status,\n        pet_name: booking.pet_name,\n        customer_name: booking.customer_name,\n        customer_email: booking.customer_email,\n        service_type: booking.consultation_type || 'Consultation',\n        created_at: booking.created_at,\n        updated_at: booking.updated_at,\n        source: 'consultation_booking',\n        customer: {\n          full_name: booking.customer_name,\n          email: booking.customer_email\n        },\n        booking_data: {\n          appointment_date: booking.appointment_date,\n          appointment_time: booking.appointment_time,\n          booking_id: booking.id\n        }\n      }));\n    } catch (error) {\n      console.error('Error loading consultation bookings:', error);\n      return [];\n    }\n  };\n\n  const getSeverityBadge = (severity) => {\n    const config = SEVERITY_LEVELS[severity] || SEVERITY_LEVELS.pending;\n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${config.color}`}>\n        <span className=\"mr-1\">{config.icon}</span>\n        {config.label}\n      </span>\n    );\n  };\n\n  const getServiceTypeBadge = (serviceType) => {\n    const config = SERVICE_TYPES[serviceType] || { icon: '📄', label: serviceType, color: 'bg-gray-100 text-gray-800' };\n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${config.color}`}>\n        <span className=\"mr-1\">{config.icon}</span>\n        {config.label}\n      </span>\n    );\n  };\n\n  const getFilteredCases = () => {\n    let filtered = allCases;\n\n    // Apply severity filter\n    if (activeFilter !== 'all' && activeFilter !== 'assigned') {\n      filtered = filtered.filter(c => c.severity === activeFilter);\n    } else if (activeFilter === 'assigned') {\n      filtered = filtered.filter(c => c.assigned_nurse_id === nurseId);\n    }\n\n    // Apply search filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(c => \n        c.title?.toLowerCase().includes(searchLower) ||\n        c.description?.toLowerCase().includes(searchLower) ||\n        c.case_number?.toLowerCase().includes(searchLower) ||\n        c.pet_name?.toLowerCase().includes(searchLower) ||\n        c.customer_name?.toLowerCase().includes(searchLower)\n      );\n    }\n\n    // Apply sorting\n    if (sortBy === 'severity') {\n      filtered.sort((a, b) => {\n        const severityA = SEVERITY_LEVELS[a.severity]?.priority || 0;\n        const severityB = SEVERITY_LEVELS[b.severity]?.priority || 0;\n        return severityB - severityA;\n      });\n    } else if (sortBy === 'created_at') {\n      filtered.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));\n    }\n\n    return filtered;\n  };\n\n  const handleCaseClick = (caseItem) => {\n    setSelectedCase(caseItem);\n    if (caseItem.source === 'triage_booking') {\n      // For triage cases, could open LuniTriage interface or SOAP editor\n      console.log('Opening triage case for assessment:', caseItem);\n    }\n    setShowSOAPEditor(true);\n  };\n\n  const handleUpdateSeverity = async (caseId, newSeverity) => {\n    try {\n      // Update severity based on case source\n      const caseItem = allCases.find(c => c.id === caseId);\n      if (!caseItem) return;\n\n      if (caseItem.source === 'triage_booking') {\n        const bookingId = caseItem.booking_data.booking_id;\n        const { error } = await supabase\n          .from('consultation_bookings')\n          .update({ \n            triage_priority: newSeverity,\n            status: 'assessed',\n            updated_at: new Date().toISOString()\n          })\n          .eq('id', bookingId);\n        \n        if (error) throw error;\n      } else if (caseItem.source === 'cases') {\n        const { error } = await supabase\n          .from('cases')\n          .update({ \n            priority: newSeverity,\n            updated_at: new Date().toISOString()\n          })\n          .eq('id', caseId);\n        \n        if (error) throw error;\n      }\n\n      // Update local state\n      setAllCases(prev => prev.map(c => \n        c.id === caseId ? { ...c, severity: newSeverity } : c\n      ));\n\n    } catch (error) {\n      console.error('Error updating severity:', error);\n    }\n  };\n\n  const getTimeAgo = (dateString) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffInMinutes = Math.floor((now - date) / (1000 * 60));\n    \n    if (diffInMinutes < 60) {\n      return `${diffInMinutes}m ago`;\n    } else if (diffInMinutes < 1440) {\n      return `${Math.floor(diffInMinutes / 60)}h ago`;\n    } else {\n      return `${Math.floor(diffInMinutes / 1440)}d ago`;\n    }\n  };\n\n  const filteredCases = getFilteredCases();\n\n  // If database migration is needed, show setup message\n  if (dbError === 'migration_needed') {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center\">\n          <div className=\"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <span className=\"text-2xl\">⚙️</span>\n          </div>\n          <h3 className=\"text-lg font-medium text-yellow-800 mb-2\">Database Setup Required</h3>\n          <p className=\"text-yellow-700 mb-4\">\n            The case management system needs to be set up in your database. Please run the case management migration to enable this feature.\n          </p>\n          <div className=\"bg-yellow-100 border border-yellow-300 rounded p-3 text-left\">\n            <p className=\"text-sm font-medium text-yellow-800 mb-2\">Migration File:</p>\n            <code className=\"text-xs text-yellow-700 bg-yellow-200 px-2 py-1 rounded\">\n              database/migrations/011_case_management_system.sql\n            </code>\n          </div>\n          <button \n            onClick={loadAllCases}\n            className=\"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-yellow-700 bg-yellow-100 hover:bg-yellow-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500\"\n          >\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n            </svg>\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // If general database error, show error message\n\n\n  if (dbError === 'general_error') {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-6 text-center\">\n          <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <span className=\"text-2xl\">❌</span>\n          </div>\n          <h3 className=\"text-lg font-medium text-red-800 mb-2\">Database Error</h3>\n          <p className=\"text-red-700 mb-4\">\n            There was an error connecting to the case management system. Please try again or contact support.\n          </p>\n          <button \n            onClick={loadAllCases}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n          >\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n            </svg>\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (showSOAPEditor && selectedCase) {\n    return (\n      <SOAPNoteEditor\n        caseId={selectedCase.id}\n        existingNote={selectedCase.soap_notes?.[0]}\n        onSave={() => {\n          setShowSOAPEditor(false);\n          setSelectedCase(null);\n          loadAllCases();\n        }}\n        onCancel={() => {\n          setShowSOAPEditor(false);\n          setSelectedCase(null);\n        }}\n      />\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"bg-white p-6 rounded-lg shadow-sm border\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <div>\n            <h1 className=\"text-xl font-bold text-gray-900\">Cases</h1>\n            <p className=\"text-sm text-gray-700\">All cases with LuniTriage severity assessment</p>\n          </div>\n          <div className=\"flex items-center space-x-3\">\n            <span className=\"text-sm text-gray-500\">\n              {filteredCases.length} case{filteredCases.length !== 1 ? 's' : ''}\n            </span>\n            <button className=\"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\">\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n              </svg>\n              New Case\n            </button>\n          </div>\n        </div>\n\n\n\n        {/* Filters Row */}\n        <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4 mt-4 w-full\">\n            {/* Search - Takes up more space */}\n            <div className=\"md:col-span-3\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Search\n              </label>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Search cases...\"\n              />\n            </div>\n\n            {/* Filter by Severity */}\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Filter by Severity\n              </label>\n              <select\n                value={activeFilter}\n                onChange={(e) => setActiveFilter(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              >\n                {filterOptions.map((option) => (\n                  <option key={option.id} value={option.id}>\n                    {option.name} ({option.count})\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Sort */}\n            <div className=\"md:col-span-1\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Sort By\n              </label>\n              <select\n                value={sortBy}\n                onChange={(e) => setSortBy(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              >\n                <option value=\"severity\">Severity (Most Urgent)</option>\n                <option value=\"created_at\">Newest First</option>\n                <option value=\"case_number\">Case Number</option>\n              </select>\n            </div>\n          </div>\n      </div>\n\n      {/* Cases List */}\n      {loading ? (\n        <div className=\"text-center py-12\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"text-gray-600 mt-4\">Loading cases...</p>\n        </div>\n      ) : filteredCases.length === 0 ? (\n        <div className=\"text-center py-12 bg-white rounded-lg shadow-sm border p-6\">\n          <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <span className=\"text-2xl\">📋</span>\n          </div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No cases found</h3>\n          <p className=\"text-gray-600\">\n            {searchTerm || activeFilter !== 'all' || activeFilter !== 'assigned'\n              ? 'Try adjusting your filters to see more cases.'\n              : 'New cases will appear here when customers book consultations.'}\n          </p>\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          {filteredCases.map((caseItem) => (\n            <div \n              key={caseItem.id} \n              className={`bg-white rounded-lg shadow border-2 hover:shadow-lg transition-all cursor-pointer ${\n                caseItem.severity === 'emergency' ? 'border-red-300 bg-red-50' :\n                caseItem.severity === 'serious' ? 'border-orange-300 bg-orange-50' :\n                caseItem.severity === 'moderate' ? 'border-yellow-300 bg-yellow-50' :\n                caseItem.severity === 'mild' ? 'border-green-300 bg-green-50' :\n                'border-blue-300 bg-blue-50'\n              }`}\n              onClick={() => handleCaseClick(caseItem)}\n            >\n              <div className=\"p-6\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-3 mb-3\">\n                      <h3 className=\"text-lg font-medium text-gray-900\">\n                        {caseItem.title}\n                      </h3>\n                      <span className=\"text-sm font-mono text-gray-500\">\n                        #{caseItem.case_number}\n                      </span>\n                    </div>\n\n                    {/* Severity and Service Type Badges */}\n                    <div className=\"flex items-center space-x-2 mb-3\">\n                      {getSeverityBadge(caseItem.severity)}\n                      {getServiceTypeBadge(caseItem.service_type)}\n                    </div>\n                    \n                    <p className=\"text-gray-700 mb-4 line-clamp-2\">\n                      {caseItem.description}\n                    </p>\n                    \n                    <div className=\"flex items-center space-x-6 text-sm text-gray-600\">\n                      <div className=\"flex items-center\">\n                        <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                        </svg>\n                        {caseItem.customer?.full_name || caseItem.customer_name || 'Unknown Customer'}\n                      </div>\n                      \n                      {/* Pet name */}\n                      {caseItem.pet_name && (\n                        <div className=\"flex items-center\">\n                          <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\n                          </svg>\n                          Pet: {caseItem.pet_name}\n                        </div>\n                      )}\n                      <div className=\"flex items-center\">\n                        <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        {getTimeAgo(caseItem.created_at)}\n                      </div>\n                      {caseItem.due_date && (\n                        <div className=\"flex items-center\">\n                          <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                          </svg>\n                          Due: {new Date(caseItem.due_date).toLocaleDateString()}\n                        </div>\n                      )}\n                      {caseItem.soap_notes?.length > 0 && (\n                        <div className=\"flex items-center text-green-600\">\n                          <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                          </svg>\n                          SOAP Note Available\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  {/* Right side - Actions and Status */}\n                  <div className=\"flex flex-col items-end space-y-3 ml-6\">\n                    {/* Time stamp */}\n                    <div className=\"text-xs text-gray-500\">\n                      {getTimeAgo(caseItem.created_at)}\n                    </div>\n\n                    {/* Primary action button */}\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        handleCaseClick(caseItem);\n                      }}\n                      className={`inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors ${\n                        caseItem.severity === 'emergency' ? 'bg-red-600 hover:bg-red-700' :\n                        caseItem.severity === 'serious' ? 'bg-orange-600 hover:bg-orange-700' :\n                        caseItem.severity === 'moderate' ? 'bg-yellow-600 hover:bg-yellow-700' :\n                        caseItem.severity === 'mild' ? 'bg-green-600 hover:bg-green-700' :\n                        'bg-blue-600 hover:bg-blue-700'\n                      }`}\n                    >\n                      <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                      {caseItem.severity === 'pending' ? 'Start Triage' : \n                       caseItem.source === 'triage_booking' ? 'Review' : \n                       'View Details'}\n                    </button>\n\n                    {/* Quick severity update for pending cases */}\n                    {caseItem.severity === 'pending' && (\n                      <select\n                        onChange={(e) => {\n                          e.stopPropagation();\n                          if (e.target.value) {\n                            handleUpdateSeverity(caseItem.id, e.target.value);\n                          }\n                        }}\n                        className=\"text-xs px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 focus:ring-2 focus:ring-blue-500\"\n                        defaultValue=\"\"\n                        onClick={(e) => e.stopPropagation()}\n                      >\n                        <option value=\"\">Quick Assess</option>\n                        <option value=\"mild\">✅ Mild</option>\n                        <option value=\"moderate\">📋 Moderate</option>\n                        <option value=\"serious\">⚠️ Serious</option>\n                        <option value=\"emergency\">🚨 Emergency</option>\n                      </select>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CaseManager;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}