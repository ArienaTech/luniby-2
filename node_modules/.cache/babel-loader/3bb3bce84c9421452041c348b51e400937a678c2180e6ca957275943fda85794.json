{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{Link}from'react-router-dom';import caseHistoryService from'../services/caseHistoryService';import{PetIcon,HealthIcon,UIIcon}from'./MinimalIcons';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CaseHistoryViewer=_ref=>{let{pets,userId}=_ref;const[soapNotes,setSoapNotes]=useState([]);const[loading,setLoading]=useState(true);const[selectedPet,setSelectedPet]=useState('all');const[searchQuery,setSearchQuery]=useState('');const[severityFilter,setSeverityFilter]=useState('all');const[dateFilter,setDateFilter]=useState('all');const[currentPage,setCurrentPage]=useState(1);const[itemsPerPage]=useState(15);const[selectedSoapNote,setSelectedSoapNote]=useState(null);const[showSoapModal,setShowSoapModal]=useState(false);const[sortBy,setSortBy]=useState('date_desc');const[openDropdown,setOpenDropdown]=useState(null);// Close dropdown when clicking outside\nuseEffect(()=>{const handleClickOutside=event=>{if(openDropdown&&!event.target.closest('.custom-dropdown')){setOpenDropdown(null);}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[openDropdown]);const CustomDropdown=_ref2=>{var _options$find;let{value,onChange,options,placeholder,dropdownKey}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"custom-dropdown relative\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>setOpenDropdown(openDropdown===dropdownKey?null:dropdownKey),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"truncate\",children:((_options$find=options.find(opt=>opt.value===value))===null||_options$find===void 0?void 0:_options$find.label)||placeholder}),/*#__PURE__*/_jsx(\"svg\",{className:`w-4 h-4 text-gray-400 transition-transform ${openDropdown===dropdownKey?'rotate-180':''}`,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19 9l-7 7-7-7\"})})]}),openDropdown===dropdownKey&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto\",children:options.map(option=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{onChange(option.value);setOpenDropdown(null);},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${value===option.value?'bg-[#E5F4F1] text-[#5EB47C]':'text-gray-700'}`,children:option.label},option.value))})]});};useEffect(()=>{if(userId){loadSoapNotes();}},[userId]);const loadSoapNotes=async()=>{setLoading(true);try{const soapResult=await caseHistoryService.getUserSoapNotes(userId);if(soapResult.success){setSoapNotes(soapResult.data);}}catch(error){console.error('Error loading SOAP notes:',error);}finally{setLoading(false);}};const getSeverityConfig=severity=>{const configs={low:{color:'from-green-50 to-green-100 border-green-200',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"check\",className:\"w-4 h-4\",color:\"#10B981\"}),badge:'bg-green-100 text-green-800'},moderate:{color:'from-blue-50 to-blue-100 border-blue-200',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"warning\",className:\"w-4 h-4\",color:\"#3B82F6\"}),badge:'bg-blue-100 text-blue-800'},high:{color:'from-orange-50 to-orange-100 border-orange-200',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"warning\",className:\"w-4 h-4\",color:\"#F59E0B\"}),badge:'bg-orange-100 text-orange-800'},urgent:{color:'from-red-50 to-red-100 border-red-200',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"emergency\",className:\"w-4 h-4\",color:\"#EF4444\"}),badge:'bg-red-100 text-red-800'}};return configs[severity]||configs.moderate;};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});};const formatDateTime=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};const getDateFilterOptions=()=>{const now=new Date();return{all:()=>true,today:date=>new Date(date).toDateString()===now.toDateString(),week:date=>{const weekAgo=new Date(now.getTime()-7*24*60*60*1000);return new Date(date)>=weekAgo;},month:date=>{const monthAgo=new Date(now.getTime()-30*24*60*60*1000);return new Date(date)>=monthAgo;},year:date=>{const yearAgo=new Date(now.getTime()-365*24*60*60*1000);return new Date(date)>=yearAgo;}};};const filteredAndSortedData=useMemo(()=>{let filtered=soapNotes.map(item=>({...item,searchText:`${item.title} ${item.subjective} ${item.objective} ${item.assessment} ${item.plan}`}));// Pet filter\nif(selectedPet!=='all'){filtered=filtered.filter(item=>item.pet_id===selectedPet);}// Search filter\nif(searchQuery.trim()){const query=searchQuery.toLowerCase();filtered=filtered.filter(item=>{var _item$searchText,_item$vet_name,_item$clinic_name;return((_item$searchText=item.searchText)===null||_item$searchText===void 0?void 0:_item$searchText.toLowerCase().includes(query))||((_item$vet_name=item.vet_name)===null||_item$vet_name===void 0?void 0:_item$vet_name.toLowerCase().includes(query))||((_item$clinic_name=item.clinic_name)===null||_item$clinic_name===void 0?void 0:_item$clinic_name.toLowerCase().includes(query));});}// Severity filter\nif(severityFilter!=='all'){filtered=filtered.filter(item=>item.severity===severityFilter);}// Date filter\nconst dateFilterFn=getDateFilterOptions()[dateFilter];if(dateFilterFn){filtered=filtered.filter(item=>dateFilterFn(item.created_at));}// Sort\nfiltered.sort((a,b)=>{var _pets$find,_pets$find2;switch(sortBy){case'date_desc':return new Date(b.created_at)-new Date(a.created_at);case'date_asc':return new Date(a.created_at)-new Date(b.created_at);case'severity':const severityOrder={urgent:4,high:3,moderate:2,low:1};return(severityOrder[b.severity]||2)-(severityOrder[a.severity]||2);case'pet':const petA=((_pets$find=pets.find(p=>p.id===a.pet_id))===null||_pets$find===void 0?void 0:_pets$find.name)||'';const petB=((_pets$find2=pets.find(p=>p.id===b.pet_id))===null||_pets$find2===void 0?void 0:_pets$find2.name)||'';return petA.localeCompare(petB);default:return new Date(b.created_at)-new Date(a.created_at);}});return filtered;},[soapNotes,selectedPet,searchQuery,severityFilter,dateFilter,sortBy,pets]);const paginatedData=useMemo(()=>{const startIndex=(currentPage-1)*itemsPerPage;return filteredAndSortedData.slice(startIndex,startIndex+itemsPerPage);},[filteredAndSortedData,currentPage,itemsPerPage]);const totalPages=Math.ceil(filteredAndSortedData.length/itemsPerPage);const openSoapModal=soapNote=>{setSelectedSoapNote(soapNote);setShowSoapModal(true);};const closeSoapModal=()=>{setSelectedSoapNote(null);setShowSoapModal(false);};// const getSOAPPreview = (note) => {\n//   // Get first available section as preview\n//   const sections = ['subjective', 'objective', 'assessment', 'plan'];\n//   for (const section of sections) {\n//     if (note[section]) {\n//       const text = note[section];\n//       return text.length > 120 ? text.substring(0, 120) + '...' : text;\n//     }\n//   }\n//   return 'No content available';\n// };\nconst renderSOAPModal=()=>{if(!selectedSoapNote||!showSoapModal)return null;const note=selectedSoapNote;const pet=pets.find(p=>p.id===note.pet_id);const severityConfig=getSeverityConfig(note.severity);const sections=[{key:'subjective',title:'SUBJECTIVE',icon:/*#__PURE__*/_jsx(UIIcon,{type:\"write\",className:\"w-4 h-4\",color:\"currentColor\"}),color:'blue'},{key:'objective',title:'OBJECTIVE',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"search\",className:\"w-4 h-4\",color:\"currentColor\"}),color:'green'},{key:'assessment',title:'ASSESSMENT',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"target\",className:\"w-4 h-4\",color:\"currentColor\"}),color:'orange'},{key:'plan',title:'PLAN',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"records\",className:\"w-4 h-4\",color:\"currentColor\"}),color:'purple'}];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:`px-6 py-4 bg-gradient-to-r ${severityConfig.color} border-b border-gray-200`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"health\",className:\"w-6 h-6\",color:\"#6B7280\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:note.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mt-1\",children:[pet&&/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/80 text-gray-700\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-1\",children:/*#__PURE__*/_jsx(PetIcon,{species:pet.species,className:\"w-3 h-3\",color:\"currentColor\"})}),pet.name]}),/*#__PURE__*/_jsx(\"span\",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${severityConfig.badge}`,children:\"SOAP NOTE\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:closeSoapModal,className:\"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-colors\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6 text-gray-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M6 18L18 6M6 6l12 12\"})})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"calendar\",className:\"w-5 h-5 mr-3 flex-shrink-0\",color:\"#6B7280\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Date\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-gray-900\",children:formatDateTime(note.created_at)})]})]}),note.vet_name&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"doctor\",className:\"w-5 h-5 mr-3 flex-shrink-0\",color:\"#6B7280\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Veterinarian\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-gray-900\",children:note.vet_name})]})]}),note.clinic_name&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"health\",className:\"w-5 h-5 mr-3 flex-shrink-0\",color:\"#6B7280\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 font-medium\",children:\"Clinic\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-gray-900\",children:note.clinic_name})]})]}),note.cost&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-green-50 rounded-lg\",children:[/*#__PURE__*/_jsx(UIIcon,{type:\"money\",className:\"w-5 h-5 mr-3 flex-shrink-0\",color:\"#10B981\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-600 font-medium\",children:\"Total Cost\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-green-700\",children:[\"$\",note.cost]})]})]}),note.source&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center p-3 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-3 flex-shrink-0\",children:note.source==='luni_triage'?/*#__PURE__*/_jsx(HealthIcon,{type:\"vaccination\",className:\"w-5 h-5\",color:\"#3B82F6\"}):/*#__PURE__*/_jsx(UIIcon,{type:\"write\",className:\"w-5 h-5\",color:\"#3B82F6\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-blue-600 font-medium\",children:\"Source\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold text-blue-700\",children:note.source==='luni_triage'?'Luni Triage':'Manual Entry'})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:sections.map(section=>{if(!note[section.key])return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-xl p-6 border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mr-3\",children:section.icon}),/*#__PURE__*/_jsx(\"h3\",{className:`text-lg font-bold text-${section.color}-800 uppercase tracking-wide`,children:section.title})]}),/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none text-gray-700 leading-relaxed whitespace-pre-wrap\",children:note[section.key]})]},section.key);})}),note.follow_up_date&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 p-4 bg-orange-50 border-l-4 border-orange-400 rounded-r-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-500 text-lg\",children:\"\\u23F0\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-orange-800\",children:\"Follow-up Scheduled:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-700 font-semibold\",children:formatDateTime(note.follow_up_date)})]})})]})]})});};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-16\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-2 border-[#5EB47C] border-t-transparent mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 font-medium\",children:\"Loading SOAP notes...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Gathering your pet's medical records\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 sm:p-4 bg-green-50 rounded-xl border border-green-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"health\",className:\"w-6 h-6\",color:\"#10B981\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl sm:text-2xl font-bold text-green-600 mb-1\",children:soapNotes.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-700 font-medium\",children:\"Total SOAP Notes\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 sm:p-4 bg-blue-50 rounded-xl border border-blue-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"vaccination\",className:\"w-6 h-6\",color:\"#3B82F6\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl sm:text-2xl font-bold text-blue-600 mb-1\",children:soapNotes.filter(note=>note.source==='luni_triage').length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-blue-700 font-medium\",children:\"Luni Triage\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 sm:p-4 bg-red-50 rounded-xl border border-red-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\",children:/*#__PURE__*/_jsx(HealthIcon,{type:\"emergency\",className:\"w-6 h-6\",color:\"#EF4444\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl sm:text-2xl font-bold text-red-600 mb-1\",children:soapNotes.filter(note=>note.severity==='urgent'||note.severity==='high').length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-red-700 font-medium\",children:\"Urgent Cases\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-3 sm:p-4 bg-purple-50 rounded-xl border border-purple-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\",children:/*#__PURE__*/_jsx(PetIcon,{species:\"pet\",className:\"w-6 h-6\",color:\"#8B5CF6\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xl sm:text-2xl font-bold text-purple-600 mb-1\",children:pets.length}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-purple-700 font-medium\",children:\"Pets Tracked\"})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold text-gray-900\",children:\"SOAP Records\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mb-4\",children:\"Medical records from Luni Triage assessments\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"-mx-6 border-t border-gray-200 mb-6\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 overflow-x-auto pb-2 mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedPet('all');setCurrentPage(1);},className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${selectedPet==='all'?'bg-[#5EB47C] text-white shadow-sm':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:\"All Pets\"}),pets.map(pet=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedPet(pet.id);setCurrentPage(1);},className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${selectedPet===pet.id?'bg-[#5EB47C] text-white shadow-sm':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,children:pet.name},pet.id))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 w-full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search SOAP notes, symptoms, treatments...\",value:searchQuery,onChange:e=>{setSearchQuery(e.target.value);setCurrentPage(1);},className:\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-3\",children:[/*#__PURE__*/_jsx(CustomDropdown,{value:severityFilter,onChange:value=>{setSeverityFilter(value);setCurrentPage(1);},options:[{value:'all',label:'All Severities'},{value:'urgent',label:'Urgent',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"emergency\",className:\"w-4 h-4\",color:\"currentColor\"})},{value:'high',label:'High',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"warning\",className:\"w-4 h-4\",color:\"currentColor\"})},{value:'moderate',label:'Moderate',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"warning\",className:\"w-4 h-4\",color:\"currentColor\"})},{value:'low',label:'Low',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"check\",className:\"w-4 h-4\",color:\"currentColor\"})}],placeholder:\"All Severities\",dropdownKey:\"severity\"}),/*#__PURE__*/_jsx(CustomDropdown,{value:dateFilter,onChange:value=>{setDateFilter(value);setCurrentPage(1);},options:[{value:'all',label:'All Time'},{value:'today',label:'Today'},{value:'week',label:'Past Week'},{value:'month',label:'Past Month'},{value:'year',label:'Past Year'}],placeholder:\"All Time\",dropdownKey:\"date\"}),/*#__PURE__*/_jsx(CustomDropdown,{value:sortBy,onChange:setSortBy,options:[{value:'date_desc',label:'Newest First'},{value:'date_asc',label:'Oldest First'},{value:'severity',label:'By Severity',icon:/*#__PURE__*/_jsx(HealthIcon,{type:\"emergency\",className:\"w-4 h-4\",color:\"currentColor\"})},{value:'pet',label:'By Pet',icon:/*#__PURE__*/_jsx(PetIcon,{species:\"pet\",className:\"w-4 h-4\",color:\"currentColor\"})}],placeholder:\"Newest First\",dropdownKey:\"sort\"})]})]}),filteredAndSortedData.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex items-center justify-between text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"div\",{children:searchQuery&&`Found ${filteredAndSortedData.length} SOAP note${filteredAndSortedData.length!==1?'s':''} matching \"${searchQuery}\"`}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Page \",currentPage,\" of \",totalPages]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:filteredAndSortedData.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-16\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900 mb-2\",children:searchQuery?'No matching SOAP notes found':'No notes yet'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-8 max-w-md mx-auto\",children:searchQuery?'Try adjusting your search terms or filters to find what you\\'re looking for.':'Start using Luni Triage to conduct pet health assessments and generate SOAP notes.'}),!searchQuery&&/*#__PURE__*/_jsx(Link,{to:\"/luni-triage\",className:\"inline-flex items-center px-6 py-3 bg-[#5EB47C] text-white rounded-xl hover:bg-[#4A9A64] transition-all duration-200 shadow-lg hover:shadow-xl font-medium\",children:\"Start Triage Assessment\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:paginatedData.map(note=>{const severityConfig=getSeverityConfig(note.severity);const pet=pets.find(p=>p.id===note.pet_id);return/*#__PURE__*/_jsx(\"div\",{onClick:()=>openSoapModal(note),className:\"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer hover:-translate-y-0.5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3 flex-1 min-w-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-900 truncate\",children:note.title}),/*#__PURE__*/_jsx(\"span\",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${severityConfig.badge}`,children:note.severity.toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 text-xs text-gray-600\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"calendar\",className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),formatDate(note.created_at)]}),pet&&/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(PetIcon,{species:pet.species,className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),pet.name]}),note.source==='luni_triage'&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600 flex items-center\",children:[/*#__PURE__*/_jsx(HealthIcon,{type:\"vaccination\",className:\"w-3 h-3 mr-1\",color:\"currentColor\"}),\"Luni Triage\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3 flex-shrink-0\",children:note.cost&&/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-semibold text-green-700\",children:[\"$\",note.cost]})})})]})},note.id);})}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"Showing \",(currentPage-1)*itemsPerPage+1,\" to \",Math.min(currentPage*itemsPerPage,filteredAndSortedData.length),\" of \",filteredAndSortedData.length,\" SOAP notes\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(Math.max(1,currentPage-1)),disabled:currentPage===1,className:\"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Previous\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-1\",children:Array.from({length:Math.min(5,totalPages)},(_,i)=>{let pageNum;if(totalPages<=5){pageNum=i+1;}else if(currentPage<=3){pageNum=i+1;}else if(currentPage>=totalPages-2){pageNum=totalPages-4+i;}else{pageNum=currentPage-2+i;}return/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(pageNum),className:`px-3 py-2 rounded-lg text-sm font-medium ${currentPage===pageNum?'bg-[#5EB47C] text-white':'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50'}`,children:pageNum},pageNum);})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(Math.min(totalPages,currentPage+1)),disabled:currentPage===totalPages,className:\"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Next\"})]})]})]})})]})]}),renderSOAPModal()]});};export default CaseHistoryViewer;","map":{"version":3,"names":["React","useState","useEffect","useMemo","Link","caseHistoryService","PetIcon","HealthIcon","UIIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CaseHistoryViewer","_ref","pets","userId","soapNotes","setSoapNotes","loading","setLoading","selectedPet","setSelectedPet","searchQuery","setSearchQuery","severityFilter","setSeverityFilter","dateFilter","setDateFilter","currentPage","setCurrentPage","itemsPerPage","selectedSoapNote","setSelectedSoapNote","showSoapModal","setShowSoapModal","sortBy","setSortBy","openDropdown","setOpenDropdown","handleClickOutside","event","target","closest","document","addEventListener","removeEventListener","CustomDropdown","_ref2","_options$find","value","onChange","options","placeholder","dropdownKey","className","children","type","onClick","find","opt","label","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","map","option","loadSoapNotes","soapResult","getUserSoapNotes","success","data","error","console","getSeverityConfig","severity","configs","low","color","icon","badge","moderate","high","urgent","formatDate","dateString","Date","toLocaleDateString","year","month","day","formatDateTime","hour","minute","getDateFilterOptions","now","all","today","date","toDateString","week","weekAgo","getTime","monthAgo","yearAgo","filteredAndSortedData","filtered","item","searchText","title","subjective","objective","assessment","plan","filter","pet_id","trim","query","toLowerCase","_item$searchText","_item$vet_name","_item$clinic_name","includes","vet_name","clinic_name","dateFilterFn","created_at","sort","a","b","_pets$find","_pets$find2","severityOrder","petA","p","id","name","petB","localeCompare","paginatedData","startIndex","slice","totalPages","Math","ceil","length","openSoapModal","soapNote","closeSoapModal","renderSOAPModal","note","pet","severityConfig","sections","key","species","cost","source","section","follow_up_date","e","to","toUpperCase","min","max","disabled","Array","from","_","i","pageNum"],"sources":["/workspace/src/components/CaseHistoryViewer.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport caseHistoryService from '../services/caseHistoryService';\nimport { PetIcon, HealthIcon, UIIcon } from './MinimalIcons';\n\nconst CaseHistoryViewer = ({ pets, userId }) => {\n  const [soapNotes, setSoapNotes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedPet, setSelectedPet] = useState('all');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [severityFilter, setSeverityFilter] = useState('all');\n  const [dateFilter, setDateFilter] = useState('all');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage] = useState(15);\n  const [selectedSoapNote, setSelectedSoapNote] = useState(null);\n  const [showSoapModal, setShowSoapModal] = useState(false);\n  const [sortBy, setSortBy] = useState('date_desc');\n  const [openDropdown, setOpenDropdown] = useState(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (openDropdown && !event.target.closest('.custom-dropdown')) {\n        setOpenDropdown(null);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [openDropdown]);\n\n  const CustomDropdown = ({ value, onChange, options, placeholder, dropdownKey }) => (\n    <div className=\"custom-dropdown relative\">\n      <button\n        type=\"button\"\n        onClick={() => setOpenDropdown(openDropdown === dropdownKey ? null : dropdownKey)}\n        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50\"\n      >\n        <span className=\"truncate\">\n          {options.find(opt => opt.value === value)?.label || placeholder}\n        </span>\n        <svg \n          className={`w-4 h-4 text-gray-400 transition-transform ${openDropdown === dropdownKey ? 'rotate-180' : ''}`} \n          fill=\"none\" \n          stroke=\"currentColor\" \n          viewBox=\"0 0 24 24\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </button>\n      {openDropdown === dropdownKey && (\n        <div className=\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto\">\n          {options.map((option) => (\n            <button\n              key={option.value}\n              type=\"button\"\n              onClick={() => {\n                onChange(option.value);\n                setOpenDropdown(null);\n              }}\n              className={`w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${\n                value === option.value ? 'bg-[#E5F4F1] text-[#5EB47C]' : 'text-gray-700'\n              }`}\n            >\n              {option.label}\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n\n  useEffect(() => {\n    if (userId) {\n      loadSoapNotes();\n    }\n  }, [userId]);\n\n  const loadSoapNotes = async () => {\n    setLoading(true);\n    try {\n      const soapResult = await caseHistoryService.getUserSoapNotes(userId);\n      if (soapResult.success) {\n        setSoapNotes(soapResult.data);\n      }\n    } catch (error) {\n      console.error('Error loading SOAP notes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getSeverityConfig = (severity) => {\n    const configs = {\n      low: { color: 'from-green-50 to-green-100 border-green-200', icon: <HealthIcon type=\"check\" className=\"w-4 h-4\" color=\"#10B981\" />, badge: 'bg-green-100 text-green-800' },\n      moderate: { color: 'from-blue-50 to-blue-100 border-blue-200', icon: <HealthIcon type=\"warning\" className=\"w-4 h-4\" color=\"#3B82F6\" />, badge: 'bg-blue-100 text-blue-800' },\n      high: { color: 'from-orange-50 to-orange-100 border-orange-200', icon: <HealthIcon type=\"warning\" className=\"w-4 h-4\" color=\"#F59E0B\" />, badge: 'bg-orange-100 text-orange-800' },\n      urgent: { color: 'from-red-50 to-red-100 border-red-200', icon: <HealthIcon type=\"emergency\" className=\"w-4 h-4\" color=\"#EF4444\" />, badge: 'bg-red-100 text-red-800' }\n    };\n    return configs[severity] || configs.moderate;\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  const formatDateTime = (dateString) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getDateFilterOptions = () => {\n    const now = new Date();\n    return {\n      all: () => true,\n      today: (date) => new Date(date).toDateString() === now.toDateString(),\n      week: (date) => {\n        const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        return new Date(date) >= weekAgo;\n      },\n      month: (date) => {\n        const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n        return new Date(date) >= monthAgo;\n      },\n      year: (date) => {\n        const yearAgo = new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000);\n        return new Date(date) >= yearAgo;\n      }\n    };\n  };\n\n  const filteredAndSortedData = useMemo(() => {\n    let filtered = soapNotes.map(item => ({ \n      ...item, \n      searchText: `${item.title} ${item.subjective} ${item.objective} ${item.assessment} ${item.plan}` \n    }));\n\n    // Pet filter\n    if (selectedPet !== 'all') {\n      filtered = filtered.filter(item => item.pet_id === selectedPet);\n    }\n\n    // Search filter\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(item => \n        item.searchText?.toLowerCase().includes(query) ||\n        item.vet_name?.toLowerCase().includes(query) ||\n        item.clinic_name?.toLowerCase().includes(query)\n      );\n    }\n\n    // Severity filter\n    if (severityFilter !== 'all') {\n      filtered = filtered.filter(item => item.severity === severityFilter);\n    }\n\n    // Date filter\n    const dateFilterFn = getDateFilterOptions()[dateFilter];\n    if (dateFilterFn) {\n      filtered = filtered.filter(item => dateFilterFn(item.created_at));\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      switch (sortBy) {\n        case 'date_desc':\n          return new Date(b.created_at) - new Date(a.created_at);\n        case 'date_asc':\n          return new Date(a.created_at) - new Date(b.created_at);\n        case 'severity':\n          const severityOrder = { urgent: 4, high: 3, moderate: 2, low: 1 };\n          return (severityOrder[b.severity] || 2) - (severityOrder[a.severity] || 2);\n        case 'pet':\n          const petA = pets.find(p => p.id === a.pet_id)?.name || '';\n          const petB = pets.find(p => p.id === b.pet_id)?.name || '';\n          return petA.localeCompare(petB);\n        default:\n          return new Date(b.created_at) - new Date(a.created_at);\n      }\n    });\n\n    return filtered;\n  }, [soapNotes, selectedPet, searchQuery, severityFilter, dateFilter, sortBy, pets]);\n\n  const paginatedData = useMemo(() => {\n    const startIndex = (currentPage - 1) * itemsPerPage;\n    return filteredAndSortedData.slice(startIndex, startIndex + itemsPerPage);\n  }, [filteredAndSortedData, currentPage, itemsPerPage]);\n\n  const totalPages = Math.ceil(filteredAndSortedData.length / itemsPerPage);\n\n  const openSoapModal = (soapNote) => {\n    setSelectedSoapNote(soapNote);\n    setShowSoapModal(true);\n  };\n\n  const closeSoapModal = () => {\n    setSelectedSoapNote(null);\n    setShowSoapModal(false);\n  };\n\n  // const getSOAPPreview = (note) => {\n  //   // Get first available section as preview\n  //   const sections = ['subjective', 'objective', 'assessment', 'plan'];\n  //   for (const section of sections) {\n  //     if (note[section]) {\n  //       const text = note[section];\n  //       return text.length > 120 ? text.substring(0, 120) + '...' : text;\n  //     }\n  //   }\n  //   return 'No content available';\n  // };\n\n  const renderSOAPModal = () => {\n    if (!selectedSoapNote || !showSoapModal) return null;\n\n    const note = selectedSoapNote;\n    const pet = pets.find(p => p.id === note.pet_id);\n    const severityConfig = getSeverityConfig(note.severity);\n\n    const sections = [\n      { key: 'subjective', title: 'SUBJECTIVE', icon: <UIIcon type=\"write\" className=\"w-4 h-4\" color=\"currentColor\" />, color: 'blue' },\n      { key: 'objective', title: 'OBJECTIVE', icon: <HealthIcon type=\"search\" className=\"w-4 h-4\" color=\"currentColor\" />, color: 'green' },\n      { key: 'assessment', title: 'ASSESSMENT', icon: <HealthIcon type=\"target\" className=\"w-4 h-4\" color=\"currentColor\" />, color: 'orange' },\n      { key: 'plan', title: 'PLAN', icon: <HealthIcon type=\"records\" className=\"w-4 h-4\" color=\"currentColor\" />, color: 'purple' }\n    ];\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n        <div className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n          {/* Modal Header */}\n          <div className={`px-6 py-4 bg-gradient-to-r ${severityConfig.color} border-b border-gray-200`}>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <div className=\"w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm\">\n                  <HealthIcon type=\"health\" className=\"w-6 h-6\" color=\"#6B7280\" />\n                </div>\n                <div>\n                  <h2 className=\"text-xl font-bold text-gray-900\">{note.title}</h2>\n                  <div className=\"flex items-center space-x-3 mt-1\">\n                    {pet && (\n                      <span className=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/80 text-gray-700\">\n                        <span className=\"mr-1\">\n                          <PetIcon species={pet.species} className=\"w-3 h-3\" color=\"currentColor\" />\n                        </span>\n                        {pet.name}\n                      </span>\n                    )}\n                    <span className={`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${severityConfig.badge}`}>\n                      SOAP NOTE\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <button\n                onClick={closeSoapModal}\n                className=\"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-colors\"\n              >\n                <svg className=\"w-6 h-6 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          {/* Modal Content */}\n          <div className=\"p-6\">\n            {/* Meta Information */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6\">\n              <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n                <HealthIcon type=\"calendar\" className=\"w-5 h-5 mr-3 flex-shrink-0\" color=\"#6B7280\" />\n                <div>\n                  <div className=\"text-xs text-gray-500 font-medium\">Date</div>\n                  <div className=\"text-sm font-semibold text-gray-900\">{formatDateTime(note.created_at)}</div>\n                </div>\n              </div>\n              \n              {note.vet_name && (\n                <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n                  <HealthIcon type=\"doctor\" className=\"w-5 h-5 mr-3 flex-shrink-0\" color=\"#6B7280\" />\n                  <div>\n                    <div className=\"text-xs text-gray-500 font-medium\">Veterinarian</div>\n                    <div className=\"text-sm font-semibold text-gray-900\">{note.vet_name}</div>\n                  </div>\n                </div>\n              )}\n              \n              {note.clinic_name && (\n                <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n                  <HealthIcon type=\"health\" className=\"w-5 h-5 mr-3 flex-shrink-0\" color=\"#6B7280\" />\n                  <div>\n                    <div className=\"text-xs text-gray-500 font-medium\">Clinic</div>\n                    <div className=\"text-sm font-semibold text-gray-900\">{note.clinic_name}</div>\n                  </div>\n                </div>\n              )}\n\n              {note.cost && (\n                <div className=\"flex items-center p-3 bg-green-50 rounded-lg\">\n                  <UIIcon type=\"money\" className=\"w-5 h-5 mr-3 flex-shrink-0\" color=\"#10B981\" />\n                  <div>\n                    <div className=\"text-xs text-green-600 font-medium\">Total Cost</div>\n                    <div className=\"text-lg font-bold text-green-700\">${note.cost}</div>\n                  </div>\n                </div>\n              )}\n\n              {note.source && (\n                <div className=\"flex items-center p-3 bg-blue-50 rounded-lg\">\n                  <span className=\"mr-3 flex-shrink-0\">\n                    {note.source === 'luni_triage' ? \n                      <HealthIcon type=\"vaccination\" className=\"w-5 h-5\" color=\"#3B82F6\" /> : \n                      <UIIcon type=\"write\" className=\"w-5 h-5\" color=\"#3B82F6\" />\n                    }\n                  </span>\n                  <div>\n                    <div className=\"text-xs text-blue-600 font-medium\">Source</div>\n                    <div className=\"text-sm font-semibold text-blue-700\">\n                      {note.source === 'luni_triage' ? 'Luni Triage' : 'Manual Entry'}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {/* SOAP Sections */}\n            <div className=\"space-y-6\">\n              {sections.map(section => {\n                if (!note[section.key]) return null;\n                \n                return (\n                  <div key={section.key} className=\"bg-gray-50 rounded-xl p-6 border border-gray-200\">\n                    <div className=\"flex items-center mb-4\">\n                      <span className=\"text-2xl mr-3\">{section.icon}</span>\n                      <h3 className={`text-lg font-bold text-${section.color}-800 uppercase tracking-wide`}>\n                        {section.title}\n                      </h3>\n                    </div>\n                    <div className=\"prose prose-sm max-w-none text-gray-700 leading-relaxed whitespace-pre-wrap\">\n                      {note[section.key]}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Follow-up Information */}\n            {note.follow_up_date && (\n              <div className=\"mt-6 p-4 bg-orange-50 border-l-4 border-orange-400 rounded-r-lg\">\n                <div className=\"flex items-center space-x-2\">\n                  <span className=\"text-orange-500 text-lg\">⏰</span>\n                  <span className=\"font-medium text-orange-800\">Follow-up Scheduled:</span>\n                  <span className=\"text-orange-700 font-semibold\">{formatDateTime(note.follow_up_date)}</span>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-16\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-2 border-[#5EB47C] border-t-transparent mb-4\"></div>\n        <p className=\"text-gray-600 font-medium\">Loading SOAP notes...</p>\n        <p className=\"text-sm text-gray-500\">Gathering your pet's medical records</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Modern Stats */}\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\">        \n        {/* Stats Grid */}\n        <div className=\"p-6\">\n          <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4\">\n            <div className=\"text-center p-3 sm:p-4 bg-green-50 rounded-xl border border-green-100\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\">\n                <HealthIcon type=\"health\" className=\"w-6 h-6\" color=\"#10B981\" />\n              </div>\n              <div className=\"text-xl sm:text-2xl font-bold text-green-600 mb-1\">{soapNotes.length}</div>\n              <div className=\"text-xs text-green-700 font-medium\">Total SOAP Notes</div>\n            </div>\n            \n            <div className=\"text-center p-3 sm:p-4 bg-blue-50 rounded-xl border border-blue-100\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\">\n                <HealthIcon type=\"vaccination\" className=\"w-6 h-6\" color=\"#3B82F6\" />\n              </div>\n              <div className=\"text-xl sm:text-2xl font-bold text-blue-600 mb-1\">\n                {soapNotes.filter(note => note.source === 'luni_triage').length}\n              </div>\n              <div className=\"text-xs text-blue-700 font-medium\">Luni Triage</div>\n            </div>\n            \n            <div className=\"text-center p-3 sm:p-4 bg-red-50 rounded-xl border border-red-100\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\">\n                <HealthIcon type=\"emergency\" className=\"w-6 h-6\" color=\"#EF4444\" />\n              </div>\n              <div className=\"text-xl sm:text-2xl font-bold text-red-600 mb-1\">\n                {soapNotes.filter(note => note.severity === 'urgent' || note.severity === 'high').length}\n              </div>\n              <div className=\"text-xs text-red-700 font-medium\">Urgent Cases</div>\n            </div>\n            \n            <div className=\"text-center p-3 sm:p-4 bg-purple-50 rounded-xl border border-purple-100\">\n              <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\">\n                <PetIcon species=\"pet\" className=\"w-6 h-6\" color=\"#8B5CF6\" />\n              </div>\n              <div className=\"text-xl sm:text-2xl font-bold text-purple-600 mb-1\">{pets.length}</div>\n              <div className=\"text-xs text-purple-700 font-medium\">Pets Tracked</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* SOAP Records Container - Updated Layout */}\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-lg font-bold text-gray-900\">SOAP Records</h2>\n            <p className=\"text-gray-600 text-sm mb-4\">Medical records from Luni Triage assessments</p>\n          </div>\n        </div>\n        \n        {/* Full-width divider line */}\n        <div className=\"-mx-6 border-t border-gray-200 mb-6\"></div>\n        \n        {/* Pet Selection Pills */}\n        <div className=\"flex items-center space-x-1 overflow-x-auto pb-2 mb-6\">\n          <button\n            onClick={() => {\n              setSelectedPet('all');\n              setCurrentPage(1);\n            }}\n            className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${\n              selectedPet === 'all'\n                ? 'bg-[#5EB47C] text-white shadow-sm'\n                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n            }`}\n          >\n            All Pets\n          </button>\n          {pets.map(pet => (\n            <button\n              key={pet.id}\n              onClick={() => {\n                setSelectedPet(pet.id);\n                setCurrentPage(1);\n              }}\n              className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${\n                selectedPet === pet.id\n                  ? 'bg-[#5EB47C] text-white shadow-sm'\n                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n              }`}\n            >\n              {pet.name}\n            </button>\n          ))}\n        </div>\n\n        {/* Search & Filters */}\n        <div>\n          <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n            {/* Search Bar */}\n            <div className=\"flex-1 w-full\">\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Search SOAP notes, symptoms, treatments...\"\n                  value={searchQuery}\n                  onChange={(e) => {\n                    setSearchQuery(e.target.value);\n                    setCurrentPage(1);\n                  }}\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent\"\n                />\n              </div>\n            </div>\n\n            {/* Filter Controls */}\n            <div className=\"flex flex-wrap items-center gap-3\">\n\n              {/* Severity Filter */}\n              <CustomDropdown\n                value={severityFilter}\n                onChange={(value) => {\n                  setSeverityFilter(value);\n                  setCurrentPage(1);\n                }}\n                options={[\n                  { value: 'all', label: 'All Severities' },\n                  { value: 'urgent', label: 'Urgent', icon: <HealthIcon type=\"emergency\" className=\"w-4 h-4\" color=\"currentColor\" /> },\n                  { value: 'high', label: 'High', icon: <HealthIcon type=\"warning\" className=\"w-4 h-4\" color=\"currentColor\" /> },\n                  { value: 'moderate', label: 'Moderate', icon: <HealthIcon type=\"warning\" className=\"w-4 h-4\" color=\"currentColor\" /> },\n                  { value: 'low', label: 'Low', icon: <HealthIcon type=\"check\" className=\"w-4 h-4\" color=\"currentColor\" /> }\n                ]}\n                placeholder=\"All Severities\"\n                dropdownKey=\"severity\"\n              />\n\n              {/* Date Filter */}\n              <CustomDropdown\n                value={dateFilter}\n                onChange={(value) => {\n                  setDateFilter(value);\n                  setCurrentPage(1);\n                }}\n                options={[\n                  { value: 'all', label: 'All Time' },\n                  { value: 'today', label: 'Today' },\n                  { value: 'week', label: 'Past Week' },\n                  { value: 'month', label: 'Past Month' },\n                  { value: 'year', label: 'Past Year' }\n                ]}\n                placeholder=\"All Time\"\n                dropdownKey=\"date\"\n              />\n\n              {/* Sort By */}\n              <CustomDropdown\n                value={sortBy}\n                onChange={setSortBy}\n                options={[\n                  { value: 'date_desc', label: 'Newest First' },\n                  { value: 'date_asc', label: 'Oldest First' },\n                  { value: 'severity', label: 'By Severity', icon: <HealthIcon type=\"emergency\" className=\"w-4 h-4\" color=\"currentColor\" /> },\n                  { value: 'pet', label: 'By Pet', icon: <PetIcon species=\"pet\" className=\"w-4 h-4\" color=\"currentColor\" /> }\n                ]}\n                placeholder=\"Newest First\"\n                dropdownKey=\"sort\"\n              />\n            </div>\n          </div>\n\n          {/* Results Summary */}\n          {filteredAndSortedData.length > 0 && (\n            <div className=\"mt-4 flex items-center justify-between text-sm text-gray-600\">\n              <div>\n                {searchQuery && `Found ${filteredAndSortedData.length} SOAP note${filteredAndSortedData.length !== 1 ? 's' : ''} matching \"${searchQuery}\"`}\n              </div>\n              <div>\n                Page {currentPage} of {totalPages}\n              </div>\n            </div>\n          )}\n\n          {/* SOAP Notes List - Now underneath search */}\n          <div className=\"mt-6\">\n            {filteredAndSortedData.length === 0 ? (\n              <div className=\"text-center py-16\">\n                <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                  {searchQuery ? 'No matching SOAP notes found' : 'No notes yet'}\n                </h3>\n                <p className=\"text-gray-600 mb-8 max-w-md mx-auto\">\n                  {searchQuery \n                    ? 'Try adjusting your search terms or filters to find what you\\'re looking for.'\n                    : 'Start using Luni Triage to conduct pet health assessments and generate SOAP notes.'\n                  }\n                </p>\n                {!searchQuery && (\n                  <Link\n                    to=\"/luni-triage\"\n                    className=\"inline-flex items-center px-6 py-3 bg-[#5EB47C] text-white rounded-xl hover:bg-[#4A9A64] transition-all duration-200 shadow-lg hover:shadow-xl font-medium\"\n                  >\n                    Start Triage Assessment\n                  </Link>\n                )}\n              </div>\n            ) : (\n              <>\n                {/* SOAP Notes List - Compact Design */}\n                <div className=\"space-y-2\">\n                  {paginatedData.map((note) => {\n                    const severityConfig = getSeverityConfig(note.severity);\n                    const pet = pets.find(p => p.id === note.pet_id);\n                    \n                    return (\n                      <div\n                        key={note.id}\n                        onClick={() => openSoapModal(note)}\n                        className=\"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer hover:-translate-y-0.5\"\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          {/* Left: Main Info */}\n                          <div className=\"flex items-center space-x-3 flex-1 min-w-0\">\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"flex items-center space-x-2 mb-1\">\n                                <h3 className=\"text-sm font-semibold text-gray-900 truncate\">{note.title}</h3>\n                                <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${severityConfig.badge}`}>\n                                  {note.severity.toUpperCase()}\n                                </span>\n                              </div>\n                              <div className=\"flex items-center space-x-3 text-xs text-gray-600\">\n                                <span className=\"flex items-center\">\n                                  <HealthIcon type=\"calendar\" className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                  {formatDate(note.created_at)}\n                                </span>\n                                {pet && (\n                                  <span className=\"flex items-center\">\n                                    <PetIcon species={pet.species} className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                    {pet.name}\n                                  </span>\n                                )}\n                                {note.source === 'luni_triage' && (\n                                  <span className=\"text-blue-600 flex items-center\">\n                                    <HealthIcon type=\"vaccination\" className=\"w-3 h-3 mr-1\" color=\"currentColor\" />\n                                    Luni Triage\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n\n                          {/* Right: Cost & Arrow */}\n                          <div className=\"flex items-center space-x-3 flex-shrink-0\">\n                            {note.cost && (\n                              <div className=\"text-right\">\n                                <div className=\"text-sm font-semibold text-green-700\">${note.cost}</div>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n\n                {/* Pagination */}\n                {totalPages > 1 && (\n                  <div className=\"mt-8 flex items-center justify-between\">\n                    <div className=\"text-sm text-gray-600\">\n                      Showing {((currentPage - 1) * itemsPerPage) + 1} to {Math.min(currentPage * itemsPerPage, filteredAndSortedData.length)} of {filteredAndSortedData.length} SOAP notes\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <button\n                        onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                        disabled={currentPage === 1}\n                        className=\"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        Previous\n                      </button>\n                      \n                      <div className=\"flex items-center space-x-1\">\n                        {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                          let pageNum;\n                          if (totalPages <= 5) {\n                            pageNum = i + 1;\n                          } else if (currentPage <= 3) {\n                            pageNum = i + 1;\n                          } else if (currentPage >= totalPages - 2) {\n                            pageNum = totalPages - 4 + i;\n                          } else {\n                            pageNum = currentPage - 2 + i;\n                          }\n                          \n                          return (\n                            <button\n                              key={pageNum}\n                              onClick={() => setCurrentPage(pageNum)}\n                              className={`px-3 py-2 rounded-lg text-sm font-medium ${\n                                currentPage === pageNum\n                                  ? 'bg-[#5EB47C] text-white'\n                                  : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {pageNum}\n                            </button>\n                          );\n                        })}\n                      </div>\n                      \n                      <button\n                        onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                        disabled={currentPage === totalPages}\n                        className=\"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        Next\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* SOAP Note Modal */}\n      {renderSOAPModal()}\n    </div>\n  );\n};\n\nexport default CaseHistoryViewer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}