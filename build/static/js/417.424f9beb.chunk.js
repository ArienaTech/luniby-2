"use strict";(self.webpackChunkresponsive_navbar_website=self.webpackChunkresponsive_navbar_website||[]).push([[417],{3417:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var a=s(5043),i=s(1740),r=s(673),l=s(5475),o=s(579);const n=()=>{var e,t,s,n,d,c,m,u,x,p;const{showSuccess:h,showError:g,showWarning:b}=(0,r.M)(),[v,y]=(0,a.useState)(null),[j,f]=(0,a.useState)(!0),[N,w]=(0,a.useState)(!1),[_,k]=(0,a.useState)(!1),[D,E]=(0,a.useState)(!1),[C,S]=(0,a.useState)(""),[T,O]=(0,a.useState)(null),P=(0,l.Zp)();(0,a.useEffect)(()=>{R()},[]);const R=async()=>{try{const{data:{user:e}}=await i.N.auth.getUser();if(!e)return void P("/signin");y(e),await A(e.id)}catch(e){console.error("Error checking user:",e),P("/signin")}finally{f(!1)}},A=async e=>{try{const{data:t}=await i.N.from("profiles").select("*").eq("id",e).single(),{data:s}=await i.N.from("consultation_bookings").select("*").eq("user_id",e),{data:a}=await i.N.from("marketplace_listings").select("*").eq("provider_email",null===t||void 0===t?void 0:t.email);O({profile:t,bookings:s||[],listings:a||[]})}catch(t){console.error("Error loading user data:",t)}};return j?(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,o.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading privacy settings..."})]})}):(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,o.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,o.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,o.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Data Privacy & Control"}),(0,o.jsx)("p",{className:"mt-2 text-gray-600",children:"Manage your personal data and privacy settings in compliance with GDPR regulations."})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Your Data Overview"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,o.jsx)("h3",{className:"font-medium text-blue-900",children:"Profile Information"}),(0,o.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Basic account details, contact information"})]}),(0,o.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,o.jsx)("h3",{className:"font-medium text-green-900",children:"Booking History"}),(0,o.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:[(null===T||void 0===T||null===(e=T.bookings)||void 0===e?void 0:e.length)||0," consultation bookings"]})]}),(0,o.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,o.jsx)("h3",{className:"font-medium text-purple-900",children:"Provider Data"}),(0,o.jsxs)("p",{className:"text-sm text-purple-700 mt-1",children:[(null===T||void 0===T||null===(t=T.listings)||void 0===t?void 0:t.length)||0," service listings"]})]})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Your Privacy Rights"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Right to Data Portability"}),(0,o.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Export all your personal data in a machine-readable format (JSON)."}),(0,o.jsx)("button",{onClick:async()=>{w(!0);try{T||await A(v.id);const e={profile:T.profile,bookings:T.bookings,listings:T.listings,exportDate:(new Date).toISOString(),dataTypes:["Personal Information","Booking History","Provider Listings","Account Settings"]};await i.N.rpc("log_audit_event",{p_action:"data_exported",p_resource_type:"user_data",p_resource_id:v.id,p_details:{export_date:(new Date).toISOString()}});const t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=`my-data-export-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),h("Your data has been exported successfully!")}catch(e){console.error("Error exporting data:",e),g("Failed to export data. Please try again.")}finally{w(!1)}},disabled:N,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Exporting...":"Export My Data"})]}),(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Right to Access"}),(0,o.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"View all personal data we have stored about you."}),(0,o.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Email:"})," ",null===T||void 0===T||null===(s=T.profile)||void 0===s?void 0:s.email]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Name:"})," ",(null===T||void 0===T||null===(n=T.profile)||void 0===n?void 0:n.full_name)||"Not provided"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Role:"})," ","pet_owner"===(null===T||void 0===T||null===(d=T.profile)||void 0===d?void 0:d.role)?"Pet Owner":(null===T||void 0===T||null===(c=T.profile)||void 0===c?void 0:c.role)||"Pet Owner"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Account Created:"})," ",null!==T&&void 0!==T&&null!==(m=T.profile)&&void 0!==m&&m.created_at?new Date(T.profile.created_at).toLocaleDateString():"Unknown"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Last Updated:"})," ",null!==T&&void 0!==T&&null!==(u=T.profile)&&void 0!==u&&u.updated_at?new Date(T.profile.updated_at).toLocaleDateString():"Unknown"]})]})]}),(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Right to Rectification"}),(0,o.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Update or correct your personal information."}),(0,o.jsx)("button",{onClick:()=>P("/profile"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Update Profile"})]}),(0,o.jsxs)("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[(0,o.jsx)("h3",{className:"font-medium text-red-900 mb-2",children:"Right to Erasure (Right to be Forgotten)"}),(0,o.jsx)("p",{className:"text-sm text-red-700 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),D?(0,o.jsx)("div",{className:"space-y-4",children:(0,o.jsxs)("div",{className:"bg-white p-4 rounded border border-red-200",children:[(0,o.jsx)("h4",{className:"font-medium text-red-900 mb-2",children:"Confirm Account Deletion"}),(0,o.jsx)("p",{className:"text-sm text-red-700 mb-4",children:"This will permanently delete:"}),(0,o.jsxs)("ul",{className:"text-sm text-red-700 list-disc list-inside mb-4",children:[(0,o.jsx)("li",{children:"Your profile and personal information"}),(0,o.jsxs)("li",{children:["All booking history (",(null===T||void 0===T||null===(x=T.bookings)||void 0===x?void 0:x.length)||0," bookings)"]}),(0,o.jsxs)("li",{children:["All service listings (",(null===T||void 0===T||null===(p=T.listings)||void 0===p?void 0:p.length)||0," listings)"]}),(0,o.jsx)("li",{children:"Account access and login credentials"})]}),(0,o.jsxs)("p",{className:"text-sm text-red-700 mb-4",children:["Type ",(0,o.jsx)("strong",{children:'"DELETE MY ACCOUNT"'})," to confirm:"]}),(0,o.jsx)("input",{type:"text",value:C,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4",placeholder:"DELETE MY ACCOUNT"}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[(0,o.jsx)("button",{onClick:async()=>{if("DELETE MY ACCOUNT"===C){k(!0);try{var e;await i.N.rpc("log_audit_event",{p_action:"account_deletion_requested",p_resource_type:"user_account",p_resource_id:v.id,p_details:{deletion_date:(new Date).toISOString()}}),await i.N.from("consultation_bookings").delete().eq("user_id",v.id),null!==T&&void 0!==T&&null!==(e=T.profile)&&void 0!==e&&e.email&&await i.N.from("marketplace_listings").delete().eq("provider_email",T.profile.email),await i.N.from("profiles").delete().eq("id",v.id),await i.N.auth.signOut(),h("Your account and all associated data have been deleted."),P("/")}catch(t){console.error("Error deleting account:",t),g("Failed to delete account. Please contact support.")}finally{k(!1),E(!1)}}else b('Please type "DELETE MY ACCOUNT" to confirm')},disabled:_||"DELETE MY ACCOUNT"!==C,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:_?"Deleting...":"Confirm Deletion"}),(0,o.jsx)("button",{onClick:()=>{E(!1),S("")},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})}):(0,o.jsx)("button",{onClick:()=>E(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Delete My Account"})]})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Data Processing Information"}),(0,o.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-sm text-gray-700",children:[(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"How we use your data:"}),(0,o.jsxs)("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[(0,o.jsx)("li",{children:"To provide and improve our pet care marketplace services"}),(0,o.jsx)("li",{children:"To facilitate bookings between customers and providers"}),(0,o.jsx)("li",{children:"To send important notifications about your bookings"}),(0,o.jsx)("li",{children:"To ensure platform security and prevent fraud"}),(0,o.jsx)("li",{children:"To comply with legal obligations"})]}),(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Data retention:"}),(0,o.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,o.jsx)("li",{children:"Profile data: Retained while your account is active"}),(0,o.jsx)("li",{children:"Booking history: Retained for 7 years for business records"}),(0,o.jsx)("li",{children:"Audit logs: Retained for 1 year for security purposes"}),(0,o.jsx)("li",{children:"All data is permanently deleted upon account deletion request"})]})]})]}),(0,o.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Questions about your data?"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["If you have any questions about how we handle your personal data or want to exercise any of your rights, please contact our Data Protection Officer at"," ",(0,o.jsx)("a",{href:"mailto:privacy@petcaremarketplace.com",className:"text-blue-600 hover:underline",children:"privacy@petcaremarketplace.com"})]})]})]})})})})}}}]);
//# sourceMappingURL=417.424f9beb.chunk.js.map