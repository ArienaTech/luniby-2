"use strict";(self.webpackChunkresponsive_navbar_website=self.webpackChunkresponsive_navbar_website||[]).push([[277],{2878:(e,s,t)=>{t.d(s,{A:()=>l});var r=t(1740),a=t(5064);const l={async getPetCaseHistory(e){try{const{data:s,error:t}=await r.N.from("case_history").select("*").eq("pet_id",e).order("created_at",{ascending:!1});return t?{success:!1,error:(0,a.nl)(t),data:[]}:{success:!0,data:s||[]}}catch(s){return{success:!1,error:(0,a.nl)(s),data:[]}}},async getUserCaseHistory(e){try{const{data:s,error:t}=await r.N.from("case_history").select("*").eq("user_id",e).order("created_at",{ascending:!1});return t?{success:!1,error:(0,a.nl)(t),data:[]}:{success:!0,data:s||[]}}catch(s){return{success:!1,error:(0,a.nl)(s),data:[]}}},async getCase(e){try{const{data:s,error:t}=await r.N.from("case_history").select("*").eq("id",e).single();return t?{success:!1,error:(0,a.nl)(t),data:null}:{success:!0,data:s}}catch(s){return{success:!1,error:(0,a.nl)(s),data:null}}},async createCase(e){try{const{data:s,error:t}=await r.N.from("case_history").insert([e]).select().single();return t?{success:!1,error:(0,a.nl)(t),data:null}:{success:!0,data:s}}catch(s){return{success:!1,error:(0,a.nl)(s),data:null}}},async updateCase(e,s){try{const{data:t,error:l}=await r.N.from("case_history").update(s).eq("id",e).select().single();return l?{success:!1,error:(0,a.nl)(l),data:null}:{success:!0,data:t}}catch(t){return{success:!1,error:(0,a.nl)(t),data:null}}}}},4277:(e,s,t)=>{t.r(s),t.d(s,{default:()=>I});var r=t(5043),a=t(5475),l=t(1740),n=t(88),o=t(8171),i=t(579);const d=e=>{let{children:s,alerts:t,loading:r=!1,className:a=""}=e;return r?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#5EB47C] mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading your dashboard..."})]})}):(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 relative overflow-x-hidden",children:(0,i.jsx)("section",{className:`pt-4 sm:pt-8 pb-8 px-3 sm:px-6 lg:px-12 ${a}`,children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[t&&t.length>0&&(0,i.jsx)("div",{className:"mb-6",children:t.map((e,s)=>(0,i.jsx)("div",{className:"mb-4",children:e},s))}),s]})})})},c=e=>{let{id:s,label:t,isActive:r,onClick:a,icon:l}=e;return(0,i.jsxs)("button",{onClick:()=>a(s),className:"py-2 px-1 font-medium text-sm whitespace-nowrap flex-shrink-0 flex items-center space-x-2 "+(r?"text-[#5EB47C]":"text-gray-500 hover:text-gray-700"),children:[l&&(0,i.jsx)("span",{children:l}),(0,i.jsx)("span",{children:t})]})},m=e=>{let{activeTab:s,onTabChange:t,tabs:r}=e;const a=r||[{id:"overview",label:"Overview"},{id:"health",label:"Health Records"},{id:"cases",label:"SOAP Notes"},{id:"favorites",label:"Favorites"}];return(0,i.jsx)("div",{className:"mb-6 sm:mb-8",children:(0,i.jsx)("div",{className:"border-b border-gray-200",children:(0,i.jsx)("nav",{className:"-mb-px flex space-x-6 sm:space-x-8 overflow-x-auto scrollbar-hide",children:a.map(e=>(0,i.jsx)(c,{id:e.id,label:e.label,isActive:s===e.id,onClick:t,icon:e.icon},e.id))})})})};var x=t(5526);const h=e=>{let{icon:s,title:t,value:r,color:a="blue",onClick:l,description:n}=e;return(0,i.jsxs)("div",{className:`text-center p-3 sm:p-4 bg-${a}-50 rounded-xl border border-${a}-100 ${l?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:l,children:[(0,i.jsx)("div",{className:`w-10 h-10 sm:w-12 sm:h-12 bg-${a}-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3`,children:s}),(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-1",children:r}),(0,i.jsx)("div",{className:`text-xs text-${a}-700 font-medium`,children:t}),n&&(0,i.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:n})]})},u=e=>{let{totalPets:s,totalHealthRecords:t,petsUpToDate:r,healthPercentage:a,healthAlerts:l,onHealthRecordsClick:n,onAlertsClick:o}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 lg:gap-4",children:[(0,i.jsx)(h,{icon:(0,i.jsx)(x.mT,{type:"pet",className:"w-6 h-6",color:"#3B82F6"}),title:"My Pets",value:s,color:"blue"}),(0,i.jsx)(h,{icon:(0,i.jsx)(x.mT,{type:"records",className:"w-6 h-6",color:"#10B981"}),title:"Health Records",value:t,color:"green",onClick:n}),(0,i.jsx)(h,{icon:(0,i.jsx)(x.mT,{type:"vaccination",className:"w-6 h-6",color:"#8B5CF6"}),title:"Up to Date",value:r,color:"purple"}),(0,i.jsx)(h,{icon:(0,i.jsx)(x.mT,{type:"warning",className:"w-6 h-6",color:"#F59E0B"}),title:"Health Alerts",value:l,color:"orange",onClick:o})]})},g=e=>{let{feature:s,current:t,limit:r,upgradeText:l,onClose:n,className:o=""}=e;return(0,i.jsx)("div",{className:`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-4 sm:mb-6 ${o}`,children:(0,i.jsx)("div",{className:"px-4 sm:px-8 py-3 sm:py-4",children:(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[(0,i.jsxs)("div",{className:"flex items-start sm:items-center flex-1",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-[#5EB47C]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,i.jsxs)("div",{className:"ml-3 flex-1",children:[(0,i.jsxs)("h3",{className:"text-base sm:text-lg font-bold text-gray-900",children:[s," Limit Reached"]}),(0,i.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:["You're using ",t," of ",r," ",s.toLowerCase()," on your free plan. ",l]})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2 sm:ml-4",children:[(0,i.jsx)(a.N_,{to:"/pricing",className:"bg-gradient-to-r from-[#5EB47C] to-green-600 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium hover:from-[#4A9A64] hover:to-green-700 transition-all shadow-sm hover:shadow-md",children:"Upgrade Now"}),n&&(0,i.jsx)("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",title:"Close",children:(0,i.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})})})},p=e=>{let{totalSpentOnExtras:s,userPlan:t}=e;return"free"!==t||s<6?null:(0,i.jsx)("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),(0,i.jsxs)("div",{className:"ml-3",children:[(0,i.jsxs)("h3",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[(0,i.jsx)(x.Sd,{type:"money",className:"w-4 h-4 mr-2",color:"currentColor"}),"You've spent $",s.toFixed(2)," on extra Luni Triage"]}),(0,i.jsx)("p",{className:"text-sm text-yellow-700",children:"Premium is only $9.99/month for unlimited access - you'd save money!"})]})]}),(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)(a.N_,{to:"/upgrade",className:"bg-gradient-to-r from-[#5EB47C] to-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-[#4A9A64] hover:to-green-700 transition-all shadow-sm hover:shadow-md",children:"Upgrade Now"})})]})})},b=e=>{let{userPlan:s,canCreateCaseThisWeek:t,onShowExtraCaseModal:r}=e;return"free"!==s||t?null:(0,i.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6",children:(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[(0,i.jsxs)("div",{className:"flex items-start sm:items-center",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,i.jsxs)("div",{className:"ml-3",children:[(0,i.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-blue-800",children:"You've used your free Luni Triage for this week"}),(0,i.jsx)("p",{className:"text-xs sm:text-sm text-blue-700",children:"Get instant access to another Luni Triage consultation for just $2.99, or upgrade to Premium for unlimited access."})]})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 sm:flex-shrink-0",children:[(0,i.jsx)("button",{onClick:r,className:"bg-gradient-to-r from-[#5EB47C] to-green-600 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium hover:from-[#4A9A64] hover:to-green-700 transition-all shadow-sm hover:shadow-md",children:"Buy Extra Luni Triage - $2.99"}),(0,i.jsx)(a.N_,{to:"/upgrade",className:"bg-white text-blue-600 border border-blue-200 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium hover:bg-blue-50 transition-all text-center",children:"Upgrade"})]})]})})},f=e=>{let{userPlan:s,aiTriageCount:t,totalSpentOnExtras:r,canCreateCaseThisWeek:a,onShowExtraCaseModal:l}=e;const n=[];return"free"===s&&t>=3&&n.push((0,i.jsx)(g,{feature:"AI Triage",current:t,limit:"3",upgradeText:"Get unlimited AI health consultations with Premium."},"ai-triage-limit")),n.push((0,i.jsx)(p,{totalSpentOnExtras:r,userPlan:s},"spending-awareness")),n.push((0,i.jsx)(b,{userPlan:s,canCreateCaseThisWeek:a,onShowExtraCaseModal:l},"usage-limit")),(0,i.jsx)("div",{className:"banners-container",children:n.filter(Boolean)})},v=e=>{let{onClick:s,to:t,className:r,title:l,children:n,badge:o}=e;const d=`group rounded-full p-3 sm:p-4 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center relative ${r}`,c=(0,i.jsxs)(i.Fragment,{children:[n,o&&(0,i.jsx)("span",{className:"absolute -top-1 -right-1 bg-yellow-500 text-white text-xs px-1 rounded-full font-bold",children:o})]});return t?(0,i.jsx)(a.N_,{to:t,className:d,title:l,children:c}):(0,i.jsx)("button",{onClick:s,className:d,title:l,children:c})},y=e=>{let{canUseAiTriage:s,canCreateCaseThisWeek:t,userPlan:r,getRemainingFreeCasesThisWeek:a,onShowExtraCaseModal:l,showMobileMenu:n,onToggleMobileMenu:o}=e;return(0,i.jsxs)("div",{className:"fixed bottom-4 right-4 sm:bottom-6 sm:right-6 flex flex-col space-y-2 sm:space-y-3 z-50",children:[(()=>{if(s&&t){const e=a(),s="free"===r&&"Unlimited"!==e&&e<=1;return(0,i.jsx)(v,{to:"/luni-triage",className:"bg-red-500 hover:bg-red-600 text-white",title:"Emergency AI Health Check"+("free"===r?` (${e} free cases left this week)`:""),badge:s?e:null,children:(0,i.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})})}return s&&!t?(0,i.jsx)(v,{onClick:l,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white",title:"Buy Extra Case - $2.99",badge:"$2.99",children:(0,i.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}):(0,i.jsx)(v,{to:"/pricing",className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white",title:"Upgrade for AI Health Check",children:(0,i.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})})(),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(v,{onClick:()=>o(!n),className:"bg-gray-800 hover:bg-gray-900 text-white lg:hidden",title:"Quick Actions",children:(0,i.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 transition-transform duration-200 "+(n?"rotate-45":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),n&&(0,i.jsxs)("div",{className:"absolute bottom-16 right-0 flex flex-col space-y-2 lg:hidden",children:[(0,i.jsx)(v,{to:"/marketplace",className:"bg-blue-600 hover:bg-blue-700 text-white",title:"Browse Services",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,i.jsx)(v,{to:"/favorites",className:"bg-pink-600 hover:bg-pink-700 text-white",title:"My Favorites",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})]})]})},j=e=>{var s,t;let{profile:r,user:a,profilePhotoUrl:l,pets:n=[],healthStats:o={},bookings:d=[],onPhotoUpload:c}=e;return(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden relative",children:[(0,i.jsx)("div",{className:"h-28 sm:h-32 lg:h-40 bg-white relative border-b border-gray-100",children:(0,i.jsx)("div",{className:"absolute bottom-3 sm:bottom-4 left-3 sm:left-4 right-3 sm:right-4",children:(0,i.jsxs)("div",{className:"flex items-end space-x-3 sm:space-x-4",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 lg:w-24 lg:h-24 bg-white rounded-full p-1 shadow-lg border border-gray-200",children:(0,i.jsx)("div",{className:"w-full h-full bg-gray-100 rounded-full flex items-center justify-center overflow-hidden",children:l?(0,i.jsx)("img",{src:l,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):(e=>{const s=(null===a||void 0===a||null===(e=a.user_metadata)||void 0===e?void 0:e.user_type)||(null===r||void 0===r?void 0:r.role);return"pet_owner"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/pet-owner.svg",alt:"Pet Owner",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"breeder"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/breeder.svg",alt:"Breeder",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"nutritionist"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/nutritionist.svg",alt:"Nutritionist",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"holistic_care"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/holistic-care.svg",alt:"Holistic Care",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"pet_business"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/PetBusiness.svg",alt:"Pet Business",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"trainer"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/pet-trainer.svg",alt:"Trainer",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"groomer"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/groomer.svg",alt:"Groomer",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"veterinarian"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/vet.svg",alt:"Veterinarian",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):"vet_nurse"===s?(0,i.jsx)("img",{src:"https://wagrmmbkukwblfpfxxcb.supabase.co/storage/v1/object/public/web-img/vet-nurse%20(1).svg",alt:"Vet Nurse",className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20"}):(0,i.jsx)("span",{className:"text-xl sm:text-2xl lg:text-3xl",children:"\ud83d\udc64"})})()})}),c&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:c,className:"hidden",id:"profile-photo-upload-header"}),(0,i.jsx)("label",{htmlFor:"profile-photo-upload-header",className:"hidden sm:flex absolute bottom-0 right-0 w-6 h-6 bg-[#5EB47C] rounded-full items-center justify-center text-white text-xs shadow-lg hover:bg-[#4A9A64] transition-colors cursor-pointer border border-white",children:(0,i.jsx)(x.mT,{type:"camera",className:"w-3 h-3",color:"white"})})]})]}),(0,i.jsxs)("div",{className:"flex-1 text-gray-800 pb-1 sm:pb-2",children:[(0,i.jsx)("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold",children:(null===r||void 0===r||null===(s=r.full_name)||void 0===s?void 0:s.split(" ")[0])||(null===a||void 0===a||null===(t=a.email)||void 0===t?void 0:t.split("@")[0])||"Pet Parent"}),(0,i.jsxs)("p",{className:"text-gray-600 text-xs sm:text-sm",children:["Loving parent to ",n.length," amazing pet",1!==n.length?"s":""]})]})]})})}),(0,i.jsx)("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-t",children:(0,i.jsxs)("div",{className:"flex items-center justify-between text-center",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"text-base sm:text-lg font-bold text-gray-900",children:n.length}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Pets"})]}),(0,i.jsx)("div",{className:"w-px h-6 sm:h-8 bg-gray-300"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"text-base sm:text-lg font-bold text-green-600",children:[o.healthPercentage||0,"%"]}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Health"})]}),(0,i.jsx)("div",{className:"w-px h-6 sm:h-8 bg-gray-300"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"text-base sm:text-lg font-bold text-blue-600",children:d.length}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Bookings"})]}),(0,i.jsx)("div",{className:"w-px h-6 sm:h-8 bg-gray-300"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"text-base sm:text-lg font-bold text-purple-600",children:n.reduce((e,s)=>{var t;return e+((null===(t=s.health_records)||void 0===t?void 0:t.length)||0)},0)}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:"Records"})]})]})})]})},N=e=>{let{pets:s=[],userPlan:t="free",dismissedPetLimitBanner:a=!1,onAddPet:l,onEditPet:n,onDeletePet:o,onDismissPetLimitBanner:d,FreemiumLimitBanner:c}=e;const[m,h]=(0,r.useState)("all"),u=s.filter(e=>"all"===m||("dogs"===m?"dog"===e.species:"cats"!==m||"cat"===e.species));return(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,i.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"My Pets"}),(0,i.jsxs)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#E5F4F1] text-[#5EB47C]",children:[s.length," pet",1!==s.length?"s":""]})]}),(0,i.jsxs)("button",{onClick:l,className:"inline-flex items-center px-3 py-1.5 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-all duration-200 text-sm font-medium",children:[(0,i.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Pet"]})]})}),(0,i.jsxs)("div",{className:"p-6",children:[s.length>0&&(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsxs)("div",{className:"flex items-center space-x-1 mb-4 overflow-x-auto pb-2",children:[(0,i.jsxs)("button",{onClick:()=>h("all"),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("all"===m?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:["All (",s.length,")"]}),(0,i.jsx)("button",{onClick:()=>h("dogs"),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("dogs"===m?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Dogs"}),(0,i.jsx)("button",{onClick:()=>h("cats"),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("cats"===m?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Cats"})]})}),u.length>0?(0,i.jsx)("div",{className:"flex overflow-x-auto scrollbar-hide gap-3 sm:grid sm:grid-cols-3 lg:grid-cols-4 sm:gap-3 pb-2",children:u.map(e=>(0,i.jsxs)("div",{className:"group relative aspect-square bg-gray-100 rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all duration-200 flex-shrink-0 w-40 sm:w-auto",children:[(0,i.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-[#E5F4F1] to-[#D1F2EB] flex items-center justify-center",children:e.photo_url?(0,i.jsx)("img",{src:e.photo_url,alt:e.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):(0,i.jsx)("div",{className:"opacity-80",children:(0,i.jsx)(x.j8,{species:e.species,className:"w-16 h-16 sm:w-20 sm:h-20",color:"#6B7280"})})}),(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-all duration-200",children:(0,i.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-white",children:[(0,i.jsx)("h3",{className:"font-bold text-sm truncate",children:e.name}),(0,i.jsx)("p",{className:"text-xs opacity-90 capitalize",children:e.breed})]})}),(0,i.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-all duration-200",children:(0,i.jsxs)("div",{className:"flex space-x-1",children:[(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),n(e)},className:"w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-lg hover:bg-white transition-colors",children:(0,i.jsx)(x.mT,{type:"edit",className:"w-4 h-4",color:"#6B7280"})}),(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),o(e.id)},className:"w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-lg hover:bg-white transition-colors",children:(0,i.jsx)(x.mT,{type:"delete",className:"w-4 h-4",color:"#EF4444"})})]})}),(0,i.jsx)("div",{className:"absolute top-2 left-2",children:(0,i.jsx)("div",{className:`w-3 h-3 rounded-full ${"excellent"===e.health_status?"bg-green-400":"good"===e.health_status?"bg-yellow-400":"needs_attention"===e.health_status?"bg-red-400":"bg-gray-400"} shadow-sm`})})]},e.id))}):0===s.length?(0,i.jsxs)("div",{className:"text-center py-16",children:[(0,i.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-[#E5F4F1] rounded-full flex items-center justify-center",children:(0,i.jsx)(x.j8,{species:"pet",className:"w-10 h-10",color:"#5EB47C"})}),(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Your pet family awaits!"}),(0,i.jsx)("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Create beautiful memories by adding your first furry, feathered, or scaly companion."}),(0,i.jsxs)("button",{onClick:l,className:"inline-flex items-center px-6 py-3 bg-[#5EB47C] text-white rounded-xl hover:bg-[#4A9A64] transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:[(0,i.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Your First Pet"]})]}):(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,i.jsx)(x.mT,{type:"search",className:"w-8 h-8",color:"#6B7280"})}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No pets found"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your filter criteria."}),(0,i.jsx)("button",{onClick:()=>h("all"),className:"text-[#5EB47C] hover:text-[#4A9A64] font-medium",children:"Show all pets"})]})]}),"free"===t&&s.length>=2&&!a&&c&&(0,i.jsx)("div",{className:"mt-6 px-5",children:(0,i.jsx)(c,{feature:"Pet",current:s.length,limit:"2",upgradeText:"Upgrade to Premium for unlimited pets and advanced features.",onClose:d})})]})},w=e=>{let{healthAlerts:s=[]}=e;return 0===s.length?null:(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsxs)("div",{className:"rounded-xl p-4 "+(s.some(e=>e.urgent)?"bg-red-50 border border-red-200":"bg-yellow-50 border border-yellow-200"),children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)("svg",{className:"w-5 h-5 mr-2 "+(s.some(e=>e.urgent)?"text-red-600":"text-yellow-600"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,i.jsx)("h3",{className:"font-semibold "+(s.some(e=>e.urgent)?"text-red-800":"text-yellow-800"),children:"Health Alerts"})]}),(0,i.jsx)("div",{className:"space-y-1",children:s.map((e,t)=>(0,i.jsxs)("p",{className:"text-sm "+(s.some(e=>e.urgent)?"text-red-700":"text-yellow-700"),children:[(0,i.jsxs)("strong",{children:[e.petName,":"]})," ",e.message]},t))})]})})},C=e=>{let{userPlan:s="free",totalSpentOnExtras:t=0,pets:r=[],onShowExtraCaseModal:l,getRemainingFreeCasesThisWeek:n,canCreateCaseThisWeek:o,canUseAiTriage:d,canAddMorePets:c}=e;return"free"!==s?null:(0,i.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-4 sm:p-6",children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 space-y-3 sm:space-y-0",children:[(0,i.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Your Usage This Week"}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[t>0&&(0,i.jsxs)("span",{className:"text-xs sm:text-sm bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-center",children:["$",t.toFixed(2)," spent on extras"]}),(0,i.jsx)(a.N_,{to:"/pricing",className:"bg-gradient-to-r from-[#5EB47C] to-green-600 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium hover:from-[#4A9A64] hover:to-green-700 transition-all shadow-sm hover:shadow-md text-center",children:"Upgrade for Unlimited"})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4",children:[(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900",children:"Weekly Luni Triage"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Free AI consultations"})]}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsxs)("div",{className:"text-2xl font-bold "+(o()?"text-green-600":"text-red-600"),children:[n(),"/1"]}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"remaining this week"})]})]}),(0,i.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,i.jsx)("div",{className:"h-2 rounded-full "+(o()?"bg-green-500":"bg-red-500"),style:{width:`${Math.min(100,Math.max(0,(1-n())/1*100))}%`}})}),!o()&&(0,i.jsx)("button",{onClick:l,className:"mt-2 w-full text-xs bg-[#5EB47C] text-white py-1 rounded hover:bg-[#4A9A64] transition-colors",children:"Buy Extra Luni Triage - $2.99"})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900",children:"Monthly AI Sessions"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"This month's usage"})]}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsxs)("div",{className:"text-2xl font-bold "+(d()?"text-green-600":"text-red-600"),children:[Math.max(0,3-(3-(d()?3:0))),"/3"]}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"remaining"})]})]}),(0,i.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,i.jsx)("div",{className:"h-2 rounded-full "+(d()?"bg-green-500":"bg-red-500"),style:{width:`${Math.min(100,Math.max(0,(3-(d()?3:0))/3*100))}%`}})})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900",children:"Pet Slots"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Maximum pets allowed"})]}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsxs)("div",{className:"text-2xl font-bold "+(c()?"text-green-600":"text-amber-600"),children:[r.length,"/3"]}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"pets added"})]})]}),(0,i.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,i.jsx)("div",{className:"h-2 rounded-full "+(r.length<3?"bg-green-500":"bg-amber-500"),style:{width:`${Math.min(100,r.length/3*100)}%`}})})]})]}),(0,i.jsx)("div",{className:"mt-4 text-center",children:(0,i.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600",children:["Limits reset weekly for Luni Triage, monthly for AI sessions. Need more?",(0,i.jsx)("button",{onClick:l,className:"text-[#5EB47C] hover:text-[#4A9A64] font-medium ml-1",children:"Buy extra Luni Triage for $2.99"})," or",(0,i.jsx)(a.N_,{to:"/pricing",className:"text-[#5EB47C] hover:text-[#4A9A64] font-medium ml-1",children:"upgrade to Premium \u2192"})]})})]})},k=e=>{let{bookings:s=[],onSetActiveTab:t}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[(0,i.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200 shadow-sm",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Bookings"}),(0,i.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium "+(s.length>0?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:0===s.length?"No Bookings":`${s.length} Booking${1!==s.length?"s":""}`})]}),s.length>0?(0,i.jsx)("div",{className:"space-y-3",children:s.slice(0,3).map((e,s)=>(0,i.jsx)("div",{className:"p-3 rounded-lg border-l-4 bg-blue-50 border-blue-400",children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)(x.mT,{type:"calendar",className:"w-5 h-5 mr-3 mt-0.5",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:e.service_name}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:e.provider_name}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.consultation_date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,i.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+("confirmed"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]})},s))}):(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("div",{className:"w-12 h-12 mx-auto mb-3 bg-blue-100 rounded-full flex items-center justify-center",children:(0,i.jsx)(x.mT,{type:"calendar",className:"w-6 h-6",color:"#3B82F6"})}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"No upcoming bookings"}),(0,i.jsx)(a.N_,{to:"/marketplace",className:"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors text-sm font-medium",children:"Book a Service"})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 border border-gray-200 shadow-sm",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("button",{onClick:()=>t("health"),className:"w-full flex items-center p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3",children:(0,i.jsx)(x.mT,{type:"health",className:"w-5 h-5",color:"#3B82F6"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Health Records"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"View and manage health data"})]})]}),(0,i.jsxs)(a.N_,{to:"/marketplace",className:"w-full flex items-center p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3",children:(0,i.jsx)(x.Sd,{type:"shopping",className:"w-5 h-5",color:"#8B5CF6"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Book Services"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Find vets and pet services"})]})]}),(0,i.jsxs)(a.N_,{to:"/triage",className:"w-full flex items-center p-3 text-left bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3",children:(0,i.jsx)(x.mT,{type:"vaccination",className:"w-5 h-5",color:"#10B981"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"AI Health Triage"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Get instant health advice"})]})]})]})]})]})};var P=t(2659);const _=e=>{let{pets:s,userPlan:t,onEditRecord:a,onDeleteRecord:l,onRefresh:n,onAddRecord:o,refreshKey:d=0}=e;const[c,m]=(0,r.useState)({}),[h,u]=(0,r.useState)(!0),[g,p]=(0,r.useState)(null),[b,f]=(0,r.useState)(null),[v,y]=(0,r.useState)(new Set),[j,N]=(0,r.useState)(""),[w,C]=(0,r.useState)("all"),[k,_]=(0,r.useState)("date_desc"),[D,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=e=>{D&&!e.target.closest(".custom-dropdown")&&S(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[D]);const E=e=>{var s;let{value:t,onChange:r,options:a,placeholder:l,dropdownKey:n}=e;return(0,i.jsxs)("div",{className:"custom-dropdown relative",children:[(0,i.jsxs)("button",{type:"button",onClick:()=>S(D===n?null:n),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50",children:[(0,i.jsx)("span",{className:"truncate",children:(null===(s=a.find(e=>e.value===t))||void 0===s?void 0:s.label)||l}),(0,i.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform "+(D===n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D===n&&(0,i.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:a.map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>{r(e.value),S(null)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg "+(t===e.value?"bg-[#E5F4F1] text-[#5EB47C]":"text-gray-700"),children:e.label},e.value))})]})};(0,r.useEffect)(()=>{s&&s.length>0?T():u(!1)},[s,d]);const T=async()=>{u(!0);try{const e={};await Promise.all(s.map(async s=>{try{const t=await P.A.getHealthRecords(s.id);e[s.id]={pet:s,records:t.success?t.data:[],error:t.success?null:t.error}}catch(t){console.error(`Error loading records for ${s.name}:`,t),e[s.id]={pet:s,records:[],error:t.message}}})),m(e),p("all")}catch(e){console.error("Error loading health records:",e)}finally{u(!1)}};if(h)return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-2 border-[#5EB47C] border-t-transparent mb-4"}),(0,i.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading health records..."}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Please wait while we gather your pet's medical history"})]});if(!s||0===s.length)return(0,i.jsxs)("div",{className:"text-center py-16",children:[(0,i.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-[#E5F4F1] rounded-full flex items-center justify-center",children:(0,i.jsx)(x.mT,{type:"health",className:"w-10 h-10",color:"#5EB47C"})}),(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No pets added yet"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Add your first pet to start tracking health records"})]});const A=Object.values(c).reduce((e,s)=>e+s.records.length,0);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsxs)("div",{className:"flex items-center space-x-1 overflow-x-auto pb-2",children:[(0,i.jsx)("button",{onClick:()=>p("all"),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("all"===g?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"All Pets"}),s.map(e=>(0,i.jsx)("button",{onClick:()=>p(e.id),className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+(g===e.id?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.name},e.id))]})}),g&&("all"===g&&A>0||"all"!==g&&c[g]&&c[g].records.length>0)&&(0,i.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[(0,i.jsx)("div",{className:"flex-1 w-full",children:(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)("input",{type:"text",placeholder:"Search health records, procedures, medications...",value:j,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})})}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,i.jsx)(E,{value:w,onChange:C,options:[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"Past Week"},{value:"month",label:"Past Month"},{value:"year",label:"Past Year"}],placeholder:"All Time",dropdownKey:"date"}),(0,i.jsx)(E,{value:k,onChange:_,options:[{value:"date_desc",label:"Newest First"},{value:"date_asc",label:"Oldest First"},{value:"type",label:"By Type"},{value:"cost",label:"By Cost"}],placeholder:"Newest First",dropdownKey:"sort"})]})]}),g&&("all"===g||c[g])&&(0,i.jsx)("div",{className:"space-y-4",children:(e=>{const s="all"===g?Object.values(c).flatMap(e=>e.records.map(s=>({...s,petInfo:e.pet}))):(null===(e=c[g])||void 0===e?void 0:e.records)||[];return 0===s.length?(0,i.jsxs)("div",{className:"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300",children:[(0,i.jsx)("div",{className:"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm",children:(0,i.jsx)(x.mT,{type:"records",className:"w-8 h-8",color:"#6B7280"})}),(0,i.jsx)("h4",{className:"text-xl font-semibold text-gray-900 mb-2",children:"all"===g?"No health records yet":`No health records yet for ${c[g].pet.name}`}),(0,i.jsx)("p",{className:"text-gray-600 mb-6 max-w-sm mx-auto",children:"all"===g?"Start building your pets' medical history by adding their first health records.":`Start building ${c[g].pet.name}'s medical history by adding their first health record.`}),"all"!==g&&(0,i.jsxs)("button",{onClick:()=>{o&&o(c[g].pet)},className:"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium",children:[(0,i.jsx)(x.mT,{type:"vaccination",className:"w-4 h-4 mr-2",color:"white"}),"Add First Record"]})]}):(0,i.jsx)(i.Fragment,{children:(()=>{const e=s.filter(e=>{if(j.trim()){var s,t,r,a,l,n,o;const i=j.toLowerCase();if(!((null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(i))||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(i))||(null===(r=e.record_type)||void 0===r?void 0:r.toLowerCase().includes(i))||(null===(a=e.veterinarian_name)||void 0===a?void 0:a.toLowerCase().includes(i))||(null===(l=e.clinic_name)||void 0===l?void 0:l.toLowerCase().includes(i))||(null===(n=e.notes)||void 0===n?void 0:n.toLowerCase().includes(i))||(null===(o=e.medications)||void 0===o?void 0:o.some(e=>e.toLowerCase().includes(i)))))return!1}if("all"!==w){const s=new Date(e.date_performed),t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(w){case"today":if(s<r)return!1;break;case"week":const e=new Date(r);if(e.setDate(e.getDate()-7),s<e)return!1;break;case"month":const t=new Date(r);if(t.setMonth(t.getMonth()-1),s<t)return!1;break;case"year":const a=new Date(r);if(a.setFullYear(a.getFullYear()-1),s<a)return!1}}return!0}).sort((e,s)=>{var t;switch(k){case"date_asc":return new Date(e.date_performed)-new Date(s.date_performed);case"date_desc":default:return new Date(s.date_performed)-new Date(e.date_performed);case"type":return(null===(t=e.record_type)||void 0===t?void 0:t.localeCompare(s.record_type))||0;case"cost":const r=parseFloat(e.cost)||0;return(parseFloat(s.cost)||0)-r}});return 0!==e.length||!j.trim()&&"all"===w?(0,i.jsxs)("div",{className:"space-y-2",children:[j.trim()&&(0,i.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:["Found ",e.length," record",1!==e.length?"s":"",' matching "',j,'"']}),e.map(e=>{const s=v.has(e.id);return(0,i.jsxs)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg shadow-sm transition-all duration-200",children:[(0,i.jsx)("div",{onClick:()=>{return s=e.id,void y(e=>{const t=new Set(e);return t.has(s)?t.delete(s):t.add(s),t});var s},className:"p-3 cursor-pointer hover:shadow-md transition-all duration-200 hover:-translate-y-0.5",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:e.title}),(0,i.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${r=e.record_type,{checkup:"bg-blue-100 text-blue-800",vaccination:"bg-green-100 text-green-800",surgery:"bg-red-100 text-red-800",emergency:"bg-orange-100 text-orange-800",dental:"bg-purple-100 text-purple-800",grooming:"bg-pink-100 text-pink-800",lab_work:"bg-yellow-100 text-yellow-800",other:"bg-gray-100 text-gray-800"}[r]||"bg-gray-100 text-gray-800"}`,children:e.record_type.replace("_"," ").toUpperCase()})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-gray-600",children:[(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(x.mT,{type:"calendar",className:"w-3 h-3 mr-1",color:"currentColor"}),(t=e.date_performed,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]}),"all"===g&&e.petInfo&&(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(x.j8,{species:"pet",className:"w-3 h-3 mr-1",color:"currentColor"}),e.petInfo.name]}),e.veterinarian_name&&(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(x.mT,{type:"doctor",className:"w-3 h-3 mr-1",color:"currentColor"}),e.veterinarian_name]})]})]})}),(0,i.jsxs)("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[e.cost&&(0,i.jsx)("div",{className:"text-right",children:(0,i.jsxs)("div",{className:"text-sm font-semibold text-green-700",children:["$",e.cost]})}),(0,i.jsx)("div",{className:"w-6 h-6 bg-white/60 rounded-full flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-3 h-3 text-gray-600 transition-transform duration-200 "+(s?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})}),s&&(0,i.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white/50",children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.description})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 mb-4",children:[e.clinic_name&&(0,i.jsx)("div",{className:"flex items-center p-3 bg-white rounded-lg border",children:(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Clinic"}),(0,i.jsx)("div",{className:"text-sm font-semibold text-gray-900 truncate",children:e.clinic_name})]})}),e.weight&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-white rounded-lg border",children:[(0,i.jsx)(x.mT,{type:"weight",className:"w-5 h-5 mr-2 flex-shrink-0",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Weight"}),(0,i.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:[e.weight," lbs"]})]})]}),e.temperature&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-white rounded-lg border",children:[(0,i.jsx)(x.mT,{type:"temperature",className:"w-5 h-5 mr-2 flex-shrink-0",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Temperature"}),(0,i.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:[e.temperature,"\xb0F"]})]})]})]}),e.documents&&e.documents.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Documents"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:e.documents.map((e,s)=>(0,i.jsxs)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center max-w-xs px-2 py-1 rounded-full text-xs border border-gray-200 bg-white hover:bg-gray-50 text-gray-700",title:e.name,children:[(0,i.jsx)("span",{className:"mr-1",children:(e.type||"").startsWith("image/")?(0,i.jsx)(x.mT,{type:"image",className:"w-4 h-4",color:"currentColor"}):"application/pdf"===e.type?(0,i.jsx)(x.mT,{type:"document",className:"w-4 h-4",color:"currentColor"}):(0,i.jsx)(x.mT,{type:"attachment",className:"w-4 h-4",color:"currentColor"})}),(0,i.jsx)("span",{className:"truncate",children:e.name})]},s))})]}),e.medications&&e.medications.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Medications Prescribed"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:e.medications.map((e,s)=>(0,i.jsx)("span",{className:"inline-flex items-center px-3 py-1 bg-white text-gray-700 rounded-full text-sm font-medium border",children:e},s))})]}),e.notes&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("h5",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center",children:[(0,i.jsx)(x.Sd,{type:"write",className:"w-4 h-4 mr-2",color:"currentColor"}),"Additional Notes"]}),(0,i.jsx)("div",{className:"p-3 bg-white rounded-lg border",children:(0,i.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.notes})})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0 pt-3 border-t border-gray-200",children:[(0,i.jsxs)("div",{className:"text-xs text-gray-500",children:["Added ",new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),(e=>{a?a(e):alert("Edit functionality not implemented yet. Please contact support.")})(e)},className:"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-white hover:bg-gray-50 text-gray-700 hover:text-gray-900 rounded-lg transition-all duration-200 text-sm font-medium border hover:shadow-sm",children:"Edit"}),(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this health record? This action cannot be undone.")){f(e);try{const s=await P.A.deleteHealthRecord(e);s.success?(await T(),n&&n(),alert("Health record deleted successfully!")):alert(`Failed to delete health record: ${s.error}`)}catch(s){console.error("Error deleting health record:",s),alert(`Error deleting health record: ${s.message}`)}finally{f(null)}}})(e.id)},disabled:b===e.id,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-700 hover:text-red-800 rounded-lg transition-all duration-200 text-sm font-medium disabled:opacity-50",children:b===e.id?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border border-red-600 border-t-transparent mr-1"}),(0,i.jsx)("span",{className:"hidden sm:inline",children:"Deleting..."}),(0,i.jsx)("span",{className:"sm:hidden",children:"..."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"hidden sm:inline",children:"Delete"}),(0,i.jsx)("span",{className:"sm:hidden",children:"Del"})]})})]})]})]})]},e.id);var t,r})]}):(0,i.jsxs)("div",{className:"text-center py-16 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-300",children:[(0,i.jsx)("div",{className:"w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-sm",children:(0,i.jsx)(x.mT,{type:"search",className:"w-8 h-8",color:"#6B7280"})}),(0,i.jsx)("h4",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No matching health records found"}),(0,i.jsxs)("p",{className:"text-gray-600 mb-6 max-w-sm mx-auto",children:["Try adjusting your search terms or filters to see more records","all"!==g?` for ${c[g].pet.name}`:"","."]}),(0,i.jsx)("button",{onClick:()=>{N(""),C("all")},className:"inline-flex items-center px-4 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium",children:"Clear Filters"})]})})()})})()})]})},D=e=>{let{petId:s,petName:t}=e;const[a,l]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0);(0,r.useEffect)(()=>{s?d():o(!1)},[s]);const d=async()=>{o(!0);try{const e=await P.A.getHealthRecords(s);e.success&&l(e.data)}catch(e){console.error("Error loading health records:",e)}finally{o(!1)}};return n?(0,i.jsx)("div",{className:"text-center py-4",children:"Loading health records..."}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("h3",{className:"text-lg font-semibold",children:["Health Records for ",t]}),0===a.length?(0,i.jsx)("p",{className:"text-gray-600",children:"No health records yet."}):(0,i.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,i.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,i.jsx)("h4",{className:"font-medium",children:e.title}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.date_performed).toLocaleDateString()})]},e.id))})]})},S=e=>{let{petId:s,petName:t,pets:a,userPlan:l,onEditRecord:n,onDeleteRecord:o,onRefresh:d,onAddRecord:c,refreshKey:m}=e;const[h]=(0,r.useState)(!a&&s);return a?(0,i.jsx)(_,{pets:a,userPlan:l,onEditRecord:n,onDeleteRecord:o,onRefresh:d,onAddRecord:c,refreshKey:m}):h?(0,i.jsx)(D,{petId:s,petName:t}):(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,i.jsx)(x.mT,{type:"health",className:"w-8 h-8",color:"#6B7280"})}),(0,i.jsx)("p",{className:"text-gray-600",children:"No pet data provided"})]})};var E=t(2878);const T=e=>{let{pets:s,userId:t}=e;const[l,n]=(0,r.useState)([]),[o,d]=(0,r.useState)(!0),[c,m]=(0,r.useState)("all"),[h,u]=(0,r.useState)(""),[g,p]=(0,r.useState)("all"),[b,f]=(0,r.useState)("all"),[v,y]=(0,r.useState)(1),[j]=(0,r.useState)(15),[N,w]=(0,r.useState)(null),[C,k]=(0,r.useState)(!1),[P,_]=(0,r.useState)("date_desc"),[D,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=e=>{D&&!e.target.closest(".custom-dropdown")&&S(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[D]);const T=e=>{var s;let{value:t,onChange:r,options:a,placeholder:l,dropdownKey:n}=e;return(0,i.jsxs)("div",{className:"custom-dropdown relative",children:[(0,i.jsxs)("button",{type:"button",onClick:()=>S(D===n?null:n),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent bg-white text-left flex items-center justify-between hover:bg-gray-50",children:[(0,i.jsx)("span",{className:"truncate",children:(null===(s=a.find(e=>e.value===t))||void 0===s?void 0:s.label)||l}),(0,i.jsx)("svg",{className:"w-4 h-4 text-gray-400 transition-transform "+(D===n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D===n&&(0,i.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:a.map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>{r(e.value),S(null)},className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg "+(t===e.value?"bg-[#E5F4F1] text-[#5EB47C]":"text-gray-700"),children:e.label},e.value))})]})};(0,r.useEffect)(()=>{t&&A()},[t]);const A=async()=>{d(!0);try{const e=await E.A.getUserSoapNotes(t);e.success&&n(e.data)}catch(e){console.error("Error loading SOAP notes:",e)}finally{d(!1)}},B=e=>{const s={low:{color:"from-green-50 to-green-100 border-green-200",icon:(0,i.jsx)(x.mT,{type:"check",className:"w-4 h-4",color:"#10B981"}),badge:"bg-green-100 text-green-800"},moderate:{color:"from-blue-50 to-blue-100 border-blue-200",icon:(0,i.jsx)(x.mT,{type:"warning",className:"w-4 h-4",color:"#3B82F6"}),badge:"bg-blue-100 text-blue-800"},high:{color:"from-orange-50 to-orange-100 border-orange-200",icon:(0,i.jsx)(x.mT,{type:"warning",className:"w-4 h-4",color:"#F59E0B"}),badge:"bg-orange-100 text-orange-800"},urgent:{color:"from-red-50 to-red-100 border-red-200",icon:(0,i.jsx)(x.mT,{type:"emergency",className:"w-4 h-4",color:"#EF4444"}),badge:"bg-red-100 text-red-800"}};return s[e]||s.moderate},L=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),F=(0,r.useMemo)(()=>{let e=l.map(e=>({...e,searchText:`${e.title} ${e.subjective} ${e.objective} ${e.assessment} ${e.plan}`}));if("all"!==c&&(e=e.filter(e=>e.pet_id===c)),h.trim()){const s=h.toLowerCase();e=e.filter(e=>{var t,r,a;return(null===(t=e.searchText)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(r=e.vet_name)||void 0===r?void 0:r.toLowerCase().includes(s))||(null===(a=e.clinic_name)||void 0===a?void 0:a.toLowerCase().includes(s))})}"all"!==g&&(e=e.filter(e=>e.severity===g));const t=(()=>{const e=new Date;return{all:()=>!0,today:s=>new Date(s).toDateString()===e.toDateString(),week:s=>{const t=new Date(e.getTime()-6048e5);return new Date(s)>=t},month:s=>{const t=new Date(e.getTime()-2592e6);return new Date(s)>=t},year:s=>{const t=new Date(e.getTime()-31536e6);return new Date(s)>=t}}})()[b];return t&&(e=e.filter(e=>t(e.created_at))),e.sort((e,t)=>{var r,a;switch(P){case"date_desc":default:return new Date(t.created_at)-new Date(e.created_at);case"date_asc":return new Date(e.created_at)-new Date(t.created_at);case"severity":const l={urgent:4,high:3,moderate:2,low:1};return(l[t.severity]||2)-(l[e.severity]||2);case"pet":const n=(null===(r=s.find(s=>s.id===e.pet_id))||void 0===r?void 0:r.name)||"",o=(null===(a=s.find(e=>e.id===t.pet_id))||void 0===a?void 0:a.name)||"";return n.localeCompare(o)}}),e},[l,c,h,g,b,P,s]),R=(0,r.useMemo)(()=>{const e=(v-1)*j;return F.slice(e,e+j)},[F,v,j]),M=Math.ceil(F.length/j),I=()=>{w(null),k(!1)};return o?(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center py-16",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-[#5EB47C] border-t-transparent mb-4"}),(0,i.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading SOAP notes..."}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Gathering your pet's medical records"})]}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:(0,i.jsx)("div",{className:"p-6",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[(0,i.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-green-50 rounded-xl border border-green-100",children:[(0,i.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3",children:(0,i.jsx)(x.mT,{type:"health",className:"w-6 h-6",color:"#10B981"})}),(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-green-600 mb-1",children:l.length}),(0,i.jsx)("div",{className:"text-xs text-green-700 font-medium",children:"Total SOAP Notes"})]}),(0,i.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-blue-50 rounded-xl border border-blue-100",children:[(0,i.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3",children:(0,i.jsx)(x.mT,{type:"vaccination",className:"w-6 h-6",color:"#3B82F6"})}),(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-blue-600 mb-1",children:l.filter(e=>"luni_triage"===e.source).length}),(0,i.jsx)("div",{className:"text-xs text-blue-700 font-medium",children:"Luni Triage"})]}),(0,i.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-red-50 rounded-xl border border-red-100",children:[(0,i.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3",children:(0,i.jsx)(x.mT,{type:"emergency",className:"w-6 h-6",color:"#EF4444"})}),(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-red-600 mb-1",children:l.filter(e=>"urgent"===e.severity||"high"===e.severity).length}),(0,i.jsx)("div",{className:"text-xs text-red-700 font-medium",children:"Urgent Cases"})]}),(0,i.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-purple-50 rounded-xl border border-purple-100",children:[(0,i.jsx)("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3",children:(0,i.jsx)(x.j8,{species:"pet",className:"w-6 h-6",color:"#8B5CF6"})}),(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-purple-600 mb-1",children:s.length}),(0,i.jsx)("div",{className:"text-xs text-purple-700 font-medium",children:"Pets Tracked"})]})]})})}),(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"SOAP Records"}),(0,i.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Medical records from Luni Triage assessments"})]})}),(0,i.jsx)("div",{className:"-mx-6 border-t border-gray-200 mb-6"}),(0,i.jsxs)("div",{className:"flex items-center space-x-1 overflow-x-auto pb-2 mb-6",children:[(0,i.jsx)("button",{onClick:()=>{m("all"),y(1)},className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("all"===c?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"All Pets"}),s.map(e=>(0,i.jsx)("button",{onClick:()=>{m(e.id),y(1)},className:"px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all "+(c===e.id?"bg-[#5EB47C] text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.name},e.id))]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,i.jsx)("div",{className:"flex-1 w-full",children:(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)("input",{type:"text",placeholder:"Search SOAP notes, symptoms, treatments...",value:h,onChange:e=>{u(e.target.value),y(1)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})})}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,i.jsx)(T,{value:g,onChange:e=>{p(e),y(1)},options:[{value:"all",label:"All Severities"},{value:"urgent",label:"Urgent",icon:(0,i.jsx)(x.mT,{type:"emergency",className:"w-4 h-4",color:"currentColor"})},{value:"high",label:"High",icon:(0,i.jsx)(x.mT,{type:"warning",className:"w-4 h-4",color:"currentColor"})},{value:"moderate",label:"Moderate",icon:(0,i.jsx)(x.mT,{type:"warning",className:"w-4 h-4",color:"currentColor"})},{value:"low",label:"Low",icon:(0,i.jsx)(x.mT,{type:"check",className:"w-4 h-4",color:"currentColor"})}],placeholder:"All Severities",dropdownKey:"severity"}),(0,i.jsx)(T,{value:b,onChange:e=>{f(e),y(1)},options:[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"Past Week"},{value:"month",label:"Past Month"},{value:"year",label:"Past Year"}],placeholder:"All Time",dropdownKey:"date"}),(0,i.jsx)(T,{value:P,onChange:_,options:[{value:"date_desc",label:"Newest First"},{value:"date_asc",label:"Oldest First"},{value:"severity",label:"By Severity",icon:(0,i.jsx)(x.mT,{type:"emergency",className:"w-4 h-4",color:"currentColor"})},{value:"pet",label:"By Pet",icon:(0,i.jsx)(x.j8,{species:"pet",className:"w-4 h-4",color:"currentColor"})}],placeholder:"Newest First",dropdownKey:"sort"})]})]}),F.length>0&&(0,i.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-600",children:[(0,i.jsx)("div",{children:h&&`Found ${F.length} SOAP note${1!==F.length?"s":""} matching "${h}"`}),(0,i.jsxs)("div",{children:["Page ",v," of ",M]})]}),(0,i.jsx)("div",{className:"mt-6",children:0===F.length?(0,i.jsxs)("div",{className:"text-center py-16",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:h?"No matching SOAP notes found":"No notes yet"}),(0,i.jsx)("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:h?"Try adjusting your search terms or filters to find what you're looking for.":"Start using Luni Triage to conduct pet health assessments and generate SOAP notes."}),!h&&(0,i.jsx)(a.N_,{to:"/luni-triage",className:"inline-flex items-center px-6 py-3 bg-[#5EB47C] text-white rounded-xl hover:bg-[#4A9A64] transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"Start Triage Assessment"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"space-y-2",children:R.map(e=>{const t=B(e.severity),r=s.find(s=>s.id===e.pet_id);return(0,i.jsx)("div",{onClick:()=>(w(e),void k(!0)),className:"bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer hover:-translate-y-0.5",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:e.title}),(0,i.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.badge}`,children:e.severity.toUpperCase()})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-gray-600",children:[(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(x.mT,{type:"calendar",className:"w-3 h-3 mr-1",color:"currentColor"}),(a=e.created_at,new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]}),r&&(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(x.j8,{species:r.species,className:"w-3 h-3 mr-1",color:"currentColor"}),r.name]}),"luni_triage"===e.source&&(0,i.jsxs)("span",{className:"text-blue-600 flex items-center",children:[(0,i.jsx)(x.mT,{type:"vaccination",className:"w-3 h-3 mr-1",color:"currentColor"}),"Luni Triage"]})]})]})}),(0,i.jsx)("div",{className:"flex items-center space-x-3 flex-shrink-0",children:e.cost&&(0,i.jsx)("div",{className:"text-right",children:(0,i.jsxs)("div",{className:"text-sm font-semibold text-green-700",children:["$",e.cost]})})})]})},e.id);var a})}),M>1&&(0,i.jsxs)("div",{className:"mt-8 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",(v-1)*j+1," to ",Math.min(v*j,F.length)," of ",F.length," SOAP notes"]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("button",{onClick:()=>y(Math.max(1,v-1)),disabled:1===v,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,i.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,M)},(e,s)=>{let t;return t=M<=5||v<=3?s+1:v>=M-2?M-4+s:v-2+s,(0,i.jsx)("button",{onClick:()=>y(t),className:"px-3 py-2 rounded-lg text-sm font-medium "+(v===t?"bg-[#5EB47C] text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:t},t)})}),(0,i.jsx)("button",{onClick:()=>y(Math.min(M,v+1)),disabled:v===M,className:"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})})]})]}),(()=>{if(!N||!C)return null;const e=N,t=s.find(s=>s.id===e.pet_id),r=B(e.severity),a=[{key:"subjective",title:"SUBJECTIVE",icon:(0,i.jsx)(x.Sd,{type:"write",className:"w-4 h-4",color:"currentColor"}),color:"blue"},{key:"objective",title:"OBJECTIVE",icon:(0,i.jsx)(x.mT,{type:"search",className:"w-4 h-4",color:"currentColor"}),color:"green"},{key:"assessment",title:"ASSESSMENT",icon:(0,i.jsx)(x.mT,{type:"target",className:"w-4 h-4",color:"currentColor"}),color:"orange"},{key:"plan",title:"PLAN",icon:(0,i.jsx)(x.mT,{type:"records",className:"w-4 h-4",color:"currentColor"}),color:"purple"}];return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,i.jsx)("div",{className:`px-6 py-4 bg-gradient-to-r ${r.color} border-b border-gray-200`,children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm",children:(0,i.jsx)(x.mT,{type:"health",className:"w-6 h-6",color:"#6B7280"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:e.title}),(0,i.jsxs)("div",{className:"flex items-center space-x-3 mt-1",children:[t&&(0,i.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/80 text-gray-700",children:[(0,i.jsx)("span",{className:"mr-1",children:(0,i.jsx)(x.j8,{species:t.species,className:"w-3 h-3",color:"currentColor"})}),t.name]}),(0,i.jsx)("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${r.badge}`,children:"SOAP NOTE"})]})]})]}),(0,i.jsx)("button",{onClick:I,className:"w-10 h-10 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-colors",children:(0,i.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)(x.mT,{type:"calendar",className:"w-5 h-5 mr-3 flex-shrink-0",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Date"}),(0,i.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:L(e.created_at)})]})]}),e.vet_name&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)(x.mT,{type:"doctor",className:"w-5 h-5 mr-3 flex-shrink-0",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Veterinarian"}),(0,i.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:e.vet_name})]})]}),e.clinic_name&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)(x.mT,{type:"health",className:"w-5 h-5 mr-3 flex-shrink-0",color:"#6B7280"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:"Clinic"}),(0,i.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:e.clinic_name})]})]}),e.cost&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[(0,i.jsx)(x.Sd,{type:"money",className:"w-5 h-5 mr-3 flex-shrink-0",color:"#10B981"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"Total Cost"}),(0,i.jsxs)("div",{className:"text-lg font-bold text-green-700",children:["$",e.cost]})]})]}),e.source&&(0,i.jsxs)("div",{className:"flex items-center p-3 bg-blue-50 rounded-lg",children:[(0,i.jsx)("span",{className:"mr-3 flex-shrink-0",children:"luni_triage"===e.source?(0,i.jsx)(x.mT,{type:"vaccination",className:"w-5 h-5",color:"#3B82F6"}):(0,i.jsx)(x.Sd,{type:"write",className:"w-5 h-5",color:"#3B82F6"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-blue-600 font-medium",children:"Source"}),(0,i.jsx)("div",{className:"text-sm font-semibold text-blue-700",children:"luni_triage"===e.source?"Luni Triage":"Manual Entry"})]})]})]}),(0,i.jsx)("div",{className:"space-y-6",children:a.map(s=>e[s.key]?(0,i.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("span",{className:"text-2xl mr-3",children:s.icon}),(0,i.jsx)("h3",{className:`text-lg font-bold text-${s.color}-800 uppercase tracking-wide`,children:s.title})]}),(0,i.jsx)("div",{className:"prose prose-sm max-w-none text-gray-700 leading-relaxed whitespace-pre-wrap",children:e[s.key]})]},s.key):null)}),e.follow_up_date&&(0,i.jsx)("div",{className:"mt-6 p-4 bg-orange-50 border-l-4 border-orange-400 rounded-r-lg",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{className:"text-orange-500 text-lg",children:"\u23f0"}),(0,i.jsx)("span",{className:"font-medium text-orange-800",children:"Follow-up Scheduled:"}),(0,i.jsx)("span",{className:"text-orange-700 font-semibold",children:L(e.follow_up_date)})]})})]})]})})})()]})};t(1046);const A=e=>{let{petId:s,petName:t,onClose:a,onSuccess:l}=e;const[n,o]=(0,r.useState)({record_type:"checkup",title:"",description:"",vet_name:"",clinic_name:"",date_performed:(new Date).toISOString().split("T")[0],next_due_date:"",cost:"",notes:""}),[d,c]=(0,r.useState)([]),[m,h]=(0,r.useState)(!1),[u,g]=(0,r.useState)(!1),[p,b]=(0,r.useState)(""),f=(0,r.useRef)(null),v=[{value:"checkup",label:"Regular Checkup",icon:(0,i.jsx)(x.mT,{type:"check",className:"w-5 h-5",color:"currentColor"})},{value:"vaccination",label:"Vaccination",icon:(0,i.jsx)(x.mT,{type:"vaccination",className:"w-5 h-5",color:"currentColor"})},{value:"surgery",label:"Surgery",icon:(0,i.jsx)(x.Sd,{type:"surgery",className:"w-5 h-5",color:"currentColor"})},{value:"emergency",label:"Emergency Visit",icon:(0,i.jsx)(x.mT,{type:"emergency",className:"w-5 h-5",color:"currentColor"})},{value:"dental",label:"Dental Care",icon:(0,i.jsx)(x.Sd,{type:"dental",className:"w-5 h-5",color:"currentColor"})},{value:"grooming",label:"Grooming",icon:(0,i.jsx)(x.Sd,{type:"scissors",className:"w-5 h-5",color:"currentColor"})},{value:"lab_work",label:"Lab Work",icon:(0,i.jsx)(x.Sd,{type:"lab",className:"w-5 h-5",color:"currentColor"})},{value:"other",label:"Other",icon:(0,i.jsx)(x.mT,{type:"records",className:"w-5 h-5",color:"currentColor"})}],y=(e=>{const s={grooming:{professionalLabel:"Groomer Name",professionalPlaceholder:"e.g., Sarah Smith",businessLabel:"Salon/Shop Name",businessPlaceholder:"e.g., Pampered Paws Grooming",titlePlaceholder:"e.g., Full Grooming Service, Nail Trim",descriptionPlaceholder:"Describe the grooming services performed...",nextDueDateLabel:"Next Grooming Due",showNextDueDate:!0},checkup:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Care Clinic",titlePlaceholder:"e.g., Annual Checkup, Wellness Exam",descriptionPlaceholder:"Describe the examination findings and recommendations...",nextDueDateLabel:"Next Checkup Due",showNextDueDate:!0},vaccination:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Care Clinic",titlePlaceholder:"e.g., Rabies Vaccination, DHPP Booster",descriptionPlaceholder:"Specify vaccine type, batch number, and any reactions...",nextDueDateLabel:"Next Vaccination Due",showNextDueDate:!0},surgery:{professionalLabel:"Surgeon/Veterinarian Name",professionalPlaceholder:"e.g., Dr. Johnson",businessLabel:"Hospital/Clinic Name",businessPlaceholder:"e.g., Animal Surgery Center",titlePlaceholder:"e.g., Spay Surgery, Tumor Removal",descriptionPlaceholder:"Describe the surgical procedure and post-op care...",nextDueDateLabel:"Follow-up Appointment",showNextDueDate:!0},emergency:{professionalLabel:"Attending Veterinarian",professionalPlaceholder:"e.g., Dr. Emergency",businessLabel:"Emergency Clinic Name",businessPlaceholder:"e.g., 24/7 Animal Emergency",titlePlaceholder:"e.g., Emergency Visit - Injury, Poisoning",descriptionPlaceholder:"Describe the emergency situation and treatment...",nextDueDateLabel:"Follow-up Required",showNextDueDate:!0},dental:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Dental Care",titlePlaceholder:"e.g., Dental Cleaning, Tooth Extraction",descriptionPlaceholder:"Describe the dental procedure and findings...",nextDueDateLabel:"Next Dental Care Due",showNextDueDate:!0},lab_work:{professionalLabel:"Veterinarian/Technician Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Lab/Clinic Name",businessPlaceholder:"e.g., Pet Diagnostics Lab",titlePlaceholder:"e.g., Blood Work, Urinalysis, X-Ray",descriptionPlaceholder:"Describe the tests performed and results...",nextDueDateLabel:"Next Lab Work Due",showNextDueDate:!1},other:{professionalLabel:"Professional Name",professionalPlaceholder:"e.g., Professional Name",businessLabel:"Business/Facility Name",businessPlaceholder:"e.g., Business Name",titlePlaceholder:"e.g., Treatment or Service Name",descriptionPlaceholder:"Describe the service or treatment...",nextDueDateLabel:"Next Appointment/Service",showNextDueDate:!1}};return s[e]||s.other})(n.record_type),j=e=>{const{name:s,value:t}=e.target;o(e=>({...e,[s]:t})),b("")},N=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]};return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,i.jsx)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-xl",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 font-montserrat",children:"Add Health Record"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Add a new health record for ",t]})]}),(0,i.jsx)("button",{onClick:a,className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors",disabled:u,children:(0,i.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),g(!0),b("");try{if(!n.title.trim())throw new Error("Title is required");if(!n.date_performed)throw new Error("Date performed is required");const e={...n,documents:d.map(e=>({name:e.name,url:e.url,type:e.type,size:e.size}))},t=await P.A.addHealthRecord(s,e);if(!t.success)throw new Error(t.error||"Failed to add health record");l(t.data),a()}catch(p){console.error("Error adding health record:",p),b(p.message)}finally{g(!1)}},className:"p-6 space-y-6",children:[p&&(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,i.jsx)("p",{className:"text-sm text-red-700",children:p})]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Record Type *"}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:v.map(e=>(0,i.jsxs)("button",{type:"button",onClick:()=>j({target:{name:"record_type",value:e.value}}),className:"p-3 rounded-lg border-2 transition-all text-center "+(n.record_type===e.value?"border-[#5EB47C] bg-[#E5F4F1] text-[#5EB47C]":"border-gray-200 hover:border-gray-300"),children:[(0,i.jsx)("div",{className:"mb-1 flex justify-center",children:e.icon}),(0,i.jsx)("div",{className:"text-xs font-medium",children:e.label})]},e.value))})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,i.jsx)("input",{type:"text",id:"title",name:"title",value:n.title,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:y.titlePlaceholder,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"date_performed",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Performed *"}),(0,i.jsx)("input",{type:"date",id:"date_performed",name:"date_performed",value:n.date_performed,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"vet_name",className:"block text-sm font-medium text-gray-700 mb-1",children:y.professionalLabel}),(0,i.jsx)("input",{type:"text",id:"vet_name",name:"vet_name",value:n.vet_name,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:y.professionalPlaceholder})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"clinic_name",className:"block text-sm font-medium text-gray-700 mb-1",children:y.businessLabel}),(0,i.jsx)("input",{type:"text",id:"clinic_name",name:"clinic_name",value:n.clinic_name,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:y.businessPlaceholder})]})]}),(0,i.jsxs)("div",{className:`grid grid-cols-1 ${y.showNextDueDate?"md:grid-cols-2":"md:grid-cols-1"} gap-4`,children:[y.showNextDueDate&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"next_due_date",className:"block text-sm font-medium text-gray-700 mb-1",children:y.nextDueDateLabel}),(0,i.jsx)("input",{type:"date",id:"next_due_date",name:"next_due_date",value:n.next_due_date,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost ($)"}),(0,i.jsx)("input",{type:"number",id:"cost",name:"cost",value:n.cost,onChange:j,step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"0.00"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,i.jsx)("textarea",{id:"description",name:"description",value:n.description,onChange:j,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:y.descriptionPlaceholder})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vet Reports & Documents"}),(0,i.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,i.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,i.jsx)("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:"Upload vet reports, lab results, or images"}),(0,i.jsx)("span",{className:"mt-1 block text-sm text-gray-500",children:"PDF, JPEG, PNG up to 10MB each"})]}),(0,i.jsx)("input",{ref:f,id:"file-upload",name:"file-upload",type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length){h(!0),b("");try{const e=t.map(async e=>{if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(e.type))throw new Error(`File ${e.name} is not a supported type. Please upload PDF, JPEG, or PNG files.`);if(e.size>10485760)throw new Error(`File ${e.name} is too large. Maximum size is 10MB.`);const t=await P.A.uploadVetReport(s,e,n.record_type);if(!t.success)throw new Error(`Failed to upload ${e.name}: ${t.error}`);return{name:e.name,url:t.publicUrl,filePath:t.filePath,type:e.type,size:e.size}}),r=await Promise.all(e);c(e=>[...e,...r])}catch(p){console.error("Error uploading files:",p),b(p.message)}finally{h(!1),f.current&&(f.current.value="")}}},className:"sr-only",disabled:m})]}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.click()},disabled:m,className:"bg-[#5EB47C] text-white px-4 py-2 rounded-lg hover:bg-[#4A9A64] transition-colors disabled:opacity-50",children:m?"Uploading...":"Choose Files"})})]})}),d.length>0&&(0,i.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,i.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Uploaded Documents:"}),d.map((e,s)=>{return(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"text-lg mr-2",children:(t=e.type,t.startsWith("image/")?(0,i.jsx)(x.mT,{type:"image",className:"w-4 h-4",color:"currentColor"}):"application/pdf"===t?(0,i.jsx)(x.mT,{type:"document",className:"w-4 h-4",color:"currentColor"}):(0,i.jsx)(x.mT,{type:"attachment",className:"w-4 h-4",color:"currentColor"}))}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:N(e.size)})]})]}),(0,i.jsx)("button",{type:"button",onClick:()=>(async e=>{const s=d[e];try{const e=await P.A.deleteVetReport(s.filePath);e.success||console.warn("Failed to delete file from storage:",e.error)}catch(p){console.warn("Error deleting file:",p)}c(s=>s.filter((s,t)=>t!==e))})(s),className:"text-red-600 hover:text-red-800 transition-colors",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},s);var t})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),(0,i.jsx)("textarea",{id:"notes",name:"notes",value:n.notes,onChange:j,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"Any additional notes or observations..."})]}),(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,i.jsx)("button",{type:"button",onClick:a,disabled:u||m,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium disabled:opacity-50",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:u||m||!n.title.trim()||!n.date_performed,className:"px-6 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:u?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding Record..."]}):"Add Health Record"})]})]})]})})},B=e=>{let{record:s,onClose:t,onSuccess:a}=e;const[l,n]=(0,r.useState)({record_type:(null===s||void 0===s?void 0:s.record_type)||"checkup",title:(null===s||void 0===s?void 0:s.title)||"",description:(null===s||void 0===s?void 0:s.description)||"",vet_name:(null===s||void 0===s?void 0:s.vet_name)||"",clinic_name:(null===s||void 0===s?void 0:s.clinic_name)||"",date_performed:null!==s&&void 0!==s&&s.date_performed?s.date_performed.split("T")[0]:(new Date).toISOString().split("T")[0],next_due_date:null!==s&&void 0!==s&&s.next_due_date?s.next_due_date.split("T")[0]:"",cost:(null===s||void 0===s?void 0:s.cost)||"",notes:(null===s||void 0===s?void 0:s.notes)||""}),[o,d]=(0,r.useState)((null===s||void 0===s?void 0:s.documents)||[]),[c,m]=(0,r.useState)(!1),[h,u]=(0,r.useState)(!1),[g,p]=(0,r.useState)(""),b=(0,r.useRef)(null),f=[{value:"checkup",label:"Regular Checkup",icon:(0,i.jsx)(x.mT,{type:"check",className:"w-5 h-5",color:"currentColor"}),textIcon:"\u2695\ufe0f"},{value:"vaccination",label:"Vaccination",icon:(0,i.jsx)(x.mT,{type:"vaccination",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83d\udc89"},{value:"surgery",label:"Surgery",icon:(0,i.jsx)(x.Sd,{type:"surgery",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83c\udfe5"},{value:"emergency",label:"Emergency Visit",icon:(0,i.jsx)(x.mT,{type:"emergency",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83d\udea8"},{value:"dental",label:"Dental Care",icon:(0,i.jsx)(x.mT,{type:"dental",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83e\uddb7"},{value:"grooming",label:"Grooming",icon:(0,i.jsx)(x.Sd,{type:"scissors",className:"w-5 h-5",color:"currentColor"}),textIcon:"\u2702\ufe0f"},{value:"lab_work",label:"Lab Work",icon:(0,i.jsx)(x.mT,{type:"lab",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83d\udd2c"},{value:"other",label:"Other",icon:(0,i.jsx)(x.mT,{type:"records",className:"w-5 h-5",color:"currentColor"}),textIcon:"\ud83d\udccb"}],v=(e=>{const s={grooming:{professionalLabel:"Groomer Name",professionalPlaceholder:"e.g., Sarah Smith",businessLabel:"Salon/Shop Name",businessPlaceholder:"e.g., Pampered Paws Grooming",titlePlaceholder:"e.g., Full Grooming Service, Nail Trim",descriptionPlaceholder:"Describe the grooming services performed...",nextDueDateLabel:"Next Grooming Due",showNextDueDate:!0},checkup:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Care Clinic",titlePlaceholder:"e.g., Annual Checkup, Wellness Exam",descriptionPlaceholder:"Describe the examination findings and recommendations...",nextDueDateLabel:"Next Checkup Due",showNextDueDate:!0},vaccination:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Care Clinic",titlePlaceholder:"e.g., Rabies Vaccination, DHPP Booster",descriptionPlaceholder:"Specify vaccine type, batch number, and any reactions...",nextDueDateLabel:"Next Vaccination Due",showNextDueDate:!0},surgery:{professionalLabel:"Surgeon/Veterinarian Name",professionalPlaceholder:"e.g., Dr. Johnson",businessLabel:"Hospital/Clinic Name",businessPlaceholder:"e.g., Animal Surgery Center",titlePlaceholder:"e.g., Spay Surgery, Tumor Removal",descriptionPlaceholder:"Describe the surgical procedure and post-op care...",nextDueDateLabel:"Follow-up Appointment",showNextDueDate:!0},emergency:{professionalLabel:"Attending Veterinarian",professionalPlaceholder:"e.g., Dr. Emergency",businessLabel:"Emergency Clinic Name",businessPlaceholder:"e.g., 24/7 Animal Emergency",titlePlaceholder:"e.g., Emergency Visit - Injury, Poisoning",descriptionPlaceholder:"Describe the emergency situation and treatment...",nextDueDateLabel:"Follow-up Required",showNextDueDate:!0},dental:{professionalLabel:"Veterinarian Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Clinic/Hospital Name",businessPlaceholder:"e.g., Pet Dental Care",titlePlaceholder:"e.g., Dental Cleaning, Tooth Extraction",descriptionPlaceholder:"Describe the dental procedure and findings...",nextDueDateLabel:"Next Dental Care Due",showNextDueDate:!0},lab_work:{professionalLabel:"Veterinarian/Technician Name",professionalPlaceholder:"e.g., Dr. Smith",businessLabel:"Lab/Clinic Name",businessPlaceholder:"e.g., Pet Diagnostics Lab",titlePlaceholder:"e.g., Blood Work, Urinalysis, X-Ray",descriptionPlaceholder:"Describe the tests performed and results...",nextDueDateLabel:"Next Lab Work Due",showNextDueDate:!1},other:{professionalLabel:"Professional Name",professionalPlaceholder:"e.g., Professional Name",businessLabel:"Business/Facility Name",businessPlaceholder:"e.g., Business Name",titlePlaceholder:"e.g., Treatment or Service Name",descriptionPlaceholder:"Describe the service or treatment...",nextDueDateLabel:"Next Appointment/Service",showNextDueDate:!1}};return s[e]||s.other})(l.record_type),y=e=>{const{name:s,value:t}=e.target;n(e=>({...e,[s]:t})),p("")},j=()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&t()};return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Health Record"}),(0,i.jsx)("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),g&&(0,i.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,i.jsx)("p",{className:"text-red-600 text-sm",children:g})}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.title.trim())if(l.description.trim()){u(!0),p("");try{const e={...l,documents:o,updated_at:(new Date).toISOString()},r=await P.A.updateHealthRecord(s.id,e);r.success?(alert("Health record updated successfully!"),a&&a(r.data),t()):p(`Failed to update health record: ${r.error}`)}catch(g){console.error("Error updating health record:",g),p(`Error updating health record: ${g.message}`)}finally{u(!1)}}else p("Description is required");else p("Title is required")},className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Record Type"}),(0,i.jsx)("select",{name:"record_type",value:l.record_type,onChange:y,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0,children:f.map(e=>(0,i.jsxs)("option",{value:e.value,children:[e.textIcon," ",e.label]},e.value))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),(0,i.jsx)("input",{type:"text",name:"title",value:l.title,onChange:y,placeholder:v.titlePlaceholder,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,i.jsx)("textarea",{name:"description",value:l.description,onChange:y,rows:3,placeholder:v.descriptionPlaceholder,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:v.professionalLabel}),(0,i.jsx)("input",{type:"text",name:"vet_name",value:l.vet_name,onChange:y,placeholder:v.professionalPlaceholder,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:v.businessLabel}),(0,i.jsx)("input",{type:"text",name:"clinic_name",value:l.clinic_name,onChange:y,placeholder:v.businessPlaceholder,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Performed *"}),(0,i.jsx)("input",{type:"date",name:"date_performed",value:l.date_performed,onChange:y,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0})]}),v.showNextDueDate&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:v.nextDueDateLabel}),(0,i.jsx)("input",{type:"date",name:"next_due_date",value:l.next_due_date,onChange:y,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cost ($)"}),(0,i.jsx)("input",{type:"number",name:"cost",value:l.cost,onChange:y,step:"0.01",min:"0",placeholder:"0.00",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),(0,i.jsx)("textarea",{name:"notes",value:l.notes,onChange:y,rows:3,placeholder:"Any additional notes or observations...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documents"}),(0,i.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-md p-4",children:[(0,i.jsx)("input",{ref:b,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length){m(!0),p("");try{const e=t.map(async e=>{if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(e.type))throw new Error(`Invalid file type: ${e.type}. Please upload PDF, JPG, or PNG files only.`);if(e.size>10485760)throw new Error(`File ${e.name} is too large. Maximum size is 10MB.`);const t=await P.A.uploadVetReport(s.pet_id,e,"health_record");if(!t.success)throw new Error(`Failed to upload ${e.name}: ${t.error}`);return t.data}),r=await Promise.all(e);d(e=>[...e,...r]),b.current&&(b.current.value="")}catch(g){console.error("Upload error:",g),p(g.message)}finally{m(!1)}}},className:"hidden"}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},disabled:c,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-[#5EB47C] bg-green-50 hover:bg-green-100 disabled:opacity-50",children:[(0,i.jsx)(x.mT,{type:"attachment",className:"w-4 h-4 mr-2",color:"currentColor"}),c?"Uploading...":"Add Documents"]}),(0,i.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"PDF, JPG, PNG files up to 10MB each"})]})]}),o.length>0&&(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Uploaded Documents:"}),(0,i.jsx)("div",{className:"space-y-2",children:o.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsxs)("span",{className:"text-sm flex items-center",children:[(0,i.jsx)(x.mT,{type:"document",className:"w-4 h-4 mr-1",color:"currentColor"}),e.name]}),e.url&&(0,i.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800",children:"View"})]}),(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{d(s=>s.filter((s,t)=>t!==e))})(s),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},s))})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,i.jsx)("button",{type:"button",onClick:j,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",disabled:h,children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:h||c,className:"px-6 py-2 bg-[#5EB47C] text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Updating...":"Update Health Record"})]})]})]})})})};var L=t(7445);const F=e=>{let{onClose:s,onSuccess:t,userId:a,editingPet:l=null}=e;const[n,o]=(0,r.useState)({name:(null===l||void 0===l?void 0:l.name)||"",species:(null===l||void 0===l?void 0:l.species)||"",breed:(null===l||void 0===l?void 0:l.breed)||"",gender:(null===l||void 0===l?void 0:l.gender)||"",birth_date:(null===l||void 0===l?void 0:l.birth_date)||"",weight:(null===l||void 0===l?void 0:l.weight)||"",microchip_number:(null===l||void 0===l?void 0:l.microchip_number)||"",special_needs:(null===l||void 0===l?void 0:l.special_needs)||"",allergies:(null===l||void 0===l?void 0:l.allergies)||"",insurance_info:(null===l||void 0===l?void 0:l.insurance_info)||{}}),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)((null===l||void 0===l?void 0:l.photo_url)||null),[h,u]=(0,r.useState)(!1),[g,p]=(0,r.useState)(""),b=(0,r.useRef)(null),f=[{value:"dog",label:"Dog \ud83d\udc15"},{value:"cat",label:"Cat \ud83d\udc31"},{value:"bird",label:"Bird \ud83d\udc26"},{value:"rabbit",label:"Rabbit \ud83d\udc30"},{value:"hamster",label:"Hamster \ud83d\udc39"},{value:"fish",label:"Fish \ud83d\udc20"},{value:"reptile",label:"Reptile \ud83e\udd8e"},{value:"other",label:"Other \ud83d\udc3e"}],v=e=>{const{name:s,value:t}=e.target;o(e=>({...e,[s]:t})),p("")};return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,i.jsx)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-xl",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 font-montserrat",children:l?"Edit Pet":"Add New Pet"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l?"Update your pet's information":"Add your furry, feathered, or scaled family member"})]}),(0,i.jsx)("button",{onClick:s,className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors",disabled:h,children:(0,i.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0),p("");try{if(!n.name.trim())throw new Error("Pet name is required");if(!n.species)throw new Error("Please select a species");const e=l?await L.A.updatePet(l.id,n):await L.A.addPet(a,n);if(!e.success)throw new Error(e.error||`Failed to ${l?"update":"add"} pet`);let r=e.data;if(d&&r.id){console.log("Attempting to upload photo:",{fileName:d.name,fileSize:d.size,fileType:d.type,petId:r.id});const e=await L.A.uploadPetPhoto(r.id,d);e.success?(console.log("Photo uploaded successfully:",e),r={...r,photo_url:e.photoUrl}):(console.error("Photo upload failed:",e.error),p(`Pet added but photo upload failed: ${e.error}`))}t(r),s()}catch(g){console.error("Error adding pet:",g),p(g.message||"Failed to add pet. Please try again.")}finally{u(!1)}},className:"p-6 space-y-6",children:[g&&(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,i.jsx)("p",{className:"text-sm text-red-700",children:g})]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pet Photo"}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"w-24 h-24 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden",children:m?(0,i.jsx)("img",{src:m,alt:"Pet preview",className:"w-full h-full object-cover"}):(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("span",{className:"text-2xl",children:n.species?(e=>{const s=f.find(s=>s.value===e);return s?s.label.split(" ")[1]:"\ud83d\udc3e"})(n.species):"\ud83d\udcf7"})})}),m&&(0,i.jsx)("button",{type:"button",onClick:()=>{c(null),x(null),b.current.value=""},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors",children:"\xd7"})]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("input",{ref:b,type:"file",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void p("Please select a valid image file");if(s.size>5242880)return void p("Image size must be less than 5MB");c(s);const e=new FileReader;e.onload=e=>{x(e.target.result)},e.readAsDataURL(s)}},className:"hidden"}),(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},className:"bg-[#5EB47C] text-white px-4 py-2 rounded-lg hover:bg-[#4A9A64] transition-colors text-sm font-medium",children:"Choose Photo"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Optional. Max 5MB. JPG, PNG, or GIF."})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Pet Name *"}),(0,i.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"e.g., Buddy, Luna, Charlie",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"species",className:"block text-sm font-medium text-gray-700 mb-1",children:"Species *"}),(0,i.jsxs)("select",{id:"species",name:"species",value:n.species,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",required:!0,children:[(0,i.jsx)("option",{value:"",children:"Select species"}),f.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"breed",className:"block text-sm font-medium text-gray-700 mb-1",children:"Breed"}),(0,i.jsx)("input",{type:"text",id:"breed",name:"breed",value:n.breed,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"e.g., Golden Retriever, Persian"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),(0,i.jsxs)("select",{id:"gender",name:"gender",value:n.gender,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",children:[(0,i.jsx)("option",{value:"",children:"Select gender"}),[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"unknown",label:"Unknown"}].map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"birth_date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Birth Date"}),(0,i.jsx)("input",{type:"date",id:"birth_date",name:"birth_date",value:n.birth_date,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg)"}),(0,i.jsx)("input",{type:"number",id:"weight",name:"weight",value:n.weight,onChange:v,step:"0.1",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"e.g., 25.5"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"microchip_number",className:"block text-sm font-medium text-gray-700 mb-1",children:"Microchip Number"}),(0,i.jsx)("input",{type:"text",id:"microchip_number",name:"microchip_number",value:n.microchip_number,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"15-digit microchip number"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"allergies",className:"block text-sm font-medium text-gray-700 mb-1",children:"Allergies"}),(0,i.jsx)("textarea",{id:"allergies",name:"allergies",value:n.allergies,onChange:v,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"List any known allergies (food, environmental, medications)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"special_needs",className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Needs"}),(0,i.jsx)("textarea",{id:"special_needs",name:"special_needs",value:n.special_needs,onChange:v,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#5EB47C] focus:border-transparent",placeholder:"Any special care requirements, medical conditions, or behavioral notes"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,i.jsx)("button",{type:"button",onClick:s,disabled:h,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium disabled:opacity-50",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:h||!n.name.trim()||!n.species,className:"px-6 py-2 bg-[#5EB47C] text-white rounded-lg hover:bg-[#4A9A64] transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:h?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),l?"Updating Pet...":"Adding Pet..."]}):l?"Update Pet":"Add Pet"})]})]})]})})};var R=t(7629),M=(t(8877),t(5064));const I=()=>{const e=(0,a.Zp)(),[s,t]=(0,r.useState)(null),[c,h]=(0,r.useState)(null),[g,p]=(0,r.useState)(!0),[b,v]=(0,r.useState)("overview"),[_,D]=(0,r.useState)([]),[E,I]=(0,r.useState)([]),[U,$]=(0,r.useState)([]),[W,H]=(0,r.useState)({}),[O,V]=(0,r.useState)({}),[z,G]=(0,r.useState)("free"),[q,Y]=(0,r.useState)(0),[K,J]=(0,r.useState)(0),[Q,X]=(0,r.useState)(null),[Z,ee]=(0,r.useState)(0),[se,te]=(0,r.useState)(0),[re,ae]=(0,r.useState)(!1),[le,ne]=(0,r.useState)(!1),[oe,ie]=(0,r.useState)(!1),[de,ce]=(0,r.useState)(!1),[me,xe]=(0,r.useState)(!1),[he,ue]=(0,r.useState)(!1),[ge,pe]=(0,r.useState)(!1),[be,fe]=(0,r.useState)(null),[ve,ye]=(0,r.useState)(null),[je,Ne]=(0,r.useState)(null),[we,Ce]=(0,r.useState)(0),[ke,Pe]=(0,r.useState)([]),[_e,De]=(0,r.useState)([]),[Se,Ee]=(0,r.useState)(!1),[Te,Ae]=(0,r.useState)("all"),[Be,Le]=(0,r.useState)(""),Fe=(0,r.useCallback)(async()=>{try{var s,r,a,i,d,c;const{data:{user:n},error:x}=await l.N.auth.getUser();if(x||!n)return void e("/signin");t(n);const{data:u,error:g}=await l.N.from("profiles").select("*").eq("id",n.id).single();let p=u;if(g&&"PGRST116"===g.code){var m;const e=o.Dz.getRoleForEmail(n.email),{data:s}=await l.N.from("profiles").insert([{id:n.id,email:n.email,role:e,full_name:(null===(m=n.user_metadata)||void 0===m?void 0:m.full_name)||n.email.split("@")[0],is_active:!0}]).select().single();s&&(p=s)}else if(!g){const e=o.Dz.validateDashboardAccess(u);if(e.hasAccess||console.warn("User does not have dashboard access:",e.message),"anna-wilson@gmail.com"===n.email&&u.role!==o.iK.PET_OWNER){console.log("Updating Anna Wilson to pet_owner role");const{data:e}=await l.N.from("profiles").update({role:o.iK.PET_OWNER,updated_at:(new Date).toISOString()}).eq("id",n.id).select().single();e&&(p=e)}}h(p),G((null===(s=p)||void 0===s?void 0:s.subscription_plan)||"free"),Y((null===(r=p)||void 0===r?void 0:r.ai_triage_count)||0),J((null===(a=p)||void 0===a?void 0:a.weekly_case_count)||0),X(null===(i=p)||void 0===i?void 0:i.last_case_date),ee((null===(d=p)||void 0===d?void 0:d.extra_cases_purchased)||0),te((null===(c=p)||void 0===c?void 0:c.total_spent_on_extras)||0);const{data:b}=await l.N.from("consultation_bookings").select("*, provider_listings(title, provider_name, service_type)").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(5);I(b||[]),await Re(n.id)}catch(x){n.Cp(x),console.error("Error loading user data:",x)}finally{p(!1)}},[e]),Re=async e=>{try{const s=await L.A.getUserPets(e);if(s.success){D(s.data);const e=[],t={},r={},a=s.data.map(async s=>{const[a,l]=await Promise.all([P.A.getHealthRecords(s.id),P.A.getHealthStats(s.id)]);t[s.id]=a.success&&a.data||[],l.success&&(r[s.id]=l.data,l.data.overdueVaccinations>0&&e.push({petId:s.id,petName:s.name,type:"vaccination",message:`${l.data.overdueVaccinations} overdue vaccination${l.data.overdueVaccinations>1?"s":""}`,urgent:!0}))});await Promise.all(a),$(e),H(t),V(r)}}catch(s){console.error("Error loading pets data:",s)}},Me=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const s=new Date(e),t=s.getDay(),r=s.getDate()-t+(0===t?-6:1);return new Date(s.setDate(r))},Ie=()=>"premium"===z||_.length<3,Ue=()=>"premium"===z||q<3,$e=()=>{if("premium"===z)return!0;const e=Me().toDateString();return(Q?Me(new Date(Q)).toDateString():null)!==e||K<1},We=()=>{if("premium"===z)return"Unlimited";const e=Me().toDateString();return(Q?Me(new Date(Q)).toDateString():null)!==e?1:Math.max(0,1-K)},He=()=>{const e=_.length,s=Object.values(W).reduce((e,s)=>e+s.length,0),t=_.length-U.filter(e=>e.urgent).length,r=U.filter(e=>"vaccination"===e.type).length;return{totalPets:e,totalHealthRecords:s,healthyPets:t,petsUpToDate:_.filter(e=>{const s=(W[e.id]||[]).filter(e=>"vaccination"===e.record_type);if(0===s.length)return!1;const t=new Date;return t.setFullYear(t.getFullYear()-1),s.some(e=>new Date(e.date_performed)>t)}).length,overdueVaccinations:r,healthPercentage:e>0?Math.round(t/e*100):100}};(0,r.useEffect)(()=>{Fe()},[Fe]),(0,r.useEffect)(()=>{s&&"favorites"===b&&Oe()},[s,b]),(0,r.useEffect)(()=>{let e;return(async()=>{s&&(e=(0,M.DF)("profiles",e=>{if(null===e||void 0===e||!e.new)return;const s=e.new;"undefined"!==typeof s.ai_triage_count&&Y(s.ai_triage_count||0),"undefined"!==typeof s.weekly_case_count&&J(s.weekly_case_count||0),"undefined"!==typeof s.last_case_date&&X(s.last_case_date||null)},{filter:`id=eq.${s.id}`}))})(),()=>{e&&(e.cleanup?e.cleanup():l.N.removeChannel(e))}},[s]);const Oe=async()=>{if(s)try{Ee(!0);const e=await R.A.getUserFavoritesWithDetails(s.id);e.success&&Pe(e.data)}catch(e){console.error("Error loading favorites:",e)}finally{Ee(!1)}};return(0,r.useEffect)(()=>{s&&"anna-wilson@gmail.com"===s.email&&console.log("\ud83c\udfaf Anna Wilson Dashboard Access:",{email:s.email,role:null===c||void 0===c?void 0:c.role,hasAccess:(null===c||void 0===c?void 0:c.role)===o.iK.PET_OWNER,dashboardRoute:"/pet-owner-dashboard"})},[s,c]),(0,i.jsxs)(d,{loading:g,children:[(0,i.jsx)(f,{userPlan:z,aiTriageCount:q,totalSpentOnExtras:se,canCreateCaseThisWeek:$e(),onShowExtraCaseModal:()=>ne(!0)}),(0,i.jsx)(w,{healthAlerts:U}),(0,i.jsx)(m,{activeTab:b,onTabChange:v}),"overview"===b&&(0,i.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,i.jsx)(j,{profile:c,user:s,profilePhotoUrl:null===c||void 0===c?void 0:c.avatar_url,pets:_,healthStats:He(),bookings:E,onPhotoUpload:async e=>{}}),(0,i.jsx)(N,{pets:_,userPlan:z,dismissedPetLimitBanner:!1,onAddPet:()=>{Ie()?(Ne(null),ue(!0)):alert("You have reached the 3-pet limit on your current plan. Please upgrade to add more pets.")},onEditPet:e=>{Ne(e),ue(!0)},onDeletePet:async e=>{if(window.confirm("Delete this pet? This removes all data and files. This cannot be undone.")){(await L.A.deletePetCascade(e)).success&&D(s=>s.filter(s=>s.id!==e))}},onDismissPetLimitBanner:()=>{},FreemiumLimitBanner:()=>null}),(0,i.jsx)(k,{bookings:E,onSetActiveTab:v}),(0,i.jsx)(C,{userPlan:z,totalSpentOnExtras:se,pets:_,onShowExtraCaseModal:()=>ne(!0),getRemainingFreeCasesThisWeek:We,canCreateCaseThisWeek:$e,canUseAiTriage:Ue,canAddMorePets:Ie})]}),"health"===b&&(0,i.jsx)("div",{className:"space-y-4 sm:space-y-6",children:0===_.length?(0,i.jsxs)("div",{className:"text-center py-16 bg-white rounded-xl border-2 border-dashed border-gray-300",children:[(0,i.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 bg-[#E5F4F1] rounded-full flex items-center justify-center",children:(0,i.jsx)(x.mT,{type:"health",className:"w-10 h-10",color:"#5EB47C"})}),(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Start Your Pet's Health Journey"}),(0,i.jsx)("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Add your pets first to start tracking their health records, vaccinations, medications, and more."}),(0,i.jsxs)("button",{onClick:()=>v("overview"),className:"inline-flex items-center px-6 py-3 bg-[#5EB47C] text-white rounded-xl hover:bg-[#4A9A64] transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:[(0,i.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Your First Pet"]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u,{totalPets:_.length,totalHealthRecords:He().totalHealthRecords,petsUpToDate:He().petsUpToDate,healthPercentage:He().healthPercentage,healthAlerts:U.length,onHealthRecordsClick:()=>{var e;null===(e=document.getElementById("health-records-section"))||void 0===e||e.scrollIntoView({behavior:"smooth"})},onAlertsClick:()=>{}}),(0,i.jsx)(S,{pets:_,userPlan:z,onEditRecord:e=>{ye(e),xe(!0)},onAddRecord:e=>{fe(e),ce(!0)},onRefresh:()=>Re(s.id),refreshKey:we})]})}),"cases"===b&&(0,i.jsx)("div",{className:"space-y-4 sm:space-y-6",children:(0,i.jsx)(T,{pets:_,userId:null===s||void 0===s?void 0:s.id})}),"favorites"===b&&(0,i.jsx)("div",{className:"space-y-4 sm:space-y-6",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"My Favorites"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Your favorite services and products will appear here."})]})}),(0,i.jsx)(y,{canUseAiTriage:Ue,canCreateCaseThisWeek:$e,userPlan:z,getRemainingFreeCasesThisWeek:We,onShowExtraCaseModal:()=>ne(!0),showMobileMenu:re,onToggleMobileMenu:ae}),de&&be&&(0,i.jsx)(A,{petId:be.id,petName:be.name,onClose:()=>{ce(!1),fe(null)},onSuccess:async()=>{await Re(s.id),ce(!1),fe(null),Ce(e=>e+1)}}),me&&ve&&(0,i.jsx)(B,{record:ve,onClose:()=>{xe(!1),ye(null)},onSuccess:()=>{Re(s.id),xe(!1),ye(null)}}),he&&s&&(0,i.jsx)(F,{onClose:()=>{ue(!1),Ne(null)},onSuccess:e=>{D(je?s=>s.map(s=>s.id===je.id?e:s):s=>[e,...s]),ue(!1),Ne(null)},userId:s.id,editingPet:je})]})}},8171:(e,s,t)=>{t.d(s,{Dz:()=>n,iK:()=>a,q5:()=>l});var r=t(1740);const a={PET_OWNER:"pet_owner",VETERINARIAN:"veterinarian",VET_NURSE:"vet_nurse",GROOMER:"groomer",TRAINER:"trainer",BREEDER:"breeder",NUTRITIONIST:"nutritionist",PET_BUSINESS:"pet_business",HOLISTIC_CARE:"holistic_care",ADMIN:"admin",SUPPORT:"support"},l=e=>({[a.PET_OWNER]:"/pet-owner-dashboard",[a.VETERINARIAN]:"/veterinarian-portal",[a.VET_NURSE]:"/vet-nurse-dashboard",[a.GROOMER]:"/groomer-dashboard",[a.TRAINER]:"/trainer-dashboard",[a.BREEDER]:"/breeder-dashboard",[a.NUTRITIONIST]:"/nutritionist-dashboard",[a.PET_BUSINESS]:"/pet-business-dashboard",[a.HOLISTIC_CARE]:"/holistic-care-dashboard",[a.ADMIN]:"/admin",[a.SUPPORT]:"/support-dashboard"}[e]||"/pet-owner-dashboard"),n=async()=>{try{var e,s;const{data:{user:t},error:n}=await r.N.auth.getUser();if(n||!t)return{success:!1,error:"Not authenticated",shouldRedirect:!0,redirectTo:"/signin"};const o=(null===(e=t.user_metadata)||void 0===e?void 0:e.role)||(null===(s=t.app_metadata)||void 0===s?void 0:s.role)||a.PET_OWNER;return o===a.PET_OWNER||o===a.ADMIN?{success:!0,user:t,role:o}:{success:!1,error:"Access denied - wrong role",shouldRedirect:!0,redirectTo:l(o),role:o}}catch(t){return console.error("Error checking pet owner access:",t),{success:!1,error:t.message||"Failed to verify access",shouldRedirect:!0,redirectTo:"/signin"}}}},8877:(e,s,t)=>{t.d(s,{GJ:()=>r});const r={PET_IMAGES:"pet-images",PROVIDER_IMAGES:"provider-images",PRODUCT_IMAGES:"product-images",HEALTH_RECORDS:"health-records",DOCUMENTS:"documents",AVATARS:"avatars",PROFILE_IMAGES:"profile-images"}}}]);
//# sourceMappingURL=277.2f258bbc.chunk.js.map